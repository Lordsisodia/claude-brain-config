var v=(c,N,t)=>new Promise((i,f)=>{var l=n=>{try{u(t.next(n))}catch(h){f(h)}},d=n=>{try{u(t.throw(n))}catch(h){f(h)}},u=n=>n.done?i(n.value):Promise.resolve(n.value).then(l,d);u((t=t.apply(c,N)).next())});import{y as z,z as B,r as o,j as e,m as F,aX as G,bx as L,aY as R,N as D}from"./vendor-C50ijZWh.js";import{u as H,I as y,d as b,s as m}from"./index-Blbobipf.js";import{G as k}from"./gradient-heading-F2bbZRG-.js";import{u as X}from"./useOnboardingAuth-qoSJLt0r.js";import"./libs-B3eAAgHd.js";import"./supabase-D8k0GRjn.js";const te=()=>{var I;const c=z(),N=B(),{toast:t}=H(),[i,f]=o.useState(""),[l,d]=o.useState(!1),[u,n]=o.useState(!1),[h,S]=o.useState(!1),[_,A]=o.useState(!0),[w,U]=o.useState(""),[p,P]=o.useState(""),[E,W]=o.useState(""),[r,O]=o.useState(!0),{userId:C}=X(),j=((I=N.state)==null?void 0:I.planData)||{totalCost:0,timeline:30,agencyName:"Your Agency"};o.useEffect(()=>{v(void 0,null,function*(){const{data:{session:s}}=yield m.auth.getSession();s&&(A(!1),S(!0))})},[]);const Y=a=>v(void 0,null,function*(){if(a.preventDefault(),!i.trim()){t({variant:"destructive",title:"WhatsApp number required",description:"Please enter your WhatsApp number to continue"});return}try{d(!0);const{error:s}=yield m.from("onboarding").insert([{name:j.agencyName||"Unknown",organization:j.agencyName||"Unknown",app_idea:"OnlyFans Management Platform",social_links:{whatsapp:i},whatsapp_number:i,status:"confirmed",user_id:C}]);if(s)throw console.error("Database error:",s),s;t({title:"Information saved",description:"Your WhatsApp number has been saved"}),A(!1),S(!0)}catch(s){console.error("Error saving WhatsApp number:",s),t({variant:"destructive",title:"Error saving information",description:s.message||"There was a problem saving your WhatsApp number"})}finally{d(!1)}}),q=()=>p.length<6?(t({variant:"destructive",title:"Password too short",description:"Password must be at least 6 characters long"}),!1):r&&p!==E?(t({variant:"destructive",title:"Passwords don't match",description:"Please ensure your passwords match"}),!1):!0,T=a=>v(void 0,null,function*(){if(a.preventDefault(),!w.trim()){t({variant:"destructive",title:"Email required",description:"Please enter your email address"});return}if(q()){d(!0);try{if(r){const{data:s,error:x}=yield m.auth.signUp({email:w,password:p,options:{data:{full_name:j.agencyName||"Decora User"}}});if(x)throw x;if(t({title:"Account created",description:"Your account has been created successfully!"}),s.user){const{error:g}=yield m.from("onboarding").update({user_id:s.user.id}).eq("whatsapp_number",i);g&&console.error("Error updating onboarding entry:",g)}c("/home")}else{const{data:s,error:x}=yield m.auth.signInWithPassword({email:w,password:p});if(x)throw x;if(t({title:"Signed in",description:"You have successfully signed in!"}),s.user){const{error:g}=yield m.from("onboarding").update({user_id:s.user.id}).eq("whatsapp_number",i).is("user_id",null);g&&console.error("Error updating onboarding entry:",g)}c("/home")}}catch(s){console.error("Auth error:",s),t({variant:"destructive",title:`Error ${r?"creating account":"signing in"}`,description:s.message||"There was a problem with authentication"})}finally{d(!1)}}}),M=()=>{O(!r),P(""),W("")},V=()=>{C?c("/home"):(S(!1),n(!0))};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-b from-black via-siso-bg to-black p-4",children:e.jsx(F.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-black/40 backdrop-blur-md rounded-lg border border-siso-text/10 shadow-xl p-8",children:[_&&e.jsxs(e.Fragment,{children:[e.jsx(F.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"mx-auto bg-gradient-to-r from-siso-red to-siso-orange w-16 h-16 rounded-full flex items-center justify-center mb-6",children:e.jsx(G,{className:"h-8 w-8 text-white"})}),e.jsx(k,{className:"text-3xl mb-4 text-center",children:"Plan Confirmed!"}),e.jsxs("div",{className:"space-y-6 mb-8",children:[e.jsxs("div",{className:"bg-black/30 rounded-lg p-4 border border-siso-text/10",children:[e.jsx("h3",{className:"font-semibold text-white mb-2",children:"MVP Information"}),e.jsxs("div",{className:"flex items-center text-siso-text mb-2",children:[e.jsx(L,{className:"h-4 w-4 text-siso-orange mr-2"}),e.jsxs("span",{children:["Estimated Cost: ",e.jsx("span",{className:"text-white",children:"FREE"})]})]}),e.jsxs("div",{className:"flex items-center text-siso-text",children:[e.jsx(R,{className:"h-4 w-4 text-siso-orange mr-2"}),e.jsxs("span",{children:["Build Time: ",e.jsxs("span",{className:"text-white",children:[j.timeline||30," days"]})]})]})]}),e.jsxs("form",{onSubmit:Y,children:[e.jsx("h3",{className:"font-medium text-white mb-2",children:"Connect with Us"}),e.jsx("p",{className:"text-sm text-siso-text mb-4",children:"Enter your WhatsApp number to receive updates about your project"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsx(y,{type:"text",placeholder:"WhatsApp Number (with country code)",value:i,onChange:a=>f(a.target.value),className:"bg-black/20 border-siso-text/20 text-white"})}),e.jsx(b,{type:"submit",className:"w-full bg-gradient-to-r from-siso-red to-siso-orange hover:opacity-90",disabled:l,children:l?e.jsx(e.Fragment,{children:"Processing..."}):e.jsxs(e.Fragment,{children:["Continue",e.jsx(D,{className:"ml-2 h-4 w-4"})]})})]})]})]})]}),u&&e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"text-3xl mb-4 text-center",children:r?"Create an Account":"Sign In"}),e.jsx("p",{className:"text-siso-text text-center mb-6",children:r?"Sign up to access your dashboard and project updates":"Sign in to access your dashboard and project updates"}),e.jsxs("form",{className:"space-y-4 mb-6",onSubmit:T,children:[e.jsx("div",{children:e.jsx(y,{type:"email",placeholder:"Email",value:w,onChange:a=>U(a.target.value),className:"bg-black/20 border-siso-text/20 text-white"})}),e.jsx("div",{children:e.jsx(y,{type:"password",placeholder:"Password",value:p,onChange:a=>P(a.target.value),className:"bg-black/20 border-siso-text/20 text-white"})}),r&&e.jsx("div",{children:e.jsx(y,{type:"password",placeholder:"Confirm Password",value:E,onChange:a=>W(a.target.value),className:"bg-black/20 border-siso-text/20 text-white"})}),e.jsx(b,{type:"submit",className:"w-full bg-gradient-to-r from-siso-red to-siso-orange hover:opacity-90",disabled:l,children:l?r?"Creating Account...":"Signing In...":r?"Create Account":"Sign In"})]}),e.jsxs("div",{className:"text-center mt-6",children:[e.jsx("p",{className:"text-sm text-siso-text mb-2",children:r?"Already have an account?":"Don't have an account?"}),e.jsx(b,{variant:"link",className:"text-siso-orange p-0",onClick:M,type:"button",children:r?"Sign In":"Create Account"})]})]}),h&&e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"text-3xl mb-4 text-center",children:"Welcome to Our Agency Platform!"}),e.jsx("p",{className:"text-siso-text text-center mb-6",children:"A message from our CEO about your new Agency Management Platform"}),e.jsx("div",{className:"aspect-video rounded-lg bg-black/50 mb-6 overflow-hidden flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-4",children:[e.jsx("h3",{className:"text-white font-semibold mb-2",children:"CEO Welcome Video"}),e.jsx("p",{className:"text-siso-text text-sm",children:"Welcome to your new platform! We're excited to help you build amazing apps for your clients."})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(b,{onClick:V,className:"w-full bg-gradient-to-r from-siso-red to-siso-orange hover:opacity-90",children:["Go to Dashboard",e.jsx(D,{className:"ml-2 h-4 w-4"})]}),e.jsx(b,{variant:"outline",onClick:()=>c("/onboarding-chat"),className:"w-full border-siso-orange/30 text-siso-orange hover:bg-siso-orange/10",children:"Complete Onboarding"}),e.jsx("p",{className:"text-xs text-siso-text/60 text-center",children:"Have questions? Contact us on WhatsApp for support"})]})]})]})})})};export{te as default};
