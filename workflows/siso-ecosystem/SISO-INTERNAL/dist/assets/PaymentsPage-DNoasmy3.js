var re=Object.defineProperty,ne=Object.defineProperties;var ie=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var Q=(s,r,t)=>r in s?re(s,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[r]=t,O=(s,r)=>{for(var t in r||(r={}))le.call(r,t)&&Q(s,t,r[t]);if(G)for(var t of G(r))ce.call(r,t)&&Q(s,t,r[t]);return s},z=(s,r)=>ne(s,ie(r));var R=(s,r,t)=>new Promise((a,m)=>{var x=d=>{try{n(t.next(d))}catch(j){m(j)}},c=d=>{try{n(t.throw(d))}catch(j){m(j)}},n=d=>d.done?a(d.value):Promise.resolve(d.value).then(x,c);n((t=t.apply(s,r)).next())});import{j as e,aY as W,aZ as Y,ae as oe,bE as X,fd as de,r as B,bT as me,c9 as xe,aC as F,bV as E,b7 as ue,cA as he,f8 as ge,aS as pe,W as V,b0 as Z}from"./vendor-C50ijZWh.js";import{F as je}from"./FinancialLayout-DzwIZMik.js";import{s as U,C as N,a as w,b as y,c as v,B as J,d as C,P as ee,I as be,D as Ne,t as fe,v as we,Q as $,u as ye}from"./index-Blbobipf.js";import{E as ve,f as De}from"./ExpenseCreditCard-jMGJpaKL.js";import{T as ke,a as Ce,b as A,c as L}from"./tabs-CsM4ZGNr.js";import{T as Te,a as Me,b as H,c as I,d as _e,e as k}from"./table-DWISvnW8.js";import"./libs-B3eAAgHd.js";import"./AppLayout-BhL6t15E.js";import"./MainLayout-CYr31jBl.js";import"./supabase-D8k0GRjn.js";import"./glow-effect-BkabJgn5.js";function se(s){return s!=null&&typeof s=="object"&&"id"in s}function Fe(s){if(se(s))return{id:s.id,name:s.name||s.company_name||"Unknown",email:s.email||"",phone:s.phone||""}}function Ie(s,r){return Array.isArray(s)?s.map(t=>r(t)):(console.warn("Invalid data provided to transformEntityData - expected array"),[])}function Se(s){const r=se(s.payment_method)?s.payment_method:void 0;return z(O({},s),{status:s.status,client:Fe(s.client),payment_method:r})}function Ee(){return R(this,null,function*(){try{const{data:s,error:r}=yield U.from("invoices").select(`
        *,
        client:client_id (*),
        payment_method:payment_method_id (*)
      `).order("issue_date",{ascending:!1});return r?(console.error("Error fetching invoices:",r),[]):Ie(s||[],Se)}catch(s){return console.error("Unexpected error in fetchInvoices:",s),[]}})}function Pe(s,r){return Object.entries(s).map(([t,a])=>{if(t.split("-").length===3){const[m,x,c]=t.split("-").map(Number);return{name:`${c}/${x}`,revenue:a.revenue,expense:a.expense}}else{const[m,x]=t.split("-").map(Number);return{name:r[x-1],revenue:a.revenue,expense:a.expense}}}).sort((t,a)=>{const m=t.name.split("/"),x=a.name.split("/");if(m.length>1&&x.length>1){const c=parseInt(m[1]),n=parseInt(x[1]);if(c!==n)return c-n;const d=parseInt(m[0]),j=parseInt(x[0]);return d-j}return r.indexOf(t.name)-r.indexOf(a.name)})}function $e(s,r){return s===0?0:(s-r)/s*100}function Ae(){return{totalRevenue:0,totalExpenses:0,profitMargin:0,outstandingAmount:0,revenueByMonth:[]}}function Le(){return R(this,arguments,function*(s="month",r={}){try{const t=new Date;let a;s==="month"?a=new Date(t.getFullYear(),t.getMonth(),1):a=new Date(t.getFullYear(),0,1);const m=a.toISOString().split("T")[0],x=t.toISOString().split("T")[0],{data:c,error:n}=yield U.from("financial_transactions").select("amount, date").eq("type","revenue").gte("date",m).lte("date",x);if(n)throw n;const{data:d,error:j}=yield U.from("financial_transactions").select("amount, date").eq("type","expense").gte("date",m).lte("date",x);if(j)throw j;const{data:T,error:f}=yield U.from("invoices").select("amount").eq("status","pending");if(f)throw f;const M=(c||[]).reduce((u,o)=>u+Number(o.amount),0),D=(d||[]).reduce((u,o)=>u+Number(o.amount),0),l=(T||[]).reduce((u,o)=>u+Number(o.amount),0),g=$e(M,D),p={},_=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(s==="month"){const u=new Date(t.getFullYear(),t.getMonth()+1,0).getDate();for(let o=1;o<=u;o++){const b=o<10?`0${o}`:`${o}`;p[`${t.getFullYear()}-${t.getMonth()+1}-${b}`]={revenue:0,expense:0}}}else for(let u=0;u<12;u++){const o=u+1<10?`0${u+1}`:`${u+1}`;p[`${t.getFullYear()}-${o}`]={revenue:0,expense:0}}(c||[]).forEach(u=>{const o=new Date(u.date),b=s==="month"?`${o.getFullYear()}-${o.getMonth()+1}-${o.getDate()}`:`${o.getFullYear()}-${o.getMonth()+1<10?"0":""}${o.getMonth()+1}`;p[b]||(p[b]={revenue:0,expense:0}),p[b].revenue+=Number(u.amount)}),(d||[]).forEach(u=>{const o=new Date(u.date),b=s==="month"?`${o.getFullYear()}-${o.getMonth()+1}-${o.getDate()}`:`${o.getFullYear()}-${o.getMonth()+1<10?"0":""}${o.getMonth()+1}`;p[b]||(p[b]={revenue:0,expense:0}),p[b].expense+=Number(u.amount)});const q=Pe(p,_);return{totalRevenue:M,totalExpenses:D,profitMargin:g,outstandingAmount:l,revenueByMonth:q}}catch(t){return console.error("Error fetching financial summary:",t),Ae()}})}function Be({expenses:s}){const r=[...s].sort((c,n)=>{const d=new Date(c.date);return new Date(n.date).getTime()-d.getTime()}),t=new Date,a=new Date;a.setDate(t.getDate()+30);const m=r.filter(c=>{const n=new Date(c.date);return n>=t&&n<=a}),x=c=>new Date(c).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});return e.jsxs(N,{className:"bg-black/20 border border-siso-text/10 backdrop-blur-sm",children:[e.jsx(w,{children:e.jsxs(y,{className:"text-xl flex items-center gap-2 text-white",children:[e.jsx(W,{className:"h-5 w-5 text-siso-orange"}),"Upcoming Expenses"]})}),e.jsx(v,{children:m.length>0?e.jsx("div",{className:"space-y-4",children:m.map(c=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-siso-text/10 hover:bg-siso-text/5 transition-colors",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:c.description}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("p",{className:"text-sm text-gray-300",children:["Due: ",x(c.date)]}),c.recurring_type&&e.jsx(J,{variant:"outline",className:"bg-blue-100/10 text-blue-400 border-blue-400/20",children:c.recurring_type})]})]}),e.jsxs("p",{className:"font-bold text-white",children:["£",c.amount.toFixed(2)]})]},c.id))}):e.jsx("div",{className:"text-center py-6 text-white",children:"No upcoming expenses in the next 30 days"})})]})}function Ue({activeExpenses:s,invoices:r,financialSummary:t,nextPaymentDue:a,formatDate:m}){var n;const x=s.reduce((d,j)=>d+Number(j.amount),0),c=(r||[]).filter(d=>d.status==="pending"||d.status==="overdue").reduce((d,j)=>d+Number(j.amount),0);return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs(N,{className:"bg-black/20 border border-siso-text/10 backdrop-blur-sm",children:[e.jsx(w,{className:"pb-2",children:e.jsxs(y,{className:"text-sm font-medium flex items-center gap-2 text-white",children:[e.jsx(Y,{className:"h-4 w-4 text-siso-orange"}),"Total Current Expenses"]})}),e.jsxs(v,{children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:[((n=s[0])==null?void 0:n.currency)||"£"," ",x.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-300",children:"Monthly recurring expenses"})]})]}),e.jsxs(N,{className:"bg-black/20 border border-siso-text/10 backdrop-blur-sm",children:[e.jsx(w,{className:"pb-2",children:e.jsxs(y,{className:"text-sm font-medium flex items-center gap-2 text-white",children:[e.jsx(oe,{className:"h-4 w-4 text-siso-orange"}),"Outstanding Balance"]})}),e.jsxs(v,{children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:["£ ",c.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-gray-300",children:[(r==null?void 0:r.filter(d=>d.status==="pending"||d.status==="overdue").length)||0," pending invoices"]})]})]}),e.jsxs(N,{className:"bg-black/20 border border-siso-text/10 backdrop-blur-sm",children:[e.jsx(w,{className:"pb-2",children:e.jsxs(y,{className:"text-sm font-medium flex items-center gap-2 text-white",children:[e.jsx(X,{className:"h-4 w-4 text-siso-orange"}),"Total App Cost"]})}),e.jsxs(v,{children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:["£ ",((t==null?void 0:t.totalExpenses)||0).toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-300",children:"Total investment to date"})]})]}),e.jsxs(N,{className:"bg-black/20 border border-siso-text/10 backdrop-blur-sm",children:[e.jsx(w,{className:"pb-2",children:e.jsxs(y,{className:"text-sm font-medium flex items-center gap-2 text-white",children:[e.jsx(W,{className:"h-4 w-4 text-siso-orange"}),"Next Payment Due"]})}),e.jsx(v,{children:a?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:m(a.due_date)}),e.jsxs("p",{className:"text-xs text-gray-300",children:["£",a.amount.toFixed(2)," (",a.invoice_number,")"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:"No payments due"}),e.jsx("p",{className:"text-xs text-gray-300",children:"All invoices are paid"})]})})]})]})}function Ye({handleDownloadAll:s}){return e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold tracking-tight text-purple-900",children:"Financial Management"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage your expenses and revenue"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:s,children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),"Download All"]}),e.jsxs(C,{variant:"default",size:"sm",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Manage Payment"]})]})]})}function qe(){return e.jsxs(N,{className:"bg-black/20 border border-siso-text/10 backdrop-blur-sm mb-6",children:[e.jsxs(w,{className:"flex flex-row items-center justify-between",children:[e.jsx(y,{className:"text-xl",children:"Payment Methods"}),e.jsxs(C,{variant:"outline",size:"sm",children:[e.jsx(Y,{className:"mr-2 h-4 w-4"}),"Add New"]})]}),e.jsx(v,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"flex items-center p-4 border border-siso-text/10 rounded-lg bg-gradient-to-r from-purple-900/10 to-blue-900/10",children:[e.jsx("div",{className:"pr-4",children:e.jsx(Y,{className:"h-10 w-10 text-siso-orange"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:"font-medium",children:"**** **** **** 4285"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Expires 09/25"})]}),e.jsx("div",{children:e.jsx(C,{variant:"ghost",size:"sm",children:"Change"})})]})})})]})}function Oe({totalAmount:s,paidAmount:r,currency:t="£"}){const a=Math.min(100,Math.round(r/s*100))||0,m=s-r;return e.jsxs(N,{className:"bg-black/20 border border-siso-text/10 backdrop-blur-sm",children:[e.jsx(w,{className:"pb-2",children:e.jsx(y,{className:"text-lg text-white",children:"Payment Progress"})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsxs("span",{className:"text-sm font-medium text-white",children:[t,r.toFixed(2)," paid of ",t,s.toFixed(2)]}),e.jsxs("span",{className:"text-sm font-medium text-siso-orange",children:[a,"%"]})]}),e.jsx(ee,{value:a,className:"h-2 bg-gray-700"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"bg-siso-bg-alt rounded-lg p-3 border border-siso-text/10",children:[e.jsx("p",{className:"text-sm text-gray-300",children:"Paid"}),e.jsxs("p",{className:"text-xl font-bold text-siso-orange",children:[t,r.toFixed(2)]})]}),e.jsxs("div",{className:"bg-siso-bg-alt rounded-lg p-3 border border-siso-text/10",children:[e.jsx("p",{className:"text-sm text-gray-300",children:"Remaining"}),e.jsxs("p",{className:"text-xl font-bold text-white",children:[t,m.toFixed(2)]})]})]})]})})]})}function ze({invoices:s,onView:r,onDownload:t}){const[a,m]=B.useState(""),[x,c]=B.useState(null),[n,d]=B.useState(null),T=[...s.filter(l=>{const g=a===""||l.invoice_number.toLowerCase().includes(a.toLowerCase())||l.client_name&&l.client_name.toLowerCase().includes(a.toLowerCase())||l.description&&l.description.toLowerCase().includes(a.toLowerCase()),p=x===null||l.status===x;return g&&p})].sort((l,g)=>{if(!n)return 0;const{key:p,direction:_}=n;return l[p]<g[p]?_==="asc"?-1:1:l[p]>g[p]?_==="asc"?1:-1:0}),f=l=>{let g="asc";n&&n.key===l&&n.direction==="asc"&&(g="desc"),d({key:l,direction:g})},M=l=>{switch(l.toLowerCase()){case"paid":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300";case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300";case"overdue":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300"}},D=l=>{const g=new Date(l);return new Intl.DateTimeFormat("en-GB",{day:"numeric",month:"short",year:"numeric"}).format(g)};return e.jsxs(N,{className:"bg-black/20 border border-siso-text/10 backdrop-blur-sm",children:[e.jsx(w,{children:e.jsx(y,{children:"Invoices"})}),e.jsxs(v,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4 mb-4",children:[e.jsxs("div",{className:"relative w-full sm:w-auto",children:[e.jsx(me,{className:"absolute left-2 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(be,{placeholder:"Search invoices...",className:"pl-8",value:a,onChange:l=>m(l.target.value)})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(Ne,{children:[e.jsx(fe,{asChild:!0,children:e.jsxs(C,{variant:"outline",className:"gap-1",children:[e.jsx(xe,{className:"h-4 w-4"}),"Status",e.jsx(F,{className:"h-4 w-4"})]})}),e.jsxs(we,{align:"end",children:[e.jsx($,{onClick:()=>c(null),children:"All"}),e.jsx($,{onClick:()=>c("paid"),children:"Paid"}),e.jsx($,{onClick:()=>c("pending"),children:"Pending"}),e.jsx($,{onClick:()=>c("overdue"),children:"Overdue"})]})]})})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(Te,{children:[e.jsx(Me,{children:e.jsxs(H,{children:[e.jsx(I,{className:"cursor-pointer",onClick:()=>f("invoice_number"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Invoice",(n==null?void 0:n.key)==="invoice_number"&&(n.direction==="asc"?e.jsx(E,{className:"h-3 w-3"}):e.jsx(F,{className:"h-3 w-3"}))]})}),e.jsx(I,{className:"cursor-pointer",onClick:()=>f("issue_date"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Issued",(n==null?void 0:n.key)==="issue_date"&&(n.direction==="asc"?e.jsx(E,{className:"h-3 w-3"}):e.jsx(F,{className:"h-3 w-3"}))]})}),e.jsx(I,{className:"cursor-pointer",onClick:()=>f("due_date"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Due Date",(n==null?void 0:n.key)==="due_date"&&(n.direction==="asc"?e.jsx(E,{className:"h-3 w-3"}):e.jsx(F,{className:"h-3 w-3"}))]})}),e.jsx(I,{className:"cursor-pointer",onClick:()=>f("status"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["Status",(n==null?void 0:n.key)==="status"&&(n.direction==="asc"?e.jsx(E,{className:"h-3 w-3"}):e.jsx(F,{className:"h-3 w-3"}))]})}),e.jsx(I,{className:"cursor-pointer text-right",onClick:()=>f("amount"),children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:["Amount",(n==null?void 0:n.key)==="amount"&&(n.direction==="asc"?e.jsx(E,{className:"h-3 w-3"}):e.jsx(F,{className:"h-3 w-3"}))]})}),e.jsx(I,{children:"Actions"})]})}),e.jsx(_e,{children:T.length===0?e.jsx(H,{children:e.jsx(k,{colSpan:6,className:"text-center py-6",children:"No invoices found"})}):T.map(l=>e.jsxs(H,{children:[e.jsx(k,{className:"font-medium",children:l.invoice_number}),e.jsx(k,{children:D(l.issue_date)}),e.jsx(k,{children:D(l.due_date)}),e.jsx(k,{children:e.jsx(J,{className:M(l.status),children:l.status.charAt(0).toUpperCase()+l.status.slice(1)})}),e.jsxs(k,{className:"text-right font-medium",children:[l.currency," ",l.amount.toFixed(2)]}),e.jsx(k,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{variant:"ghost",size:"icon",onClick:()=>r(l),children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(C,{variant:"ghost",size:"icon",onClick:()=>t(l.id),children:e.jsx(he,{className:"h-4 w-4"})})]})})]},l.id))})]})})]})]})}function Re({totalTokens:s,categories:r=[{name:"Pricing API",amount:250,icon:e.jsx(X,{className:"h-4 w-4"}),color:"bg-blue-500"},{name:"Setup & UI",amount:350,icon:e.jsx(ge,{className:"h-4 w-4"}),color:"bg-purple-500"},{name:"Wireframes",amount:200,icon:e.jsx(pe,{className:"h-4 w-4"}),color:"bg-emerald-500"}]}){const t=r.map(a=>z(O({},a),{percentage:Math.round(a.amount/s*100)}));return e.jsxs(N,{className:"bg-black/20 border border-siso-text/10 backdrop-blur-sm",children:[e.jsx(w,{children:e.jsx(y,{className:"text-lg",children:"Token Usage"})}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Tokens Used"}),e.jsx("span",{className:"text-lg font-bold text-siso-orange",children:s})]}),e.jsx("div",{className:"space-y-3",children:t.map((a,m)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`p-1.5 rounded-full ${a.color}`,children:a.icon}),e.jsx("span",{className:"text-sm",children:a.name})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium",children:a.amount}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",a.percentage,"%)"]})]})]}),e.jsx(ee,{value:a.percentage,className:`h-1.5 ${a.color.replace("bg-","bg-opacity-20")} bg-opacity-10`})]},m))}),e.jsx("div",{className:"pt-2 border-t border-border",children:e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 rounded-lg bg-siso-bg-alt border border-siso-text/10",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Average Usage"}),e.jsx("p",{className:"text-sm font-medium",children:"42/day"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-siso-bg-alt border border-siso-text/10",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 7 days"}),e.jsx("p",{className:"text-sm font-medium",children:"+15%"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-siso-bg-alt border border-siso-text/10",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Available"}),e.jsx("p",{className:"text-sm font-medium",children:"1,200"})]})]})})]})})]})}function ns(){const{toast:s}=ye(),[r,t]=B.useState("overview"),{data:a,isLoading:m,error:x}=V({queryKey:["invoices"],queryFn:Ee}),{data:c,isLoading:n,error:d}=V({queryKey:["transactions"],queryFn:De}),{data:j,isLoading:T,error:f}=V({queryKey:["financialSummary"],queryFn:()=>Le("month")}),M=m||n||T,D=x||d||f,l=(c==null?void 0:c.filter(i=>i.type==="expense"&&i.status==="completed"))||[],g=(a==null?void 0:a.filter(i=>{if(i.status!=="pending"&&i.status!=="overdue")return!1;const h=new Date(i.due_date),S=new Date,P=h.getTime()-S.getTime(),K=Math.ceil(P/(1e3*60*60*24));return K<=7&&K>=0}))||[];l.reduce((i,h)=>{var P;const S=((P=h.category)==null?void 0:P.name)||"Uncategorized";return i[S]||(i[S]=[]),i[S].push(h),i},{}),l.reduce((i,h)=>i+Number(h.amount),0),(a||[]).filter(i=>i.status==="pending"||i.status==="overdue").reduce((i,h)=>i+Number(h.amount),0);const p=g.length>0?g.reduce((i,h)=>new Date(h.due_date)<new Date(i.due_date)?h:i):null,_=i=>{s({title:"Downloading Invoice",description:"Your invoice will begin downloading shortly."})},q=()=>{s({title:"Downloading All Invoices",description:"Your invoices will begin downloading shortly."})},u=i=>{switch(i.toLowerCase()){case"paid":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"overdue":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},o=i=>{const h=new Date(i);return new Intl.DateTimeFormat("en-US",{day:"numeric",month:"short",year:"numeric"}).format(h)},b=l.reduce((i,h)=>i+Number(h.amount),0),te=l.filter(i=>i.recurring_type==="monthly").reduce((i,h)=>i+Number(h.amount),0),ae=g.reduce((i,h)=>i+h.amount,0);return e.jsxs(je,{title:"Payments & Billing",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsx(ve,{currentCosts:b,predictedCosts:te}),e.jsx(Be,{expenses:l})]}),e.jsx(Ye,{handleDownloadAll:q}),g.length>0&&e.jsx(N,{className:"mb-6 bg-amber-900/20 border border-amber-400/50",children:e.jsxs("div",{className:"p-4 flex items-center",children:[e.jsx(Z,{className:"h-5 w-5 text-amber-400 mr-2"}),e.jsx("span",{className:"text-amber-200 font-medium",children:`£${ae.toFixed(2)} in upcoming expenses due in the next 7 days`})]})}),e.jsxs(ke,{defaultValue:"overview",className:"mt-6",onValueChange:t,children:[e.jsxs(Ce,{className:"grid grid-cols-4 w-full max-w-md",children:[e.jsx(A,{value:"overview",children:"Overview"}),e.jsx(A,{value:"invoices",children:"Invoices"}),e.jsx(A,{value:"payment_methods",children:"Payment Methods"}),e.jsx(A,{value:"token_usage",children:"Token Usage"})]}),e.jsx(L,{value:"overview",children:M?e.jsx("div",{className:"flex justify-center py-10",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-siso-orange"})}):D?e.jsxs("div",{className:"text-center py-8 text-siso-text",children:[e.jsx(Z,{className:"h-8 w-8 mx-auto mb-2 text-siso-red"}),e.jsx("p",{children:"There was an error loading your financial data."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ue,{activeExpenses:l,invoices:a,financialSummary:j,nextPaymentDue:p,formatDate:o}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsx(Oe,{totalAmount:4e3,paidAmount:500}),e.jsxs(N,{className:"bg-black/20 border border-siso-text/10 backdrop-blur-sm",children:[e.jsx(w,{children:e.jsx(y,{className:"text-lg text-white",children:"Upcoming Payments"})}),e.jsx(v,{children:g.length>0?e.jsx("div",{className:"space-y-4",children:g.slice(0,3).map(i=>e.jsxs("div",{className:"flex items-center justify-between p-4 border border-siso-text/10 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-siso-orange/20 rounded-full",children:e.jsx(W,{className:"h-4 w-4 text-siso-orange"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-white",children:i.invoice_number}),e.jsxs("p",{className:"text-sm text-gray-300",children:["Due ",o(i.due_date)]})]})]}),e.jsx("div",{children:e.jsx(J,{variant:"outline",className:u(i.status),children:i.status.charAt(0).toUpperCase()+i.status.slice(1)})})]},i.id))}):e.jsx("div",{className:"text-center py-4 text-white",children:e.jsx("p",{children:"No upcoming payments due"})})})]})]})]})}),e.jsx(L,{value:"invoices",children:e.jsx(ze,{invoices:a||[],onView:i=>{s({title:"Invoice Details",description:`Viewing invoice ${i.invoice_number}`})},onDownload:_})}),e.jsx(L,{value:"payment_methods",children:e.jsx(qe,{})}),e.jsx(L,{value:"token_usage",children:e.jsx(Re,{totalTokens:800})})]})]})}export{ns as default};
