var H=Object.defineProperty,Q=Object.defineProperties;var K=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var C=(n,t,i)=>t in n?H(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i,p=(n,t)=>{for(var i in t||(t={}))X.call(t,i)&&C(n,i,t[i]);if(O)for(var i of O(t))Z.call(t,i)&&C(n,i,t[i]);return n},j=(n,t)=>Q(n,K(t));var P=(n,t,i)=>C(n,typeof t!="symbol"?t+"":t,i);var k=(n,t,i)=>new Promise((h,b)=>{var A=c=>{try{m(i.next(c))}catch(f){b(f)}},d=c=>{try{m(i.throw(c))}catch(f){b(f)}},m=c=>c.done?h(c.value):Promise.resolve(c.value).then(A,d);m((i=i.apply(n,t)).next())});import{r as u,y as ee,j as e,bt as te,X as se,f as ie,m as z,aD as ae,bu as ne,bv as $,bw as re,aa as oe,br as E}from"./vendor-C50ijZWh.js";import{E as x,d as l,I as le}from"./index-Blbobipf.js";import{M as ce}from"./message-loading-CcRIg0Qb.js";import{S as q}from"./SisoIcon-BjkQEkJN.js";import{g as ue,a as B}from"./appPlanAgent-mWIto18d.js";import"./libs-B3eAAgHd.js";import"./supabase-D8k0GRjn.js";const de={enabled:!0,delay:2e3,showProgress:!0,redirectAfterGeneration:!0,redirectUrl:"/app-plan"};class me{constructor(t={}){P(this,"config");P(this,"progressCallbacks",[]);P(this,"isGenerating",!1);this.config=p(p({},de),t)}onProgress(t){return this.progressCallbacks.push(t),()=>{this.progressCallbacks=this.progressCallbacks.filter(i=>i!==t)}}emitProgress(t){this.progressCallbacks.forEach(i=>i(t))}checkAndTrigger(){return k(this,null,function*(){if(!this.config.enabled||this.isGenerating)return!1;const t=ue();if(!t)return console.log("AutoTrigger: No onboarding data found"),!1;const i=B.getLatestPlan();return i&&this.isRecentPlan(i.generatedAt,t.completedAt)?(console.log("AutoTrigger: Recent plan already exists"),!1):(console.log("AutoTrigger: Conditions met, starting generation..."),this.executeAutoGeneration(t))})}executeAutoGeneration(t){return k(this,null,function*(){this.isGenerating=!0;try{this.config.showProgress&&x({title:"ðŸ¤– AI Agent Activated",description:"Analyzing your business requirements to create a comprehensive app plan...",duration:4e3}),yield this.delay(this.config.delay),this.emitProgress({stage:"initializing",progress:10,message:"Setting up AI analysis...",estimatedTimeRemaining:45});const i={businessName:t.businessName,appPurpose:t.appPurpose,industry:t.industry,targetAudience:t.targetAudience,communicationPreference:t.communicationPreference,budget:t.budget,timeline:t.timeline};this.emitProgress({stage:"analyzing",progress:25,message:`Analyzing ${i.industry} industry requirements...`,estimatedTimeRemaining:35}),yield this.delay(2e3),this.emitProgress({stage:"generating",progress:50,message:"AI generating comprehensive app plan...",estimatedTimeRemaining:20});const h=yield B.generatePlan(i,{model:"gpt-4",includeMarketAnalysis:!0,includeCostEstimates:!0,includeWireframes:!1,detailLevel:"detailed",focusAreas:["technical","business","design"]});return this.emitProgress({stage:"structuring",progress:80,message:"Structuring recommendations and timeline...",estimatedTimeRemaining:8}),yield this.delay(2e3),this.emitProgress({stage:"finalizing",progress:95,message:"Finalizing your app development plan...",estimatedTimeRemaining:2}),yield this.delay(1e3),this.emitProgress({stage:"complete",progress:100,message:`App plan ready for ${i.businessName}!`,estimatedTimeRemaining:0}),this.config.showProgress&&x({title:"âœ… App Plan Generated!",description:`Comprehensive plan created for ${i.businessName} with ${h.features.length} features and detailed implementation roadmap.`,duration:5e3}),this.config.redirectAfterGeneration&&setTimeout(()=>{window.location.href=this.config.redirectUrl},2e3),!0}catch(i){return console.error("AutoTrigger: Generation failed",i),this.emitProgress({stage:"complete",progress:0,message:"Generation failed. Please try manually.",estimatedTimeRemaining:0}),this.config.showProgress&&x({title:"âŒ Generation Failed",description:"There was an issue generating your app plan. Please try again manually.",variant:"destructive",duration:5e3}),!1}finally{this.isGenerating=!1}})}isRecentPlan(t,i){const h=new Date(t).getTime(),b=new Date(i).getTime();return h>b}delay(t){return new Promise(i=>setTimeout(i,t))}configure(t){this.config=p(p({},this.config),t)}isCurrentlyGenerating(){return this.isGenerating}forceStop(){this.isGenerating=!1,this.emitProgress({stage:"complete",progress:0,message:"Generation stopped by user.",estimatedTimeRemaining:0})}}const _=new me;function ve(){const[n,t]=u.useState([]),[i,h]=u.useState(""),[b,A]=u.useState(!1),[d,m]=u.useState("intro"),[c,f]=u.useState({businessName:"",appPurpose:"",industry:"",targetAudience:""}),[F,w]=u.useState(!1),[G,o]=u.useState(!1),[v,L]=u.useState(null),[T,M]=u.useState(!1),R=u.useRef(null),y=ee();u.useEffect(()=>{t([{id:"1",role:"assistant",content:"ðŸ‘‹ Hi! I'm SISO, your AI assistant. I'll help you get started by collecting some information about your business. How would you like to communicate with me?",actionComponent:e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs(l,{onClick:()=>I("chat"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"Chat with me (type responses)"]}),e.jsxs(l,{onClick:()=>I("voice"),className:"w-full bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Voice chat (speak responses)"]}),e.jsxs(l,{onClick:()=>I("phone"),className:"w-full bg-orange-600 hover:bg-orange-700 text-white flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"}),"Schedule a phone call"]})]})}])},[]),u.useEffect(()=>{var s;(s=R.current)==null||s.scrollIntoView({behavior:"smooth"})},[n,G]);const I=s=>{L(s);let r="",a=null;s==="chat"?(r="Perfect! I'll ask you a few questions via chat. Let's start with your business information.",a=()=>D()):s==="voice"?(r="Great! I'll ask questions and you can speak your responses. Make sure your microphone is enabled.",a=()=>D()):(r="I'd love to speak with you! Please book a call with our team and we'll collect this information during our conversation.",a=()=>U());const g={id:Date.now().toString(),role:"user",content:s==="chat"?"I want to chat":s==="voice"?"I want to use voice":"I want a phone call"};t(N=>[...N,g]),o(!0),setTimeout(()=>{o(!1);const N={id:Date.now().toString(),role:"assistant",content:r};t(Y=>[...Y,N]),a&&setTimeout(a,1e3)},1e3)},U=()=>{o(!0),setTimeout(()=>{o(!1);const s={id:Date.now().toString(),role:"assistant",content:"Here's how to schedule a call with our team:",actionComponent:e.jsx("div",{className:"mt-4 space-y-3",children:e.jsxs("div",{className:"p-4 bg-orange-500/10 border border-orange-500/30 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-orange-400 mb-2",children:"Schedule Your Call"}),e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Our team will collect your business information and help you get started."}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{className:"w-full bg-orange-600 hover:bg-orange-700 text-white",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Book a 15-minute call"]}),e.jsx(l,{variant:"outline",className:"w-full border-white/20 text-gray-300",onClick:()=>y("/home"),children:"Back to Dashboard"})]})]})})};t(r=>[...r,s])},1e3)},D=()=>{o(!0),setTimeout(()=>{o(!1);const s={id:Date.now().toString(),role:"assistant",content:"What's your business or company name?",requiresAction:!0};t(r=>[...r,s]),m("businessName"),w(!0)},1e3)},V=()=>{T?(M(!1),x({title:"Voice recording stopped",description:"Processing your response..."}),setTimeout(()=>{S("My business name is SISO Agency")},2e3)):(M(!0),x({title:"Voice recording started",description:"Speak your response now..."}))},S=s=>k(this,null,function*(){if(!s.trim()||b)return;w(!1),h("");const r={id:Date.now().toString(),role:"user",content:s};t(a=>[...a,r]),d==="businessName"?(f(a=>j(p({},a),{businessName:s})),o(!0),setTimeout(()=>{o(!1);const a={id:Date.now().toString(),role:"assistant",content:`Great! What do you want your app to do, ${s}? Tell me about the main purpose or problem it will solve.`,requiresAction:!0};t(g=>[...g,a]),m("appPurpose"),w(!0)},1e3)):d==="appPurpose"?(f(a=>j(p({},a),{appPurpose:s})),o(!0),setTimeout(()=>{o(!1);const a={id:Date.now().toString(),role:"assistant",content:"That sounds interesting! What industry are you in? (This is optional, but helps us understand your market)",requiresAction:!0};t(g=>[...g,a]),m("industry"),w(!0)},1e3)):d==="industry"?(f(a=>j(p({},a),{industry:s})),o(!0),setTimeout(()=>{o(!1);const a={id:Date.now().toString(),role:"assistant",content:"Perfect! One last question - who will be using your app? (Your target audience - also optional)",requiresAction:!0};t(g=>[...g,a]),m("targetAudience"),w(!0)},1e3)):d==="targetAudience"&&(f(a=>j(p({},a),{targetAudience:s})),W())}),W=()=>k(this,null,function*(){A(!0);const s={businessName:c.businessName,appPurpose:c.appPurpose,industry:c.industry||"Not specified",targetAudience:c.targetAudience||"Not specified",completedAt:new Date().toISOString(),communicationPreference:v||"chat"};try{localStorage.setItem("business-onboarding-data",JSON.stringify(s)),localStorage.setItem("client-profile",JSON.stringify({company_name:s.businessName,project_description:s.appPurpose,industry:s.industry,target_audience:s.targetAudience,communication_preference:s.communicationPreference,onboarding_completed:!0,onboarding_date:s.completedAt,contact_name:s.businessName,status:"onboarded"}));const r=JSON.parse(localStorage.getItem("workflow-completed-tasks")||"[]");r.includes("workflow-1")||(r.push("workflow-1"),localStorage.setItem("workflow-completed-tasks",JSON.stringify(r))),console.log("ðŸ¤– Triggering automatic app plan generation..."),_.configure({enabled:!0,delay:2e3,showProgress:!0,redirectAfterGeneration:!1,redirectUrl:"/app-plan"});const a=yield _.checkAndTrigger();a&&x({title:"ðŸ¤– AI Agent Activated",description:"Generating your comprehensive app plan in the background...",duration:5e3}),o(!0),setTimeout(()=>{o(!1);const g={id:Date.now().toString(),role:"assistant",content:`Excellent! I've saved your business information. ${s.businessName} sounds like a great project! ðŸŽ‰

${a?"ðŸ¤– I'm also generating a comprehensive app plan for you using AI. This will be ready in about 30-60 seconds!":""}`,actionComponent:e.jsx("div",{className:"mt-4 space-y-3",children:e.jsxs("div",{className:"p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:[e.jsx("h3",{className:"font-medium text-green-400 mb-2",children:"âœ… Step 1 Complete!"}),e.jsxs("p",{className:"text-sm text-gray-300 mb-3",children:["Your business information has been saved. ",a?"AI is generating your app plan automatically!":"Ready for the next step?"]}),e.jsxs("div",{className:"space-y-2",children:[a&&e.jsx(l,{onClick:()=>y("/app-plan"),className:"w-full bg-purple-600 hover:bg-purple-700 text-white",children:"ðŸ¤– View AI App Plan Generator â†’"}),e.jsx(l,{onClick:()=>y("/plan-builder"),className:"w-full bg-orange-600 hover:bg-orange-700 text-white",children:"Next: Define App Requirements â†’"}),e.jsx(l,{onClick:()=>y("/home"),variant:"outline",className:"w-full border-white/20 text-gray-300 hover:bg-white/10",children:"Back to Dashboard"})]})]})})};t(N=>[...N,g]),m("complete"),x({title:"Business information saved! ðŸŽ‰",description:`Welcome ${s.businessName}! Your information has been recorded.`})},1e3)}catch(r){console.error("Error in onboarding completion:",r),x({title:"Error saving information",description:"Please try again",variant:"destructive"})}finally{A(!1)}}),J=()=>{(d==="industry"||d==="targetAudience")&&S("skip")};return e.jsxs("div",{className:"flex flex-col min-h-screen bg-gradient-to-b from-black via-black to-gray-900",children:[e.jsxs("header",{className:"p-4 border-b border-white/10 flex items-center justify-between bg-black/30 backdrop-blur-sm fixed top-0 left-0 right-0 z-10",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>y("/home"),className:"text-gray-300 hover:text-white hover:bg-white/10",children:e.jsx(te,{size:20})}),e.jsx("h1",{className:"text-lg font-medium text-white",children:"Business Onboarding"}),e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>y("/home"),className:"text-gray-300 hover:text-white hover:bg-white/10",children:e.jsx(se,{size:20})})]}),e.jsx("main",{className:"flex-1 max-w-2xl w-full mx-auto px-4 pt-20 pb-24",children:e.jsxs("div",{className:"flex-1 space-y-4 py-4",children:[e.jsxs(ie,{children:[n.map((s,r)=>e.jsx(z.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex max-w-[90%] ${s.role==="user"?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:`flex items-center justify-center h-10 w-10 rounded-full shrink-0 ${s.role==="assistant"?"bg-gradient-to-r from-orange-500 to-red-500":"bg-gray-600"} ${s.role==="user"?"ml-3":"mr-3"}`,children:s.role==="assistant"?e.jsx(q,{className:"w-6 h-6 text-white"}):e.jsx(ae,{size:20,className:"text-white"})}),e.jsxs("div",{className:"flex flex-col",children:[s.role==="assistant"&&e.jsx("span",{className:"text-xs text-gray-400 ml-2 mb-1",children:"SISO"}),e.jsxs("div",{className:`rounded-2xl p-4 ${s.role==="assistant"?"bg-black/40 text-white border border-white/10":"bg-orange-600 text-white"}`,children:[s.content,s.actionComponent]})]})]})},s.id)),G&&e.jsx(z.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start",children:e.jsxs("div",{className:"flex max-w-[80%] flex-row",children:[e.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-full shrink-0 bg-gradient-to-r from-orange-500 to-red-500 mr-3",children:e.jsx(q,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-gray-400 ml-2 mb-1",children:"SISO"}),e.jsx("div",{className:"rounded-2xl p-4 bg-black/40 text-white border border-white/10",children:e.jsx(ce,{})})]})]})})]}),e.jsx("div",{ref:R})]})}),F&&(v==="chat"||v==="voice")&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-black/30 backdrop-blur-sm border-t border-white/10 p-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(le,{value:i,onChange:s=>h(s.target.value),placeholder:v==="voice"?"Speak or type your response...":"Type your response...",onKeyPress:s=>s.key==="Enter"&&S(i),className:"bg-black/30 border-white/20 text-white placeholder:text-gray-500 pr-12"}),v==="voice"&&e.jsx(l,{size:"sm",variant:"ghost",onClick:V,className:`absolute right-2 top-1/2 transform -translate-y-1/2 h-8 w-8 p-0 ${T?"text-red-500 bg-red-500/10":"text-gray-400 hover:text-white"}`,children:T?e.jsx(ne,{className:"h-4 w-4"}):e.jsx($,{className:"h-4 w-4"})})]}),e.jsx(l,{onClick:()=>S(i),size:"icon",className:"bg-orange-600 hover:bg-orange-700 text-white",disabled:!i.trim()||b,children:e.jsx(re,{className:"h-4 w-4"})}),(d==="industry"||d==="targetAudience")&&e.jsx(l,{onClick:J,variant:"outline",size:"sm",className:"border-white/20 text-gray-300 hover:bg-white/10",children:"Skip"})]})})})]})}export{ve as BusinessOnboarding};
