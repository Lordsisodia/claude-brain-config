var v=Object.defineProperty,y=Object.defineProperties;var _=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var x=(e,t,r)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))b.call(t,r)&&x(e,r,t[r]);if(m)for(var r of m(t))w.call(t,r)&&x(e,r,t[r]);return e},h=(e,t)=>y(e,_(t));var l=(e,t,r)=>new Promise((s,c)=>{var u=n=>{try{d(r.next(n))}catch(f){c(f)}},p=n=>{try{d(r.throw(n))}catch(f){c(f)}},d=n=>n.done?s(n.value):Promise.resolve(n.value).then(u,p);d((r=r.apply(e,t)).next())});import{s as i,E as a}from"./index-Blbobipf.js";import{j as o,aZ as j}from"./vendor-C50ijZWh.js";import{G as E}from"./glow-effect-BkabJgn5.js";function F(e){if(!e)return console.error("Received null or undefined transaction data"),{};console.log("Processing transaction data:",e.id);const t=e.category?{id:e.category.id,name:e.category.name,description:e.category.description||"",is_active:e.category.is_active||!0}:void 0,r=e.vendor?{id:e.vendor.id,name:e.vendor.name,is_active:e.vendor.is_active||!0}:void 0,s=e.payment_method?{id:e.payment_method.id,name:e.payment_method.name,is_active:e.payment_method.is_active||!0}:void 0;return{id:e.id,type:e.type||"expense",amount:e.amount||0,currency:e.currency||"GBP",date:e.date,description:e.description||"",status:e.status||"completed",recurring_type:e.recurring_type||null,notes:e.notes||"",receipt_url:e.receipt_url||"",category_id:e.category_id,vendor_id:e.vendor_id,payment_method_id:e.payment_method_id,category:t,vendor:r,payment_method:s}}function k(){return l(this,null,function*(){try{console.log("Starting to fetch transactions"),console.log("Fetching all transactions for admin dashboard");const{data:e,error:t}=yield i.from("financial_transactions").select("*").order("date",{ascending:!1});if(t)return console.error("Error fetching transactions:",t),a({title:"Error",description:"Failed to fetch transactions: "+t.message,variant:"destructive"}),[];if(console.log("Found transactions:",(e==null?void 0:e.length)||0),!e||e.length===0)return[];const r=yield Promise.all(e.map(s=>l(this,null,function*(){let c=null;if(s.category_id){const{data:n}=yield i.from("expense_categories").select("*").eq("id",s.category_id).single();c=n}let u=null;if(s.vendor_id){const{data:n}=yield i.from("vendors").select("*").eq("id",s.vendor_id).single();u=n}let p=null;if(s.payment_method_id){const{data:n}=yield i.from("payment_methods").select("*").eq("id",s.payment_method_id).single();p=n}const d=h(g({},s),{category:c,vendor:u,payment_method:p});return F(d)})));return console.log("Transformed transactions:",r),r}catch(e){return console.error("Unexpected error fetching transactions:",e),a({title:"Error",description:"An unexpected error occurred while fetching transactions: "+String(e),variant:"destructive"}),[]}})}function q(e){return l(this,null,function*(){try{const{error:t}=yield i.from("financial_transactions").delete().eq("id",e);return t?(console.error("Error deleting transaction:",t),a({title:"Error",description:"Failed to delete the transaction",variant:"destructive"}),!1):(a({title:"Success",description:"Transaction deleted successfully"}),!0)}catch(t){return console.error("Unexpected error deleting transaction:",t),a({title:"Error",description:"An unexpected error occurred",variant:"destructive"}),!1}})}function M(e){return l(this,null,function*(){try{const{data:{user:t}}=yield i.auth.getUser();if(!t)return a({title:"Error",description:"You must be logged in to create transactions",variant:"destructive"}),!1;const{error:r}=yield i.from("financial_transactions").insert(h(g({},e),{user_id:t.id}));return r?(console.error("Error creating transaction:",r),a({title:"Error",description:"Failed to create the transaction",variant:"destructive"}),!1):(a({title:"Success",description:"Transaction created successfully"}),!0)}catch(t){return console.error("Unexpected error creating transaction:",t),a({title:"Error",description:"An unexpected error occurred",variant:"destructive"}),!1}})}function P({currentCosts:e,predictedCosts:t}){return o.jsxs("div",{className:"relative h-[200px] w-full",children:[o.jsx(E,{colors:["#FFA726","#FF5722","#FF8A65","#FFCC80"],mode:"static",blur:"medium"}),o.jsxs("div",{className:"relative h-full w-full rounded-lg bg-siso-bg-alt/90 backdrop-blur-xl p-6 text-white border border-siso-orange/20",children:[o.jsxs("div",{className:"flex justify-between items-start mb-8",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-medium mb-1 text-siso-text",children:"Total App Cost"}),o.jsxs("p",{className:"text-3xl font-bold text-siso-text-bold",children:["£",e.toFixed(2)]})]}),o.jsx(j,{className:"h-8 w-8 text-siso-orange"})]}),t&&t>0&&o.jsxs("div",{className:"border-t border-siso-orange/20 pt-4",children:[o.jsx("p",{className:"text-sm text-siso-text-muted mb-1",children:"Predicted Additional Costs"}),o.jsxs("p",{className:"text-xl font-semibold text-siso-orange",children:["£",t.toFixed(2)]})]}),o.jsx("div",{className:"absolute bottom-6 right-6",children:o.jsx("svg",{role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 70 70","aria-label":"Logo",width:"70",height:"70",className:"h-8 w-8 text-siso-orange",fill:"none",children:o.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:"3",d:"M51.883 26.495c-7.277-4.124-18.08-7.004-26.519-7.425-2.357-.118-4.407-.244-6.364 1.06M59.642 51c-10.47-7.25-26.594-13.426-39.514-15.664-3.61-.625-6.744-1.202-9.991.263"})})})]})]})}export{P as E,M as c,q as d,k as f};
