var w=(s,x,a)=>new Promise((h,n)=>{var d=t=>{try{m(a.next(t))}catch(l){n(l)}},j=t=>{try{m(a.throw(t))}catch(l){n(l)}},m=t=>t.done?h(t.value):Promise.resolve(t.value).then(d,j);m((a=a.apply(s,x)).next())});import{r as u,j as e,aY as o,dz as P}from"./vendor-C50ijZWh.js";import{u as C,C as i,f as N,P as D,s as f}from"./index-Blbobipf.js";import{T as S}from"./timeline-C7qdcXYu.js";import{C as v}from"./ClientDashboardLayout-D1WKB6Kc.js";import"./libs-B3eAAgHd.js";import"./supabase-D8k0GRjn.js";import"./sidebar-DSZsRBzS.js";import"./separator-BNrJR0ZO.js";import"./sheet-EfhB7uWf.js";function B(){var t,l;const[s,x]=u.useState(null),[a,h]=u.useState(!0),{toast:n}=C();u.useEffect(()=>{w(this,null,function*(){try{const{data:{user:c}}=yield f.auth.getUser();if(!c)return;const{data:p,error:_}=yield f.rpc("get_client_by_user_id",{user_uuid:c.id});if(_||!p||p.length===0)return;const y=p[0].client_id,{data:g,error:b}=yield f.from("client_onboarding").select("*").eq("id",y).maybeSingle();if(b)throw b;g&&x(g)}catch(c){console.error("Error fetching client data:",c),n({variant:"destructive",title:"Error",description:"Failed to load client data"})}finally{h(!1)}})},[n]);const d=()=>!(s!=null&&s.completed_steps)||!(s!=null&&s.total_steps)?0:s.completed_steps.length/s.total_steps*100,j=r=>{switch(r==null?void 0:r.toLowerCase()){case"active":return"bg-green-500";case"pending":return"bg-yellow-500";case"completed":return"bg-blue-500";default:return"bg-gray-500"}},m=[{title:"Project Kickoff",content:e.jsxs(i,{className:"p-4 bg-white border border-slate-200",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Project Initialization"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Project requirements and goals established"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(o,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"text-xs text-slate-500",children:new Date().toLocaleDateString()})]})]})},{title:"Development",content:e.jsxs(i,{className:"p-4 bg-white border border-slate-200",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Development In Progress"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Building core functionalities and features"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(o,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"text-xs text-slate-500",children:"In Progress"})]})]})},{title:"Testing",content:e.jsxs(i,{className:"p-4 bg-white border border-slate-200",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Quality Assurance"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Testing and bug fixing"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(o,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Upcoming"})]})]})},{title:"Launch",content:e.jsxs(i,{className:"p-4 bg-white border border-slate-200",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Project Deployment"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Final launch and deployment"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(o,{className:"h-4 w-4 text-slate-400"}),e.jsx("span",{className:"text-xs text-slate-500",children:"Planned"})]})]})}];return a?e.jsx(v,{children:e.jsxs("div",{children:[e.jsx(N,{className:"h-10 w-48 mb-6"}),e.jsx(N,{className:"h-64 w-full mb-6 rounded-lg"}),e.jsx(N,{className:"h-96 w-full rounded-lg"})]})}):e.jsx(v,{children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-slate-900",children:"Project Status"}),e.jsxs(i,{className:"p-6 mb-6 border border-slate-200",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:(s==null?void 0:s.project_name)||"Your Project"}),e.jsx("p",{className:"text-slate-500",children:s==null?void 0:s.company_name})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium text-white ${j((s==null?void 0:s.status)||"")}`,children:((t=s==null?void 0:s.status)==null?void 0:t.toUpperCase())||"PENDING"})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("h3",{className:"font-medium",children:"Project Progress"}),e.jsxs("span",{className:"text-sm",children:[Math.round(d()),"%"]})]}),e.jsx(D,{value:d(),className:"h-3"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Start Date"}),e.jsx("p",{className:"font-medium",children:new Date().toLocaleDateString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Estimated Completion"}),e.jsx("p",{className:"font-medium",children:s!=null&&s.estimated_completion_date?new Date(s.estimated_completion_date).toLocaleDateString():"TBD"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Project Manager"}),e.jsx("p",{className:"font-medium",children:"Agency Team"})]})]})]}),e.jsxs(i,{className:"p-6 mb-6 border border-slate-200",children:[e.jsx("h2",{className:"text-xl font-semibold mb-6 text-slate-900",children:"Completed Milestones"}),e.jsxs("div",{className:"space-y-4",children:[((s==null?void 0:s.completed_steps)||[]).map((r,c)=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:e.jsx(P,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:r}),e.jsx("p",{className:"text-sm text-slate-500",children:"Completed"})]})]},c)),(((l=s==null?void 0:s.completed_steps)==null?void 0:l.length)||0)===0&&e.jsx("p",{className:"text-slate-500",children:"No milestones completed yet"})]})]}),e.jsx("h2",{className:"text-xl font-semibold mb-4 text-slate-900",children:"Project Timeline"}),e.jsx(S,{data:m})]})})}export{B as default};
