var P=Object.defineProperty,Z=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var k=(t,n,a)=>n in t?P(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,v=(t,n)=>{for(var a in n||(n={}))x.call(n,a)&&k(t,a,n[a]);if(T)for(var a of T(n))M.call(n,a)&&k(t,a,n[a]);return t},I=(t,n)=>Z(t,N(n));var f=(t,n,a)=>new Promise((i,l)=>{var o=p=>{try{c(a.next(p))}catch(s){l(s)}},y=p=>{try{c(a.throw(p))}catch(s){l(s)}},c=p=>p.done?i(p.value):Promise.resolve(p.value).then(o,y);c((a=a.apply(t,n)).next())});import{r as m}from"./vendor-C50ijZWh.js";import{m as j,s as w}from"./index-Blbobipf.js";function D(){const{user:t,loading:n}=j(),[a,i]=m.useState(!1),[l,o]=m.useState(null),[y,c]=m.useState(!0);return m.useEffect(()=>{n||f(this,null,function*(){if(!(t!=null&&t.id)){i(!1),o(null),c(!1);return}try{const{data:s,error:b}=yield w.from("client_user_links").select("client_id").eq("user_id",t.id).maybeSingle();if(b){console.error("Error checking client status:",b),i(!1),c(!1);return}s!=null&&s.client_id?(i(!0),o(s.client_id)):(i(!1),o(null))}catch(s){console.error("Unexpected error checking client status:",s),i(!1)}finally{c(!1)}})},[t==null?void 0:t.id,n]),{isClient:a,clientId:l,loading:y||n}}const S=[{id:"1",full_name:"Nick Merson",email:"nick@gritness.com",business_name:"Gritness",phone:"+44 7123 456789",avatar_url:null,status:"Not contacted",progress:"In Progress",current_step:5,total_steps:10,completed_steps:["planning","design","wireframes"],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:"https://gritnessgym.vercel.app/",professional_role:"Gym Owner & Personal Trainer",bio:"Experienced fitness trainer specializing in strength training and conditioning. Founded Gritness to provide accessible fitness solutions.",project_name:"Gritness Fitness Platform",company_niche:"Fitness & Health",development_url:"https://gritnessgym.vercel.app/",mvp_build_status:"In Progress",notion_plan_url:"https://sprout-draw-9ec.notion.site/Gym-Client-1b549797be6880a9a8bbdae7bd70e8d7?pvs=4",payment_status:"Not Invoiced",estimated_price:249,initial_contact_date:"2025-01-20T00:00:00Z",start_date:"2025-01-21T00:00:00Z",estimated_completion_date:"2025-04-01T00:00:00Z",contact_name:"Nick Merson",next_steps:"Implement booking system and payment integration",key_research:"Fitness app market analysis, competitor study of MyFitnessPal and ClassPass",priority:"high",todos:[{id:"1",text:"Complete payment gateway integration",completed:!1,priority:"high",due_date:"2025-02-15",assigned_to:"Dev Team"},{id:"2",text:"Implement class booking system",completed:!1,priority:"medium",due_date:"2025-02-20",assigned_to:"Frontend Dev"},{id:"3",text:"Create trainer profiles",completed:!0,priority:"medium",assigned_to:"Designer"}]},{id:"2",full_name:"Nick Merson",email:"nick@nmconstruction.co.uk",business_name:"NM Construction",phone:"+44 7987 654321",avatar_url:null,status:"Contacted",progress:"In Progress",current_step:3,total_steps:10,completed_steps:["planning"],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:"https://nm-construction.vercel.app/",professional_role:"Construction Company Owner",bio:"Established construction business specializing in residential and commercial projects across London.",project_name:"NM Construction Website",company_niche:"Construction & Building",development_url:"https://nm-construction.vercel.app/",mvp_build_status:"In Progress",notion_plan_url:"https://sprout-draw-9ec.notion.site/APP-PLAN-1c149797be6880eb9ddcea624886102e?pvs=4",payment_status:"Not Invoiced",estimated_price:0,initial_contact_date:"2025-01-03T00:00:00Z",start_date:"2025-01-03T00:00:00Z",estimated_completion_date:null,contact_name:"Nick Merson",next_steps:"Finalize requirements and project scope",key_research:"Construction industry web presence best practices, lead generation optimization",priority:"medium",todos:[{id:"4",text:"Gather detailed requirements",completed:!0,priority:"high",assigned_to:"Project Manager"},{id:"5",text:"Create project timeline",completed:!1,priority:"medium",due_date:"2025-02-10",assigned_to:"Project Manager"}]},{id:"3",full_name:"Nick Merson",email:"nick@optimalconstruction.co.uk",business_name:"OPTIMAL CONSTRUCTION",phone:"+44 7456 123789",avatar_url:null,status:"Waiting on client",progress:"In Progress",current_step:4,total_steps:10,completed_steps:["planning","design"],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:"https://optimal-building-maintenance.vercel.app/",professional_role:"Construction Company Director",bio:"Premium construction and maintenance services for high-end residential and commercial properties.",project_name:"Optimal Construction Platform",company_niche:"Premium Construction & Maintenance",development_url:"https://optimal-building-maintenance.vercel.app/",mvp_build_status:"In Progress",notion_plan_url:"https://sprout-draw-9ec.notion.site/Optimal-Construction-App-Plan-1c449797be688094a7f4caed01d5c992?pvs=4",payment_status:"Not Invoiced",estimated_price:15e3,initial_contact_date:"2025-01-03T00:00:00Z",start_date:"2025-01-03T00:00:00Z",estimated_completion_date:null,contact_name:"Nick Merson",next_steps:"Review client feedback on design mockups",key_research:"Premium construction market positioning, luxury brand aesthetics analysis",priority:"high",todos:[{id:"6",text:"Review client feedback on designs",completed:!1,priority:"high",due_date:"2025-02-05",assigned_to:"Design Team"},{id:"7",text:"Implement design revisions",completed:!1,priority:"medium",due_date:"2025-02-12",assigned_to:"Frontend Dev"}]},{id:"4",full_name:"SISO",email:"hello@ubahcryp.com",business_name:"UbahCryp",phone:"+44 7321 987654",avatar_url:null,status:"Feedback from app",progress:"Completed",current_step:10,total_steps:10,completed_steps:["planning","design","development","testing","deployment"],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:"https://ubahcrypcom.vercel.app/",professional_role:"Cryptocurrency Trading Platform Founder",bio:"Blockchain enthusiast and trader with expertise in DeFi protocols and cryptocurrency market analysis.",project_name:"UbahCryp Trading Platform",company_niche:"Web3 & Cryptocurrency Trading",development_url:"https://ubahcrypcom.vercel.app/",mvp_build_status:"Completed",notion_plan_url:"https://sprout-draw-9ec.notion.site/APP-PLAN-1c349797be6880a18876de37e53f1c61?pvs=4",payment_status:"Not Invoiced",estimated_price:5e3,initial_contact_date:"2025-03-20T00:00:00Z",start_date:"2025-03-21T00:00:00Z",estimated_completion_date:"2025-03-20T00:00:00Z",contact_name:"SISO",next_steps:"Ongoing maintenance and feature enhancement",key_research:"Cryptocurrency exchange UI/UX patterns, regulatory compliance requirements",priority:"high",todos:[{id:"8",text:"Deploy to production",completed:!0,priority:"high",assigned_to:"DevOps"},{id:"9",text:"Setup monitoring and analytics",completed:!0,priority:"medium",assigned_to:"Backend Dev"},{id:"10",text:"Client training session",completed:!1,priority:"medium",due_date:"2025-02-01",assigned_to:"Project Manager"}]},{id:"5",full_name:"ALJ",email:"hello@elementree.co.uk",business_name:"Elementree",phone:"+44 7654 321987",avatar_url:null,status:"Not contacted",progress:"In Progress",current_step:6,total_steps:10,completed_steps:["planning","design","wireframes","development"],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:"https://elementree.vercel.app/",professional_role:"Restaurant Owner & Chef",bio:"Passionate chef running a modern fusion restaurant focused on sustainable and locally-sourced ingredients.",project_name:"Elementree Restaurant Platform",company_niche:"Restaurant & Food Service",development_url:"https://elementree.vercel.app/",mvp_build_status:"In Progress",notion_plan_url:"https://sprout-draw-9ec.notion.site/Elementree-Client-1be49797be688097a460d838c4db0178?pvs=4",payment_status:"Not Invoiced",estimated_price:0,initial_contact_date:null,start_date:null,estimated_completion_date:null,contact_name:"ALJ",next_steps:"Implement online ordering and reservation system",key_research:"Restaurant POS system integrations, food delivery platform APIs",priority:"medium",todos:[{id:"11",text:"Design menu management system",completed:!1,priority:"high",due_date:"2025-02-08",assigned_to:"Backend Dev"},{id:"12",text:"Integrate payment processing",completed:!1,priority:"high",due_date:"2025-02-15",assigned_to:"Full Stack Dev"}]},{id:"6",full_name:"IBBY",email:"info@trojanmma.co.uk",business_name:"Trojan MMA",phone:"+44 7789 654123",avatar_url:null,status:"Not contacted",progress:"In Progress",current_step:4,total_steps:10,completed_steps:["planning","design"],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:"https://trojan-mma.vercel.app/",professional_role:"MMA Gym Owner & Head Coach",bio:"Professional MMA coach with 15+ years experience training fighters at all levels from amateur to professional.",project_name:"Trojan MMA Training Platform",company_niche:"Mixed Martial Arts & Combat Sports",development_url:"https://trojan-mma.vercel.app/",mvp_build_status:"In Progress",notion_plan_url:"https://sprout-draw-9ec.notion.site/Trojan-MMA-Client-1bd49797be688012965cf72cea1aa939?pvs=4",payment_status:"Not Invoiced",estimated_price:249,initial_contact_date:"2025-03-27T00:00:00Z",start_date:null,estimated_completion_date:"2025-03-27T00:00:00Z",contact_name:"IBBY",next_steps:"Initial consultation and requirements gathering",key_research:"MMA gym management software, fighter training tracking systems",priority:"medium",todos:[{id:"13",text:"Schedule initial client meeting",completed:!1,priority:"high",due_date:"2025-02-03",assigned_to:"Sales Team"},{id:"14",text:"Prepare project proposal",completed:!1,priority:"medium",due_date:"2025-02-05",assigned_to:"Project Manager"},{id:"15",text:"Research competitor websites",completed:!0,priority:"low",assigned_to:"Research Team"}]},{id:"7",full_name:"Stevie",email:null,business_name:"Lets go",phone:null,avatar_url:null,status:"Feedback from app",progress:"In Progress",current_step:7,total_steps:10,completed_steps:["planning","design","wireframes","development","testing"],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:"https://lets-go-u7hh.vercel.app/",professional_role:"Founder",bio:"App",project_name:"Lets go",company_niche:"App",development_url:"https://lets-go-u7hh.vercel.app/",mvp_build_status:"In Progress",notion_plan_url:"https://sprout-draw-9ec.notion.site/APP-PLAN-1c249797be6880619c93e589737f78ae?pvs=4",payment_status:"Confirmed",estimated_price:249,initial_contact_date:"2025-03-26T00:00:00Z",start_date:"2025-03-26T00:00:00Z",estimated_completion_date:"2025-03-26T00:00:00Z",contact_name:"Stevie",next_steps:"Client feedback implementation",priority:"high"},{id:"8",full_name:"SISO",email:null,business_name:"Mu Shin",phone:null,avatar_url:null,status:"Declined",progress:"Completed",current_step:10,total_steps:10,completed_steps:["planning","design","development","testing","deployment"],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:"https://siso-mu-shin.vercel.app/",professional_role:"Instructor",bio:"Self Defense Course",project_name:"Mu Shin",company_niche:"Self Defense Course",development_url:"https://siso-mu-shin.vercel.app/",mvp_build_status:"Completed",notion_plan_url:"https://sprout-draw-9ec.notion.site/Martial-Arts-Court-Client-1bd49797be68805d9002d52c394cebbb?pvs=4",payment_status:"Declined",estimated_price:0,initial_contact_date:"2025-03-20T00:00:00Z",start_date:"2025-03-20T00:00:00Z",estimated_completion_date:"2025-03-20T00:00:00Z",contact_name:"SISO",next_steps:"Project archived",priority:"low"},{id:"9",full_name:"Nick Merson",email:null,business_name:"5 Star Hire",phone:null,avatar_url:null,status:"Not contacted",progress:"In Progress",current_step:3,total_steps:10,completed_steps:["planning"],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:"https://5-star-hire.vercel.app/",professional_role:"Owner",bio:"Car Hire",project_name:"5 Star Hire",company_niche:"Car hire",development_url:"https://5-star-hire.vercel.app/",mvp_build_status:"In Progress",notion_plan_url:null,payment_status:"Not Invoiced",estimated_price:null,initial_contact_date:null,start_date:null,estimated_completion_date:null,contact_name:"Nick Merson",next_steps:"Initial contact",priority:"medium"},{id:"10",full_name:"SISO",email:null,business_name:"Keegan Saas",phone:null,avatar_url:null,status:"Waiting on client",progress:"Not Started",current_step:1,total_steps:10,completed_steps:[],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:null,professional_role:"Founder",bio:"SaaS",project_name:"Keegan Saas",company_niche:"Saas",development_url:null,mvp_build_status:"Not Started",notion_plan_url:null,payment_status:"Not Invoiced",estimated_price:null,initial_contact_date:null,start_date:null,estimated_completion_date:null,contact_name:"SISO",next_steps:"Initial consultation",priority:"low"},{id:"11",full_name:"SISO",email:null,business_name:"Freddy Consultancy LP",phone:null,avatar_url:null,status:"Waiting on client",progress:"Not Started",current_step:1,total_steps:10,completed_steps:[],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:null,professional_role:"Consultant",bio:"Consultancy",project_name:"Freddy Consultancy LP",company_niche:"Agency",development_url:null,mvp_build_status:"Not Started",notion_plan_url:null,payment_status:"Not Invoiced",estimated_price:0,initial_contact_date:null,start_date:null,estimated_completion_date:null,contact_name:"SISO",next_steps:"Initial consultation",priority:"low"},{id:"12",full_name:"Unknown",email:null,business_name:"Football player marketplace",phone:null,avatar_url:null,status:"Not contacted",progress:"Not Started",current_step:1,total_steps:10,completed_steps:[],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:null,professional_role:"Owner",bio:"Sports",project_name:"Football player marketplace",company_niche:"Football player marketplace",development_url:null,mvp_build_status:null,notion_plan_url:null,payment_status:"Not Invoiced",estimated_price:null,initial_contact_date:null,start_date:null,estimated_completion_date:null,contact_name:"Unknown",next_steps:"Initial contact",priority:"low"},{id:"13",full_name:"Unknown",email:null,business_name:"Ikkys Barbershop",phone:null,avatar_url:null,status:"Not contacted",progress:"Not Started",current_step:1,total_steps:10,completed_steps:[],created_at:"2025-01-25T00:00:00Z",updated_at:"2025-01-25T00:00:00Z",website_url:null,professional_role:"Owner",bio:"Barbershop",project_name:"Ikkys Barbershop",company_niche:"Barbershop",development_url:null,mvp_build_status:null,notion_plan_url:null,payment_status:"Not Invoiced",estimated_price:null,initial_contact_date:null,start_date:null,estimated_completion_date:null,contact_name:"Unknown",next_steps:"Initial contact",priority:"low"}];function L(t=null){const{isClient:n,clientId:a,loading:i}=D(),[l,o]=m.useState(null),[y,c]=m.useState(!0),[p,s]=m.useState(!1),[b,h]=m.useState(null),d=t||a;return m.useEffect(()=>{(!i||t)&&f(this,null,function*(){if(!d&&!t){o(null),c(!1);return}try{const{data:e,error:g}=yield w.from("client_onboarding").select("*").eq("id",d).single();if(g||!e){console.log("Client not found in database, checking sample data...");const _=S.find(C=>C.id===d);_?(console.log("Found client in sample data:",_.business_name),o(_),h(null)):(console.error("Client not found in sample data either"),h(new Error("Client not found")),o(null))}else{let _=[];if(e.todos)try{_=Array.isArray(e.todos)?e.todos.map(u=>({id:u.id||crypto.randomUUID(),text:u.text||"",completed:!!u.completed,priority:u.priority||"medium",due_date:u.due_date,related_to:u.related_to,assigned_to:u.assigned_to})):[]}catch(u){console.warn("Error parsing todos:",u),_=[]}const C={id:e.id,full_name:e.contact_name||"Unknown",email:null,business_name:e.company_name||null,phone:null,avatar_url:null,status:e.status,progress:e.progress||"Not Started",current_step:e.current_step,total_steps:e.total_steps,completed_steps:e.completed_steps||[],created_at:e.created_at,updated_at:e.updated_at,website_url:e.website_url||null,professional_role:null,bio:null,project_name:e.project_name||null,company_niche:e.company_niche||null,development_url:null,mvp_build_status:null,notion_plan_url:null,payment_status:null,estimated_price:e.estimated_price||null,initial_contact_date:null,start_date:null,estimated_completion_date:null,todos:_,next_steps:null,key_research:null,priority:null,contact_name:e.contact_name||null,company_name:e.company_name||null};o(C),h(null)}}catch(e){console.error("Error in fetchClientData:",e);const g=S.find(_=>_.id===d);g?(console.log("Using sample data due to error:",g.business_name),o(g),h(null)):(h(e instanceof Error?e:new Error("Unknown error")),o(null))}finally{c(!1)}})},[n,d,i,t]),{clientData:l,loading:y,error:b,updateTodos:r=>f(this,null,function*(){if(!(!d||!l)){s(!0);try{const{error:e}=yield w.from("client_onboarding").update({todos:JSON.parse(JSON.stringify(r))}).eq("id",d);if(e)throw e;o(I(v({},l),{todos:r}))}catch(e){console.error("Error updating todos:",e),h(e instanceof Error?e:new Error("Failed to update todos"))}finally{s(!1)}}}),updateClient:r=>f(this,null,function*(){if(!(!d||!l)){s(!0);try{const e={contact_name:r.full_name,company_name:r.business_name,website_url:r.website_url,project_name:r.project_name,company_niche:r.company_niche,status:r.status,current_step:r.current_step,total_steps:r.total_steps,completed_steps:r.completed_steps},{error:g}=yield w.from("client_onboarding").update(e).eq("id",d);if(g)throw g;o(v(v({},l),r))}catch(e){console.error("Error updating client:",e),h(e instanceof Error?e:new Error("Failed to update client"))}finally{s(!1)}}}),isUpdating:p,isLoading:y}}export{D as a,S as s,L as u};
