var Zs=Object.defineProperty,et=Object.defineProperties;var st=Object.getOwnPropertyDescriptors;var Ie=Object.getOwnPropertySymbols;var cs=Object.prototype.hasOwnProperty,ds=Object.prototype.propertyIsEnumerable;var Ve=(n,a,s)=>a in n?Zs(n,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[a]=s,O=(n,a)=>{for(var s in a||(a={}))cs.call(a,s)&&Ve(n,s,a[s]);if(Ie)for(var s of Ie(a))ds.call(a,s)&&Ve(n,s,a[s]);return n},W=(n,a)=>et(n,st(a));var ae=(n,a)=>{var s={};for(var t in n)cs.call(n,t)&&a.indexOf(t)<0&&(s[t]=n[t]);if(n!=null&&Ie)for(var t of Ie(n))a.indexOf(t)<0&&ds.call(n,t)&&(s[t]=n[t]);return s};var we=(n,a,s)=>Ve(n,typeof a!="symbol"?a+"":a,s);var L=(n,a,s)=>new Promise((t,r)=>{var i=l=>{try{c(s.next(l))}catch(w){r(w)}},g=l=>{try{c(s.throw(l))}catch(w){r(w)}},c=l=>l.done?t(l.value):Promise.resolve(l.value).then(i,g);c((s=s.apply(n,a)).next())});import{R as _,j as e,X as Le,cE as vs,m as oe,bp as tt,f as Pe,d6 as at,d7 as rt,d8 as nt,bv as it,d9 as ot,cF as lt,a4 as ct,a5 as dt,a6 as ut,da as gt,a3 as ws,db as mt,dc as js,dd as ht,de as Ns,df as ks,r as y,dg as pt,bq as xt,at as ft,cD as Cs,bV as yt,dh as Ts,bA as Oe,av as Ye,a$ as de,aD as es,aY as pe,bX as Ss,aQ as xe,bT as As,aW as Qe,aM as bt,b7 as Je,di as vt,d3 as Is,dj as Ds,b0 as us,y as wt,c9 as Xe,cB as jt,am as Me,b3 as Nt,by as kt,dk as Ct,cM as Es,aC as $e,aF as Tt,dl as St,dm as At,dn as It,dp as Dt,cq as Et,b6 as gs,c3 as ms,c2 as hs}from"./vendor-C50ijZWh.js";import{A as Pt}from"./AdminLayout-BZL16QJ9.js";import{h as I,s as J,I as he,B as ne,d as U,K as Mt,A as $t,q as Ot,l as Lt,u as _t}from"./index-Blbobipf.js";import{v as le}from"./voiceService--omXRrmC.js";import{P as _e,a as Fe,b as Re}from"./popover-BCE2rLYx.js";import{C as Ps}from"./calendar-CM33CvjS.js";import{D as Ms,a as $s,b as Os,c as Ft}from"./dialog-CB9qAGL5.js";import{T as Rt}from"./textarea-B56zo4Tx.js";import{S as Ne,a as ke,b as Ce,c as Te,d as Z}from"./select-Ba1tjTaP.js";import{T as zt,a as Kt,b as Be,c as Ge}from"./tabs-CsM4ZGNr.js";import{aM as Ut,aN as Ht,c1 as qt,aU as Vt,c2 as Bt,aS as Gt,a$ as De,c3 as Wt,aQ as Yt}from"./libs-B3eAAgHd.js";import{u as Qt,a as Jt}from"./useTasks-mVqPh9Ik.js";import"./supabase-D8k0GRjn.js";const Xt=`
  *:focus-visible {
    outline-offset: 0 !important;
    --ring-offset: 0 !important;
  }
  textarea::-webkit-scrollbar {
    width: 6px;
  }
  textarea::-webkit-scrollbar-track {
    background: transparent;
  }
  textarea::-webkit-scrollbar-thumb {
    background-color: #444444;
    border-radius: 3px;
  }
  textarea::-webkit-scrollbar-thumb:hover {
    background-color: #555555;
  }
`;if(typeof document!="undefined"&&!document.getElementById("ai-prompt-box-styles")){const a=document.createElement("style");a.id="ai-prompt-box-styles",a.innerText=Xt,document.head.appendChild(a)}const Ls=_.forwardRef((t,s)=>{var r=t,{className:n}=r,a=ae(r,["className"]);return e.jsx("textarea",O({className:I("flex w-full rounded-md border-none bg-transparent px-3 py-2.5 text-base text-gray-900 placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-0 disabled:cursor-not-allowed disabled:opacity-50 min-h-[44px] resize-none scrollbar-thin scrollbar-thumb-[#444444] scrollbar-track-transparent hover:scrollbar-thumb-[#555555]",n),ref:s,rows:1},a))});Ls.displayName="Textarea";const Zt=ct,ea=dt,sa=ut,_s=_.forwardRef((r,t)=>{var i=r,{className:n,sideOffset:a=4}=i,s=ae(i,["className","sideOffset"]);return e.jsx(ws,O({ref:t,sideOffset:a,className:I("z-50 overflow-hidden rounded-md border border-[#333333] bg-[#1F2023] px-3 py-1.5 text-sm text-white shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n)},s))});_s.displayName=ws.displayName;const ta=gt,aa=mt,Fs=_.forwardRef((t,s)=>{var r=t,{className:n}=r,a=ae(r,["className"]);return e.jsx(ks,O({ref:s,className:I("fixed inset-0 z-50 bg-black/60 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",n)},a))});Fs.displayName=ks.displayName;const Rs=_.forwardRef((r,t)=>{var i=r,{className:n,children:a}=i,s=ae(i,["className","children"]);return e.jsxs(aa,{children:[e.jsx(Fs,{}),e.jsxs(js,W(O({ref:t,className:I("fixed left-[50%] top-[50%] z-50 grid w-full max-w-[90vw] md:max-w-[800px] translate-x-[-50%] translate-y-[-50%] gap-4 border border-[#333333] bg-[#1F2023] p-0 shadow-xl duration-300 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 rounded-2xl",n)},s),{children:[a,e.jsxs(ht,{className:"absolute right-4 top-4 z-10 rounded-full bg-[#2E3033]/80 p-2 hover:bg-[#2E3033] transition-all",children:[e.jsx(Le,{className:"h-5 w-5 text-gray-200 hover:text-white"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]}))]})});Rs.displayName=js.displayName;const zs=_.forwardRef((t,s)=>{var r=t,{className:n}=r,a=ae(r,["className"]);return e.jsx(Ns,O({ref:s,className:I("text-lg font-semibold leading-none tracking-tight text-gray-100",n)},a))});zs.displayName=Ns.displayName;const Ze=_.forwardRef((i,r)=>{var g=i,{className:n,variant:a="default",size:s="default"}=g,t=ae(g,["className","variant","size"]);const c={default:"bg-white hover:bg-white/80 text-black",outline:"border border-[#444444] bg-transparent hover:bg-[#3A3A40]",ghost:"bg-transparent hover:bg-[#3A3A40]"},l={default:"h-10 px-4 py-2",sm:"h-8 px-3 text-sm",lg:"h-12 px-6",icon:"h-8 w-8 rounded-full aspect-[1/1]"};return e.jsx("button",O({className:I("inline-flex items-center justify-center font-medium transition-colors focus-visible:outline-none disabled:pointer-events-none disabled:opacity-50",c[a],l[s],n),ref:r},t))});Ze.displayName="Button";const ra=()=>{const[n,a]=_.useState(!1),[s,t]=_.useState(""),[r,i]=_.useState(null),[g,c]=_.useState(!1),l=_.useCallback(()=>L(void 0,null,function*(){return new Promise((T,k)=>{if(!le.isSpeechRecognitionSupported()){const h="Speech recognition not supported in this browser";i(h),k(new Error(h));return}if(g){console.warn("⚠️ [VOICE INPUT] Already processing voice input, ignoring duplicate request");return}a(!0),c(!0),i(null),t("");let b="",S=!1;le.startListening((h,$)=>{console.log("📝 [VOICE INPUT] Transcript update:",{text:h,isFinal:$,length:h.length}),t(h),$&&h.trim()&&!S&&(S=!0,b=h,a(!1),c(!1),setTimeout(()=>{T(b)},200))},h=>{S||(i(h),a(!1),c(!1),t(""),k(new Error(h)))},{language:"en-US",continuous:!1,interimResults:!0}).catch(h=>{S||(i(h.message),a(!1),c(!1),k(h))})})}),[g]),w=_.useCallback(()=>{le.stopListening(),a(!1),c(!1),t("")},[]);return{isRecording:n,transcript:s,error:r,startRecording:l,stopRecording:w,isProcessing:g,clearError:()=>i(null)}},na=({isRecording:n,onStartRecording:a,onStopRecording:s,visualizerBars:t=32,transcript:r})=>{const[i,g]=_.useState(0),c=_.useRef(null);_.useEffect(()=>(n?(a(),c.current=setInterval(()=>g(w=>w+1),1e3)):(c.current&&(clearInterval(c.current),c.current=null),s(i),g(0)),()=>{c.current&&clearInterval(c.current)}),[n,i,a,s]);const l=w=>{const T=Math.floor(w/60),k=w%60;return`${T}:${k.toString().padStart(2,"0")}`};return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#1F2023] rounded-lg border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-red-400 text-sm font-medium",children:"Recording"})]}),e.jsx("span",{className:"text-gray-300 text-sm",children:l(i)})]}),r&&e.jsx("div",{className:"flex-1 mx-4 p-2 bg-gray-800/50 rounded text-sm text-gray-200",children:r||"Listening..."}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(t,20)}).map((w,T)=>e.jsx("div",{className:"w-1 bg-red-400 rounded-full animate-pulse",style:{height:`${Math.random()*20+10}px`,animationDelay:`${T*50}ms`}},T))})]})},ia=({imageUrl:n,onClose:a})=>n?e.jsx(ta,{open:!!n,onOpenChange:a,children:e.jsxs(Rs,{className:"p-0 border-none bg-transparent shadow-none max-w-[90vw] md:max-w-[800px]",children:[e.jsx(zs,{className:"sr-only",children:"Image Preview"}),e.jsx(oe.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2,ease:"easeOut"},className:"relative bg-[#1F2023] rounded-2xl overflow-hidden shadow-2xl",children:e.jsx("img",{src:n,alt:"Full preview",className:"w-full max-h-[80vh] object-contain rounded-2xl"})})]})}):null,Ks=_.createContext({isLoading:!1,value:"",setValue:()=>{},maxHeight:240,onSubmit:void 0,disabled:!1});function Us(){const n=_.useContext(Ks);if(!n)throw new Error("usePromptInput must be used within a PromptInput");return n}const Hs=_.forwardRef(({className:n,style:a,isLoading:s=!1,maxHeight:t=240,value:r,onValueChange:i,onSubmit:g,children:c,disabled:l=!1,onDragOver:w,onDragLeave:T,onDrop:k},b)=>{const[S,h]=_.useState(r||""),$=P=>{h(P),i==null||i(P)};return e.jsx(Zt,{children:e.jsx(Ks.Provider,{value:{isLoading:s,value:r!=null?r:S,setValue:i!=null?i:$,maxHeight:t,onSubmit:g,disabled:l},children:e.jsx("div",{ref:b,className:I("rounded-3xl border border-[#444444] bg-[#1F2023] p-2 shadow-[0_8px_30px_rgba(0,0,0,0.24)] transition-all duration-300",s&&"border-red-500/70",n),onDragOver:w,onDragLeave:T,onDrop:k,style:a,children:c})})})});Hs.displayName="PromptInput";const oa=i=>{var g=i,{className:n,onKeyDown:a,disableAutosize:s=!1,placeholder:t}=g,r=ae(g,["className","onKeyDown","disableAutosize","placeholder"]);const{value:c,setValue:l,maxHeight:w,onSubmit:T,disabled:k}=Us(),b=_.useRef(null);_.useEffect(()=>{s||!b.current||(b.current.style.height="auto",b.current.style.height=typeof w=="number"?`${Math.min(b.current.scrollHeight,w)}px`:`min(${b.current.scrollHeight}px, ${w})`)},[c,w,s]);const S=h=>{h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),T==null||T()),a==null||a(h)};return e.jsx(Ls,O({ref:b,value:c,onChange:h=>l(h.target.value),onKeyDown:S,className:I("text-base",n),disabled:k,placeholder:t},r))},la=t=>{var r=t,{children:n,className:a}=r,s=ae(r,["children","className"]);return e.jsx("div",W(O({className:I("flex items-center gap-2",a)},s),{children:n}))},We=i=>{var g=i,{tooltip:n,children:a,className:s,side:t="top"}=g,r=ae(g,["tooltip","children","className","side"]);const{disabled:c}=Us();return e.jsxs(ea,W(O({},r),{children:[e.jsx(sa,{asChild:!0,disabled:c,children:a}),e.jsx(_s,{side:t,className:s,children:n})]}))},ps=()=>e.jsx("div",{className:"relative h-6 w-[1.5px] mx-1",children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-transparent via-[#9b87f5]/70 to-transparent rounded-full",style:{clipPath:"polygon(0% 0%, 100% 0%, 100% 40%, 140% 50%, 100% 60%, 100% 100%, 0% 100%, 0% 60%, -40% 50%, 0% 40%)"}})}),ss=_.forwardRef((n,a)=>{const{onSend:s=()=>{},isLoading:t=!1,placeholder:r="Type your message here...",className:i,style:g,disabled:c=!1,isThinking:l=!1}=n,w=t||c||l,[T,k]=_.useState(""),[b,S]=_.useState([]),[h,$]=_.useState({}),[P,q]=_.useState(null),[N,V]=_.useState(!1),[C,D]=_.useState(!1),[E,x]=_.useState(!1),z=_.useRef(null),B=_.useRef(null),{isRecording:j,transcript:d,error:A,startRecording:K,stopRecording:Y,isProcessing:u,clearError:m}=ra(),f=v=>{v==="search"?(V(G=>!G),D(!1),x(!1)):v==="think"&&(D(G=>!G),V(!1),x(!1))},F=()=>x(v=>!v),H=v=>v.type.startsWith("image/"),M=v=>{if(!(b.length>=10)&&(S(G=>[...G,v]),H(v))){const G=new FileReader;G.onload=ee=>{var ie;(ie=ee.target)!=null&&ie.result&&$(ye=>W(O({},ye),{[v.name]:ee.target.result}))},G.readAsDataURL(v)}},ge=v=>{const G=b[v];S(ee=>ee.filter((ie,ye)=>ye!==v)),H(G)&&$(ee=>{const ie=O({},ee);return delete ie[G.name],ie})},re=v=>q(v),se=v=>{v.preventDefault(),v.stopPropagation()},X=v=>{v.preventDefault(),v.stopPropagation()},ze=v=>{v.preventDefault(),v.stopPropagation(),Array.from(v.dataTransfer.files).forEach(M)},fe=()=>{T.trim()===""&&b.length===0||(s==null||s(T,b),k(""),S([]),$({}))},Ke=()=>L(void 0,null,function*(){if(j)console.log("🛑 [VOICE INPUT] Stopping voice recording..."),Y();else{if(console.log("🎤 [VOICE INPUT] Starting voice recording session"),!le.isSpeechRecognitionSupported()){alert(`🚫 Speech recognition is not supported in this browser.

For best results, please use:
• Chrome (recommended)
• Edge
• Safari (newer versions)`);return}if(location.protocol!=="https:"&&location.hostname!=="localhost"){alert(`🔒 Voice recognition requires a secure connection.

Please use HTTPS or localhost to enable microphone access.`);return}try{console.log("🔐 [VOICE INPUT] Checking microphone permissions..."),(yield le.checkMicrophonePermissions())||(console.warn("⚠️ [VOICE INPUT] No microphone permission, but trying speech recognition anyway..."),alert(`🎤 Microphone permission needed!

1. Click the microphone icon 🎤 in your browser address bar
2. Select "Allow" for microphone access
3. Try again`))}catch(v){console.warn("⚠️ [VOICE INPUT] Permission check failed:",v)}try{console.log("🚀 [VOICE INPUT] Initiating speech recognition...");const v=yield K();console.log("✅ [VOICE INPUT] Voice recording completed successfully"),console.log("📝 [VOICE INPUT] Final transcript:",v),v.trim()?(console.log("🎯 [VOICE INPUT] Setting transcript as input value"),k(v),console.log("✅ [VOICE INPUT] Voice input set, ready for manual submission")):console.warn("⚠️ [VOICE INPUT] Empty transcript received")}catch(v){console.error("❌ [VOICE INPUT] Voice recording failed:",v);let G="❌ Voice recording failed: ";v.message.includes("not-allowed")||v.message.includes("permission")?G+=`

🔧 Fix: Click the microphone icon 🎤 in your browser address bar and select "Allow"`:v.message.includes("no-speech")?G+=`

🔧 Try speaking louder or closer to your microphone`:v.message.includes("network")?G+=`

🔧 Check your internet connection`:G+=v.message,alert(G)}}}),me=T.trim()!==""||b.length>0;return e.jsxs(e.Fragment,{children:[e.jsxs(Hs,{value:T,onValueChange:k,isLoading:w,onSubmit:fe,className:I("w-full bg-[#1F2023] border-[#444444] shadow-[0_8px_30px_rgba(0,0,0,0.24)] transition-all duration-300 ease-in-out",j&&"border-red-500/70",i),disabled:w||j||u,ref:a||B,onDragOver:se,onDragLeave:X,onDrop:ze,style:g,children:[b.length>0&&!j&&e.jsx("div",{className:"flex flex-wrap gap-2 p-0 pb-1 transition-all duration-300",children:b.map((v,G)=>e.jsx("div",{className:"relative group",children:v.type.startsWith("image/")&&h[v.name]&&e.jsxs("div",{className:"w-16 h-16 rounded-xl overflow-hidden cursor-pointer transition-all duration-300",onClick:()=>re(h[v.name]),children:[e.jsx("img",{src:h[v.name],alt:v.name,className:"h-full w-full object-cover"}),e.jsx("button",{onClick:ee=>{ee.stopPropagation(),ge(G)},className:"absolute top-1 right-1 rounded-full bg-black/70 p-0.5 opacity-100 transition-opacity",children:e.jsx(Le,{className:"h-3 w-3 text-white"})})]})},G))}),(j||u)&&e.jsxs("div",{className:"mb-3 p-3 bg-orange-500/10 border border-orange-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-orange-400 text-sm font-medium",children:j?"🎤 Listening...":"⏳ Processing voice input..."})]}),d&&e.jsxs("div",{className:"text-gray-300 text-sm italic",children:['"',d,'"']})]}),A&&e.jsxs("div",{className:"mb-3 p-2 bg-red-500/10 border border-red-500/30 rounded-lg flex items-center justify-between",children:[e.jsxs("span",{className:"text-red-400 text-sm",children:["⚠️ ",A]}),e.jsx("button",{onClick:m,className:"text-red-400 hover:text-red-300 text-sm",children:"×"})]}),e.jsx("div",{className:I("transition-all duration-300",j||u?"h-0 overflow-hidden opacity-0":"opacity-100"),children:e.jsx(oa,{placeholder:N?"Search the web...":C?"Think deeply...":E?"Create on canvas...":r,className:"text-base"})}),j&&e.jsx(na,{isRecording:j,onStartRecording:()=>console.log("Voice recording started"),onStopRecording:v=>console.log(`Voice recording stopped. Duration: ${v} seconds`),transcript:d}),e.jsxs(la,{className:"flex items-center justify-between gap-2 p-0 pt-2",children:[e.jsxs("div",{className:I("flex items-center gap-1 transition-opacity duration-300",j||u?"opacity-0 invisible h-0":"opacity-100 visible"),children:[e.jsx(We,{tooltip:"Upload image",children:e.jsxs("button",{onClick:()=>{var v;return(v=z.current)==null?void 0:v.click()},className:"flex h-8 w-8 text-[#9CA3AF] cursor-pointer items-center justify-center rounded-full transition-colors hover:bg-gray-600/30 hover:text-[#D1D5DB]",disabled:j||u,children:[e.jsx(vs,{className:"h-5 w-5 transition-colors"}),e.jsx("input",{ref:z,type:"file",className:"hidden",onChange:v=>{v.target.files&&v.target.files.length>0&&M(v.target.files[0]),v.target&&(v.target.value="")},accept:"image/*"})]})}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs("button",{type:"button",onClick:()=>f("search"),className:I("rounded-full transition-all flex items-center gap-1 px-2 py-1 border h-8",N?"bg-[#1EAEDB]/15 border-[#1EAEDB] text-[#1EAEDB]":"bg-transparent border-transparent text-[#9CA3AF] hover:text-[#D1D5DB]"),children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:e.jsx(oe.div,{animate:{rotate:N?360:0,scale:N?1.1:1},whileHover:{rotate:N?360:15,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:e.jsx(tt,{className:I("w-4 h-4",N?"text-[#1EAEDB]":"text-inherit")})})}),e.jsx(Pe,{children:N&&e.jsx(oe.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-xs overflow-hidden whitespace-nowrap text-[#1EAEDB] flex-shrink-0",children:"Search"})})]}),e.jsx(ps,{}),e.jsxs("button",{type:"button",onClick:()=>f("think"),className:I("rounded-full transition-all flex items-center gap-1 px-2 py-1 border h-8",C?"bg-[#8B5CF6]/15 border-[#8B5CF6] text-[#8B5CF6]":"bg-transparent border-transparent text-[#9CA3AF] hover:text-[#D1D5DB]"),children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:e.jsx(oe.div,{animate:{rotate:C?360:0,scale:C?1.1:1},whileHover:{rotate:C?360:15,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:e.jsx(at,{className:I("w-4 h-4",C?"text-[#8B5CF6]":"text-inherit")})})}),e.jsx(Pe,{children:C&&e.jsx(oe.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-xs overflow-hidden whitespace-nowrap text-[#8B5CF6] flex-shrink-0",children:"Think"})})]}),e.jsx(ps,{}),e.jsxs("button",{type:"button",onClick:F,className:I("rounded-full transition-all flex items-center gap-1 px-2 py-1 border h-8",E?"bg-[#F97316]/15 border-[#F97316] text-[#F97316]":"bg-transparent border-transparent text-[#9CA3AF] hover:text-[#D1D5DB]"),children:[e.jsx("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:e.jsx(oe.div,{animate:{rotate:E?360:0,scale:E?1.1:1},whileHover:{rotate:E?360:15,transition:{type:"spring",stiffness:300,damping:10}},transition:{type:"spring",stiffness:260,damping:25},children:e.jsx(rt,{className:I("w-4 h-4",E?"text-[#F97316]":"text-inherit")})})}),e.jsx(Pe,{children:E&&e.jsx(oe.span,{initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},exit:{width:0,opacity:0},transition:{duration:.2},className:"text-xs overflow-hidden whitespace-nowrap text-[#F97316] flex-shrink-0",children:"Canvas"})})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{tooltip:j?"Stop voice recording":"Start voice recording",children:e.jsx(Ze,{variant:"default",size:"icon",className:I("h-8 w-8 rounded-full transition-all duration-200",j?"bg-red-500 hover:bg-red-600 text-white animate-pulse":"bg-orange-500 hover:bg-orange-600 text-white"),onClick:Ke,disabled:w||u,children:j?e.jsx(nt,{className:"h-4 w-4"}):e.jsx(it,{className:"h-4 w-4"})})}),e.jsx(We,{tooltip:w?"Stop generation":me?"Send message":"Type a message or use voice",children:e.jsx(Ze,{variant:"default",size:"icon",className:I("h-8 w-8 rounded-full transition-all duration-200",me?"bg-white hover:bg-white/80 text-[#1F2023]":"bg-gray-600 hover:bg-gray-700 text-gray-400"),onClick:fe,disabled:!me||w||j||u,children:w?e.jsx(ot,{className:"h-4 w-4 fill-[#1F2023] animate-pulse"}):e.jsx(lt,{className:"h-4 w-4"})})})]})]})]}),e.jsx(ia,{imageUrl:P,onClose:()=>q(null)})]})});ss.displayName="PromptInputBox";const ca=()=>{const{supabase:n}=require("./client");return n};class da{getCurrentUser(){return L(this,null,function*(){const{data:{user:a}}=yield J.auth.getUser();if(!a)throw new Error("User not authenticated");return a})}parseCommand(a,s){const t=a.toLowerCase().trim();if(console.log("🧠 [AI TASK AGENT] Parsing command:",a),console.log("🧠 [AI TASK AGENT] Conversation context:",(s==null?void 0:s.length)||0,"previous messages"),this.shouldSplitTask(a))return this.splitIntoMultipleTasks(a);if(this.isImplicitTaskCreation(a))return console.log("🎯 [AI TASK AGENT] Detected implicit task creation request"),this.createImplicitTask(a,s);if(this.isContextualTaskCreation(a))return console.log("🔍 [AI TASK AGENT] Detected contextual task creation request"),this.createContextualTask(a,s);if(t.includes("delete")&&(t.includes("all")||t.includes("tasks"))||t.includes("clear all")||t.includes("remove all")||t.match(/delet.*all.*task/)||t.match(/clear.*task/)){const r={action:"deleteAll",target:"all"};return t.includes("main")?r.filters={category:"main"}:t.includes("weekly")?r.filters={category:"weekly"}:t.includes("daily")?r.filters={category:"daily"}:t.includes("development")||t.includes("dev")?r.filters={category:"siso_app_dev"}:t.includes("onboarding")?r.filters={category:"onboarding_app"}:t.includes("instagram")?r.filters={category:"instagram"}:(t.includes("siso life")||t.includes("life tasks")||t.includes("personal"))&&(r.filters={category:"siso_life"}),t.includes("urgent")?r.filters=W(O({},r.filters),{priority:"urgent"}):t.includes("high priority")?r.filters=W(O({},r.filters),{priority:"high"}):t.includes("medium priority")?r.filters=W(O({},r.filters),{priority:"medium"}):t.includes("low priority")?r.filters=W(O({},r.filters),{priority:"low"}):t.includes("backlog")&&(r.filters=W(O({},r.filters),{priority:"backlog"})),t.includes("pending")?r.filters=W(O({},r.filters),{status:"pending"}):t.includes("in progress")||t.includes("in_progress")?r.filters=W(O({},r.filters),{status:"in_progress"}):t.includes("completed")&&(r.filters=W(O({},r.filters),{status:"completed"})),r}if(t.includes("create")||t.includes("add")||t.includes("new task")){const r={action:"create"},i={},g=a.match(/(?:create|add|new task)\s+(.+)/i);g&&(i.title=g[1].trim()),t.includes("urgent")?i.priority="urgent":t.includes("high priority")?i.priority="high":t.includes("medium priority")?i.priority="medium":t.includes("low priority")?i.priority="low":t.includes("backlog")?i.priority="backlog":i.priority="medium",t.includes("main")?i.category="main":t.includes("weekly")?i.category="weekly":t.includes("daily")?i.category="daily":t.includes("uber crypt")||t.includes("ubahcrypt")||t.includes("ubercryt")||t.includes("uber crypto")||t.includes("trading")||t.includes("crypto")||t.includes("cryptocurrency")||t.includes("blockchain")?(i.category="siso_app_dev",i.title.toString().includes("[Ubahcrypt]")||(i.title=`[Ubahcrypt] ${i.title}`)):t.includes("development")||t.includes("dev")||t.includes("siso agency")||t.includes("lifelock")||t.includes("life lock")||t.includes("isos agency")||t.includes("siso agency app")?i.category="siso_app_dev":t.includes("onboarding")?i.category="onboarding_app":t.includes("instagram")?i.category="instagram":t.includes("siso life")||t.includes("life tasks")||t.includes("personal")?i.category="siso_life":i.category="main";const c=a.match(/(\d+(?:\.\d+)?)\s*(?:hours?|hrs?|h)/i);return c&&(i.estimatedHours=parseFloat(c[1])),r.content=i,r}if(t.includes("complete")||t.includes("finish")||t.includes("done")){const r={action:"complete"};return t.includes("all")&&(r.target="all"),t.includes("main")?r.filters={category:"main"}:t.includes("weekly")?r.filters={category:"weekly"}:t.includes("daily")&&(r.filters={category:"daily"}),r}return t.includes("status")||t.includes("progress")||t.includes("how many")||t.includes("list")?{action:"status"}:{action:"status"}}isImplicitTaskCreation(a){const s=a.toLowerCase();return[/^we need to\s+/,/^i need to\s+/,/^let's\s+/,/^should\s+/,/^we should\s+/,/^i should\s+/,/^need to\s+/,/^have to\s+/,/^must\s+/,/^time to\s+/,/^going to\s+/,/^plan to\s+/,/^want to\s+/,/^would like to\s+/,/^thinking about\s+/,/^considering\s+/,/^working on\s+/,/^building\s+/,/^developing\s+/,/^implementing\s+/,/^creating\s+/,/^make\s+/,/^build\s+/,/^develop\s+/,/^implement\s+/,/^design\s+/,/^setup\s+/,/^set up\s+/,/^configure\s+/,/^install\s+/,/^integrate\s+/,/^fix\s+/,/^update\s+/,/^improve\s+/,/^optimize\s+/,/^enhance\s+/,/^refactor\s+/,/^migrate\s+/,/^deploy\s+/,/^test\s+/,/^debug\s+/,/^review\s+/,/^analyze\s+/,/^research\s+/,/^investigate\s+/,/^explore\s+/,/^document\s+/,/^write\s+/,/^prepare\s+/,/^organize\s+/,/^plan\s+/,/^schedule\s+/,/^coordinate\s+/,/^manage\s+/,/^handle\s+/,/^process\s+/,/^complete\s+/,/^finish\s+/].some(r=>r.test(s))}isContextualTaskCreation(a){const s=a.toLowerCase();return[/create.*task.*for.*this/,/add.*task.*for.*this/,/make.*task.*for.*this/,/create.*task.*about.*this/,/add.*task.*about.*this/,/make.*task.*about.*this/,/create.*task.*from.*this/,/add.*task.*from.*this/,/make.*task.*from.*this/,/turn.*this.*into.*task/,/convert.*this.*to.*task/,/make.*this.*a.*task/,/create.*a.*task/,/add.*a.*task/,/make.*a.*task/,/task.*for.*this/,/task.*about.*this/,/task.*from.*this/].some(r=>r.test(s))}createImplicitTask(a,s){const t=a.toLowerCase();let r=a;const i=["we need to ","i need to ","let's ","should ","we should ","i should ","need to ","have to ","must ","time to ","going to ","plan to ","want to ","would like to ","thinking about ","considering ","working on "];for(const w of i)if(t.startsWith(w)){r=a.substring(w.length).trim();break}r=this.cleanupTaskText(r);const g=this.detectCategory(r),c=this.detectPriority(r);console.log("🎯 [AI TASK AGENT] Creating implicit task:",{original:a,cleaned:r,category:g,priority:c});const l=this.addProjectPrefix(r,a);return{action:"create",content:{title:l,category:g,priority:c,description:this.generateTaskDescription(l,g,c)}}}createContextualTask(a,s){let t="Complete previous discussion item",r="main";if(s&&s.length>0){const l=this.findMostRelevantContext(s);l&&(t=this.cleanupTaskText(l),r=this.detectCategory(t),console.log("🔍 [AI TASK AGENT] Using conversation context for task:",{context:l,extracted:t,category:r}))}t==="Complete previous discussion item"&&a.length>20&&(t=this.cleanupTaskText(a.replace(/create.*task.*for.*this|add.*task.*for.*this|make.*task.*for.*this/gi,"").trim()),t.length<10&&(t="Complete the discussed task"));const i=this.detectPriority(t);console.log("🔍 [AI TASK AGENT] Creating contextual task:",{original:a,context:(s==null?void 0:s.length)||0,extracted:t,category:r,priority:i});const g=s?a+" "+s.join(" "):a,c=this.addProjectPrefix(t,g);return{action:"create",content:{title:c,category:r,priority:i,description:this.generateTaskDescription(c,r,i)}}}detectCategory(a){const s=a.toLowerCase();return s.includes("uber crypt")||s.includes("ubahcrypt")||s.includes("ubercryt")||s.includes("uber crypto")||s.includes("trading")||s.includes("crypto")||s.includes("cryptocurrency")||s.includes("blockchain")||s.includes("binance")||s.includes("exchange")||s.includes("wallet")||s.includes("defi")||s.includes("siso agency")||s.includes("siso app")||s.includes("partnership program")||s.includes("lifelock")||s.includes("life lock")||s.includes("app development")||s.includes("react")||s.includes("typescript")||s.includes("supabase")||s.includes("database")||s.includes("frontend")||s.includes("backend")||s.includes("api")||s.includes("ui")||s.includes("ux")?"siso_app_dev":s.includes("onboarding")||s.includes("client setup")||s.includes("user registration")||s.includes("welcome")?"onboarding_app":s.includes("instagram")||s.includes("social media")||s.includes("marketing")||s.includes("leads")||s.includes("outreach")||s.includes("campaign")?"instagram":s.includes("daily")||s.includes("routine")||s.includes("every day")||s.includes("recurring")?"daily":s.includes("weekly")||s.includes("every week")||s.includes("weekly review")||s.includes("weekly planning")?"weekly":"main"}addProjectPrefix(a,s){const t=s.toLowerCase();return(t.includes("uber crypt")||t.includes("ubahcrypt")||t.includes("ubercryt")||t.includes("uber crypto")||t.includes("trading")||t.includes("crypto")||t.includes("cryptocurrency")||t.includes("blockchain")||t.includes("binance")||t.includes("exchange")||t.includes("wallet")||t.includes("defi"))&&!a.includes("[Ubahcrypt]")?`[Ubahcrypt] ${a}`:a}detectPriority(a){const s=a.toLowerCase();return s.includes("urgent")||s.includes("asap")||s.includes("immediately")||s.includes("critical")||s.includes("emergency")||s.includes("now")||s.includes("right away")||s.includes("today")?"urgent":s.includes("important")||s.includes("priority")||s.includes("deadline")||s.includes("due")||s.includes("soon")||s.includes("quickly")||s.includes("fast")||s.includes("this week")?"high":s.includes("when time permits")||s.includes("eventually")||s.includes("someday")||s.includes("nice to have")||s.includes("optional")||s.includes("later")||s.includes("future")||s.includes("backlog")?"low":"medium"}findMostRelevantContext(a){if(!a||a.length===0)return null;for(let s=a.length-1;s>=0;s--){const t=a[s],r=t.toLowerCase();if(!(r.includes("create task")||r.includes("add task")||r.includes("make task")||t.trim().length<10)&&(r.includes("need to")||r.includes("should")||r.includes("want to")||r.includes("partnership")||r.includes("program")||r.includes("feature")||r.includes("fix")||r.includes("build")||r.includes("create")||r.includes("develop")||r.includes("implement")||r.includes("app")||r.includes("project")||t.trim().length>20))return t}return a[a.length-1]||null}shouldSplitTask(a){const s=a.toLowerCase();return["and also","also","plus","then","after that","fix.*and.*test","build.*and.*push","create.*and.*test","update.*and.*deploy"].some(r=>s.includes(r)||s.match(new RegExp(r)))}splitIntoMultipleTasks(a){const s=a.toLowerCase(),t=[];let r="main";return s.includes("siso agency app")||s.includes("app dev")||s.includes("siso agency")||s.includes("lifelock")||s.includes("life lock")||s.includes("isos agency")||s.includes("development")||s.includes("dev")?r="siso_app_dev":s.includes("onboarding")?r="onboarding_app":s.includes("instagram")&&(r="instagram"),s.includes("landing page")&&s.includes("fix")&&t.push({action:"create",content:{title:"Fix SISO Agency Landing Page",description:"Review and fix issues with the landing page layout, content, and functionality",priority:"high",category:r}}),s.includes("task section")&&s.includes("test")&&t.push({action:"create",content:{title:"Test Task Section Functionality",description:"Thoroughly test the task management section for bugs and usability issues",priority:"medium",category:r}}),s.includes("push")&&s.includes("github")&&t.push({action:"create",content:{title:"Push Changes to GitHub",description:"Commit and push all completed changes to the GitHub repository",priority:"medium",category:r}}),s.includes("pull")&&s.includes("test")&&t.push({action:"create",content:{title:"Create Pull Request and Test",description:"Create a pull request for the changes and run automated tests",priority:"medium",category:r}}),t.length===0&&t.push({action:"create",content:{title:a.length>60?a.substring(0,60)+"...":a,description:"Task created from: "+a,priority:"medium",category:r}}),t}executeMultipleCommands(a){return L(this,null,function*(){const s=[];let t=0;for(const g of a)try{const c=yield this.executeSingleCommand(g);s.push(c),c.affectedCount&&(t+=c.affectedCount)}catch(c){console.error("Failed to execute command:",g,c),s.push({success:!1,message:`Failed to execute: ${c instanceof Error?c.message:"Unknown error"}`,action:g.action})}const r=s.filter(g=>g.success).length,i=s.length-r;return{success:r>0,message:`✅ Created ${r} tasks successfully${i>0?` (${i} failed)`:""}:
${s.filter(g=>g.success).map(g=>`• ${g.message}`).join(`
`)}`,action:"create_multiple",data:s,affectedCount:t}})}executeCommand(a){return L(this,null,function*(){return yield this.getCurrentUser(),console.log("⚡ [AI TASK AGENT] Executing command:",a),Array.isArray(a)?yield this.executeMultipleCommands(a):yield this.executeSingleCommand(a)})}executeSingleCommand(a){return L(this,null,function*(){try{switch(a.action){case"deleteAll":return yield this.deleteAllTasks(a.filters);case"create":return yield this.createTask(a.content);case"complete":return yield this.completeTasks(a.filters);case"status":return yield this.getTaskStatus(a.filters,void 0);default:return{success:!1,message:"Unknown command. I can help you create, delete, complete, or check status of tasks.",action:"error"}}}catch(s){console.error("❌ [AI TASK AGENT] Command execution failed:",s);let t="Unknown error occurred";return s instanceof Error&&(t=s.message,t.includes("infinite recursion")||t.includes("policy")?t="Database permission issue. Please check your access rights.":t.includes("not found")?t="No tasks found matching your criteria.":t.includes("network")&&(t="Network connection issue. Please try again.")),{success:!1,message:`Failed to execute command: ${t}`,action:"error"}}})}deleteAllTasks(a,s){return L(this,null,function*(){try{console.log("🔧 [AI TASK AGENT] Database RLS detected, attempting direct query with fallback...");try{const{data:{user:t}}=yield J.auth.getUser();if(t){const{data:r,error:i}=yield J.from("tasks").select("id, title, priority, status, category").eq("assigned_to",t.id);!i&&r&&(console.log("✅ [AI TASK AGENT] Direct query successful, using database data"),s=r)}}catch(t){console.log("⚠️ [AI TASK AGENT] Direct query failed, falling back to UI data")}return!s||s.length===0?{success:!1,message:`❌ **Task Access Issue**

⚠️ Cannot access task data due to database policy configuration.

**Quick Fix Options:**
1. **Manual SQL Fix**: Run the RLS policy fix in Supabase Dashboard
2. **Reload Page**: Sometimes a page refresh resolves temporary issues
3. **Check Tasks Page**: View tasks directly in the Tasks section

💡 The task system is working, just needs a policy adjustment in the database.`,action:"deleteAll",affectedCount:0}:this.processRealTaskDeletion(s,a)}catch(t){return console.error("Delete all tasks error:",t),{success:!1,message:`Failed to process tasks: ${t instanceof Error?t.message:"Unknown error"}`,action:"deleteAll",affectedCount:0}}})}processRealTaskDeletion(a,s){return L(this,null,function*(){console.log("🔧 [AI TASK AGENT] Processing real task data:",a.length,"tasks found");let t=a.filter(l=>typeof l=="object"&&l!==null);s!=null&&s.category&&(t=t.filter(l=>l.category===s.category)),s!=null&&s.priority&&(t=t.filter(l=>l.priority===s.priority)),s!=null&&s.status?t=t.filter(l=>l.status===s.status):t=t.filter(l=>l.status!=="completed"&&!l.completed);const r=t.length,i=this.buildFilterDescription(s);if(console.log("🔧 [AI TASK AGENT] Filtered tasks for deletion:",r),r===0)return{success:!0,message:`No ${i}tasks found to delete.`,action:"deleteAll",affectedCount:0};const g=t.slice(0,3).map(l=>`"${l.title||"Untitled"}"`).join(", "),c=t.length>3?` and ${t.length-3} more`:"";try{const{data:{user:l}}=yield J.auth.getUser();if(!l)return{success:!1,message:"❌ Authentication required to delete tasks.",action:"deleteAll",affectedCount:0,data:[]};const w=t.map(b=>b.id),T=ca(),{error:k}=yield T.from("tasks").delete().in("id",w);return k?(console.error("Delete error:",k),{success:!1,message:`❌ Failed to delete tasks: ${k.message}`,action:"deleteAll",affectedCount:0,data:[]}):{success:!0,message:`✅ Successfully deleted ${r} ${i}task${r!==1?"s":""}:

${g}${c}`,action:"deleteAll",affectedCount:r,data:t}}catch(l){return console.error("Deletion error:",l),{success:!1,message:`❌ Error deleting tasks: ${l instanceof Error?l.message:"Unknown error"}`,action:"deleteAll",affectedCount:0,data:[]}}})}cleanupTaskText(a){if(!a)return a;let s=a.replace(/\bteh\b/gi,"the").replace(/\bimporving\b/gi,"improving").replace(/\bintergate\b/gi,"integrate").replace(/\bfunctinal\b/gi,"functional").replace(/\badn\b/gi,"and").replace(/\bplease\s*$/gi,"").replace(/\bui\b/gi,"UI").replace(/\bapi\b/gi,"API").replace(/\bsiso\b/gi,"SISO").replace(/\blike\s*log\b/gi,"LifeLock").replace(/\blifelock\b/gi,"LifeLock").replace(/\blife\s*lock\b/gi,"LifeLock").replace(/\bisos\s*agency\b/gi,"SISO Agency").replace(/\bsiso\s*agency\b/gi,"SISO Agency").replace(/\bsiso\s*agency\s*app\b/gi,"SISO Agency App").replace(/\bstuidly\b/gi,"stupidly").replace(/\bannoeyd\b/gi,"annoyed").replace(/\bspellign\b/gi,"spelling").replace(/\bpunctinality\b/gi,"punctuation").replace(/\badded\b/gi,"added").replace(/\bdsuccessfully\b/gi,"successfully").replace(/\s+/g," ").replace(/\s*,\s*/g,", ").replace(/\s*\.\s*/g,". ").trim();return s.length>0&&(s=s.charAt(0).toUpperCase()+s.slice(1),/[.!?]$/.test(s)||(s+=".")),(s.toLowerCase().includes("life lock")||s.toLowerCase().includes("lifelock"))&&(s=s.replace(/life\s*lock/gi,"LifeLock")),s}generateTaskDescription(a,s,t){const r=a.toLowerCase();let i="";if(r.includes("fix")||r.includes("bug")||r.includes("error"))i=`Investigate and resolve the issue described in: "${a}". Review the current implementation, identify the root cause, and implement a proper fix. Test thoroughly to ensure the issue is completely resolved.`;else if(r.includes("test")||r.includes("testing"))i=`Comprehensive testing of the feature or functionality mentioned in: "${a}". Create test cases, execute manual and automated tests, document any issues found, and verify all requirements are met.`;else if(r.includes("create")||r.includes("add")||r.includes("implement"))i=`Implementation of new functionality: "${a}". Plan the approach, design the solution architecture, implement the feature following best practices, and ensure proper integration with existing systems.`;else if(r.includes("update")||r.includes("modify")||r.includes("improve"))i=`Enhancement and optimization of existing functionality: "${a}". Analyze current implementation, identify improvement opportunities, implement changes, and verify enhanced performance or usability.`;else if(r.includes("deploy")||r.includes("release")||r.includes("publish"))i=`Deployment and release management for: "${a}". Prepare release artifacts, coordinate deployment process, monitor system health, and ensure successful rollout with rollback plan if needed.`;else if(r.includes("design")||r.includes("ui")||r.includes("interface"))i=`User interface and experience design work: "${a}". Create mockups or wireframes, implement responsive design, ensure accessibility compliance, and conduct usability testing.`;else if(r.includes("database")||r.includes("migration")||r.includes("schema"))i=`Database-related work: "${a}". Design or modify database schema, create migration scripts, ensure data integrity, and optimize query performance.`;else if(r.includes("api")||r.includes("endpoint")||r.includes("service"))i=`API development and integration: "${a}". Design API endpoints, implement business logic, ensure proper error handling, and create comprehensive documentation.`;else if(r.includes("security")||r.includes("auth")||r.includes("permission"))i=`Security and authentication implementation: "${a}". Implement secure authentication flow, configure proper permissions, audit security vulnerabilities, and ensure compliance standards.`;else if(r.includes("performance")||r.includes("optimize")||r.includes("speed"))i=`Performance optimization work: "${a}". Profile current performance, identify bottlenecks, implement optimizations, and measure improvement metrics.`;else if(r.includes("documentation")||r.includes("readme")||r.includes("guide"))i=`Documentation creation and maintenance: "${a}". Write clear, comprehensive documentation, include code examples, update existing docs, and ensure information accuracy.`;else switch(s){case"siso_app_dev":case"development":i=`Development task: "${a}". Implement the required functionality following SISO development standards, ensure code quality, and include appropriate testing.`;break;case"onboarding_app":i=`Onboarding application task: "${a}". Focus on improving user experience during the onboarding process, ensure smooth workflow, and maintain consistency with existing features.`;break;case"instagram":case"marketing":i=`Marketing and social media task: "${a}". Execute marketing strategy, engage with target audience, and measure campaign effectiveness.`;break;case"weekly":i=`Weekly recurring task: "${a}". Complete as part of regular weekly workflow, maintain consistency with previous executions, and document any changes or improvements.`;break;case"daily":i=`Daily routine task: "${a}". Execute as part of daily workflow, ensure timely completion, and maintain quality standards.`;break;default:i=`Task: "${a}". Complete the specified work according to requirements, ensure quality delivery, and coordinate with team members as needed.`}return t==="high"||t==="urgent"?i+=" **HIGH PRIORITY** - This task requires immediate attention and should be completed as soon as possible.":t==="low"&&(i+=" This task can be completed when time permits and other priorities are addressed."),this.cleanupTaskText(i)}createTask(a){return L(this,null,function*(){if(!(a!=null&&a.title))throw new Error("Task title is required");try{const s=yield this.getCurrentUser(),t=this.cleanupTaskText(a.title),r=a.priority||"medium",i=a.category||"main";let g=a.description?this.cleanupTaskText(a.description):void 0;g||(g=this.generateTaskDescription(t,i,r));const c={title:t,description:g,priority:r,category:i,status:"pending",created_by:s.id,assigned_to:s.id,due_date:a.dueDate,estimated_hours:a.estimatedHours},{data:l,error:w}=yield J.from("tasks").insert(c).select().single();if(w)throw console.error("Task creation failed:",w),w;return console.log("✅ Task successfully created in database:",l),{success:!0,message:`Created ${a.priority||"medium"} priority task: "${t}"`,action:"create",data:l,affectedCount:1}}catch(s){throw console.error("Create task error:",s),s}})}completeTasks(a){return L(this,null,function*(){const s=yield this.getCurrentUser();let t=J.from("tasks").update({status:"completed",completed_at:new Date().toISOString()}).or(`created_by.eq.${s.id},assigned_to.eq.${s.id}`).neq("status","completed");a!=null&&a.category&&(t=t.eq("category",a.category)),a!=null&&a.priority&&(t=t.eq("priority",a.priority));const{error:r,count:i}=yield t;if(r)throw r;const g=i||0,c=this.buildFilterDescription(a);return{success:!0,message:`Completed ${g} ${c}task${g!==1?"s":""}.`,action:"complete",affectedCount:g}})}getTaskStatus(a,s){return L(this,null,function*(){try{console.log("🔧 [AI TASK AGENT] Attempting to get task status...");let t=[];if(s)t=s;else try{const{data:{user:l}}=yield J.auth.getUser();if(l){const{data:w,error:T}=yield J.from("tasks").select("*").eq("assigned_to",l.id);!T&&w?(console.log("✅ [AI TASK AGENT] Successfully fetched tasks from database"),t=w):(console.log("⚠️ [AI TASK AGENT] Database query failed, trying fallback..."),t=[])}}catch(l){console.log("⚠️ [AI TASK AGENT] Database access failed, using empty task list"),t=[]}if(t.length===0)return{success:!0,message:`📊 **Task Status**

**No tasks found** - Either you haven't created any tasks yet, or there may be a database access issue.

**Try:**
1. Create a new task with "create task [description]"
2. Refresh the page and try again
3. Check the Tasks page in the admin panel

**Note:** If you see tasks in the UI but not here, there may be a database policy issue.`,action:"status",data:{stats:{total:0,pending:0,inProgress:0,completed:0,highPriority:0,overdue:0,byCategory:{}},tasks:[]}};const r=t.filter(l=>typeof l=="object"&&l!==null);console.log("🔧 [AI TASK AGENT] Processing task status data:",r.length,"tasks");const i={total:r.length,pending:r.filter(l=>!l.completed&&l.status!=="completed").length,inProgress:r.filter(l=>l.status==="in-progress"||l.status==="in_progress").length,completed:r.filter(l=>l.completed||l.status==="completed"||l.status==="done").length,highPriority:r.filter(l=>l.priority==="high"||l.priority==="urgent").length,overdue:r.filter(l=>l.status==="overdue").length,byCategory:{main:r.filter(l=>l.category==="main"||l.category==="development").length,weekly:r.filter(l=>l.category==="weekly").length,daily:r.filter(l=>l.category==="daily").length,development:r.filter(l=>l.category==="development"||l.category==="siso_app_dev").length,onboarding:r.filter(l=>l.category==="onboarding"||l.category==="onboarding_app").length,instagram:r.filter(l=>l.category==="instagram"||l.category==="marketing").length}},g=r.filter(l=>!l.completed&&l.status!=="completed").slice(0,3).map(l=>`• ${l.title||"Untitled"}`).join(`
`);return{success:!0,message:`📊 **Current Task Status (from UI State)**

**Total Tasks:** ${i.total}
**Active:** ${i.pending+i.inProgress} (${i.pending} pending, ${i.inProgress} in progress)
**Completed:** ${i.completed}
**High Priority:** ${i.highPriority}
**Overdue:** ${i.overdue}

**By Category:**
• Main: ${i.byCategory.main}
• Weekly: ${i.byCategory.weekly}
• Daily: ${i.byCategory.daily}
• Development: ${i.byCategory.development}
• Onboarding: ${i.byCategory.onboarding}
• Instagram: ${i.byCategory.instagram}

`+(g?`**Recent Active Tasks:**
${g}

`:"")+"⚠️ **Note**: Using UI state data due to database RLS policy issues. Fix Supabase policies for live database access.",action:"status",data:{stats:i,tasks:r}}}catch(t){throw console.error("Get task status error:",t),t}})}buildFilterDescription(a){const s=[];return a!=null&&a.category&&s.push(a.category),a!=null&&a.priority&&s.push(`${a.priority} priority`),a!=null&&a.status&&s.push(a.status),s.length>0?`${s.join(" ")} `:""}processInput(a,s){return L(this,null,function*(){console.log("🎯 [AI TASK AGENT] Processing input:",a),console.log("🧠 [AI TASK AGENT] Conversation context:",(s==null?void 0:s.length)||0,"messages");const t=this.parseCommand(a,s);console.log("📋 [AI TASK AGENT] Parsed command:",t);const r=yield this.executeCommand(t);return console.log("✅ [AI TASK AGENT] Response:",r),r})}}const xs=new da;class ua{constructor(a="ai_task_chat"){we(this,"sessionKey");we(this,"userId",null);we(this,"conversationId",null);we(this,"memoryCache",[]);this.sessionKey=a}initialize(){return L(this,null,function*(){try{const{data:{user:a}}=yield J.auth.getUser();a?(this.userId=a.id,yield this.loadOrCreateConversation()):console.warn("🔍 [CHAT MEMORY] User not authenticated, using session-only memory")}catch(a){console.error("❌ [CHAT MEMORY] Failed to initialize:",a)}})}loadOrCreateConversation(){return L(this,null,function*(){if(this.userId)try{const{data:a}=yield J.from("agent_conversations").select("*").eq("user_id",this.userId).eq("telegram_chat_id",this.sessionKey.hashCode()).order("updated_at",{ascending:!1}).limit(1);if(a&&a.length>0)this.conversationId=a[0].id,this.memoryCache=this.parseConversationHistory(a[0].conversation_history),console.log("✅ [CHAT MEMORY] Loaded existing conversation:",this.conversationId);else{const{data:s}=yield J.from("agent_conversations").insert({user_id:this.userId,telegram_chat_id:this.sessionKey.hashCode(),conversation_history:[],context:{}}).select().single();s&&(this.conversationId=s.id,console.log("✅ [CHAT MEMORY] Created new conversation:",this.conversationId))}}catch(a){console.error("❌ [CHAT MEMORY] Failed to load/create conversation:",a)}})}saveMessage(a){return L(this,null,function*(){if(this.memoryCache.push(a),this.memoryCache.length>50&&(this.memoryCache=this.memoryCache.slice(-50)),this.conversationId)try{const s=this.memoryCache.map(t=>({id:t.id,content:t.content,sender:t.sender,timestamp:t.timestamp.toISOString()}));yield J.from("agent_conversations").update({conversation_history:s,updated_at:new Date().toISOString()}).eq("id",this.conversationId),console.log("✅ [CHAT MEMORY] Saved message to database")}catch(s){console.error("❌ [CHAT MEMORY] Failed to save message:",s)}})}getConversationContext(a=10){return this.memoryCache.slice(-a).filter(s=>s.sender==="user").map(s=>s.content)}getAllMessages(){return[...this.memoryCache]}getMessagesBySender(a,s){const t=this.memoryCache.filter(r=>r.sender===a);return s?t.slice(-s):t}clearConversation(){return L(this,null,function*(){if(this.memoryCache=[],this.conversationId)try{yield J.from("agent_conversations").update({conversation_history:[],updated_at:new Date().toISOString()}).eq("id",this.conversationId),console.log("✅ [CHAT MEMORY] Cleared conversation")}catch(a){console.error("❌ [CHAT MEMORY] Failed to clear conversation:",a)}})}parseConversationHistory(a){return Array.isArray(a)?a.filter(s=>typeof s=="object"&&s!==null).map(s=>({id:s.id||Date.now().toString(),content:s.content||"",sender:s.sender==="assistant"?"assistant":"user",timestamp:new Date(s.timestamp||new Date)})):[]}getConversationSummary(){return this.memoryCache.length===0?"":`Recent conversation topics: ${this.memoryCache.filter(t=>t.sender==="user").slice(-5).map(t=>t.content).join(", ")}`}hasContextAbout(a){const s=a.toLowerCase();return this.memoryCache.some(t=>t.content.toLowerCase().includes(s))}getLastMessageContaining(a){const s=this.memoryCache.filter(t=>t.sender==="user");for(let t=s.length-1;t>=0;t--){const r=s[t];if(a.some(i=>r.content.toLowerCase().includes(i.toLowerCase())))return r}return null}}String.prototype.hashCode=function(){let n=0;if(this.length===0)return n;for(let a=0;a<this.length;a++){const s=this.charCodeAt(a);n=(n<<5)-n+s,n=n&n}return Math.abs(n)};const je=new ua,ga=({tasks:n,chatMessages:a,onTasksUpdate:s,onChatUpdate:t,onTaskRefresh:r})=>{const[i,g]=y.useState(!1),[c,l]=y.useState(null),w=y.useRef(null),T=y.useRef(null),[k,b]=y.useState("agent"),[S,h]=y.useState("grok"),[$,P]=y.useState(!1),[q,N]=y.useState(!1),[V,C]=y.useState(!1),[D,E]=y.useState(!1),x=pt();y.useEffect(()=>(L(void 0,null,function*(){try{yield je.initialize(),E(!0),console.log("✅ [AI TASK CHAT] Memory service initialized")}catch(m){console.error("❌ [AI TASK CHAT] Failed to initialize memory:",m)}}),()=>{le.cleanup()}),[]);const z=()=>{var u;(u=w.current)==null||u.scrollIntoView({behavior:"smooth"})};y.useEffect(()=>{z()},[a]);const B=u=>L(void 0,null,function*(){if(le.isTTSSupported()){console.log("🔊 [AI TASK] Manual voice playback requested"),console.log("📝 [AI TASK] Text to speak:",u.substring(0,50)+"...");try{N(!0),yield le.speak(u,{voice:"Fritz-PlayAI",rate:1,pitch:1},()=>N(!0),()=>N(!1),m=>{console.error("TTS Error:",m),N(!1)})}catch(m){console.error("TTS Error:",m),N(!1)}}}),j=u=>L(void 0,null,function*(){if(!u.trim())return;g(!0),console.log("🧠 [AI TASK] User Message Received"),console.log("🔍 [AI TASK] Input:",u),console.log("🔍 [AI TASK] Message Analysis:",{length:u.length,wordCount:u.split(" ").length,hasQuestion:u.includes("?"),isCommand:u.toLowerCase().startsWith("create")||u.toLowerCase().startsWith("add"),containsKeywords:{task:u.toLowerCase().includes("task"),project:u.toLowerCase().includes("project"),deadline:u.toLowerCase().includes("deadline"),priority:u.toLowerCase().includes("priority")}});const m={id:Date.now().toString(),content:u,sender:"user",timestamp:new Date};D&&(yield je.saveMessage(m)),t([...a,m]);try{console.log("🎯 [AI TASK] Processing AI Response..."),console.log("🔄 [AI TASK] Context Setup:",{currentMessages:a.length,voiceEnabled:V,hasTaskContext:!!n.find(M=>M.id===u.split(" ")[0]),taskId:u.split(" ")[0]}),console.log("🤖 [AI TASK] Using AI Task Agent for processing...");let f="",F=!1;try{const M=u.toLowerCase().trim();if(M.includes("delete")||M.includes("create")||M.includes("add")||M.includes("complete")||M.includes("status")||M.includes("clear")||M.includes("remove")||M.includes("finish")||M.includes("done")||M.startsWith("show")||M.includes("task")||M.includes("how many")){console.log("🎯 [AI TASK] Task command detected, processing with AI Task Agent..."),console.log("🔍 [AI TASK] Original message:",u),console.log("🔍 [AI TASK] Processed message:",M),console.log("🔍 [AI TASK] Available task context:",n.length,"tasks");const re=D?je.getConversationContext(5):a.filter(X=>X.sender==="user").slice(-3).map(X=>X.content);console.log("🧠 [AI TASK CHAT] Using conversation context:",re);const se=yield xs.processInput(u,re);console.log("🤖 [AI TASK] Agent response received:",se),se.success?(f=`✅ **Task Action Completed**

${se.message}`,F=!0,se.affectedCount&&se.affectedCount>0&&(console.log("🔄 [AI TASK] Tasks modified, triggering refresh..."),r&&(x.invalidateQueries({queryKey:["tasks"]}),x.invalidateQueries({queryKey:["taskStats"]}),console.log("🔄 [AI TASK] Query cache invalidated"),r(),console.log("✅ [AI TASK] Task refresh triggered"),setTimeout(()=>{r(),console.log("✅ [AI TASK] Secondary task refresh triggered")},1e3)))):f=`❌ **Task Action Failed**

${se.message}`,console.log("✅ [AI TASK] AI Task Agent response:",se)}else if(console.log("💬 [AI TASK] Non-task command, using conversational response..."),u.toLowerCase().includes("help"))f=`I'm here to help you manage your tasks efficiently! Here's what I can do:

🔹 **Task Creation**: "Create a new task for..." or "Add task..."
🔹 **Task Deletion**: "Delete all tasks" or "Clear all main tasks"
🔹 **Task Completion**: "Complete all tasks" or "Finish all daily tasks"
🔹 **Status Checking**: "Show task status" or "How many tasks do I have?"
🔹 **Voice Commands**: Use voice for hands-free operation

**Examples:**
• "Delete all high priority tasks"
• "Create a new development task for API integration"
• "Complete all daily tasks"
• "Show me task status"

What would you like me to help you with?`;else if(u.toLowerCase().includes("status")||u.toLowerCase().includes("how many")){const re=a.filter(X=>X.sender==="user").slice(-3).map(X=>X.content),se=yield xs.processInput("status",re);f=se.success?se.message:`Let me check your current task status...

- Active tasks: ${n.filter(X=>!X.completed).length}
- Completed tasks: ${n.filter(X=>X.completed).length}`}else{const re=[`I understand your request about "${u}". Let me help you with your task management needs.`,`Thanks for that input! I can help you create, manage, or organize tasks related to "${u}".`,`Interesting point about "${u}". Would you like me to create a task or help organize this into your workflow?`,`I see you mentioned "${u}". I can help you turn this into actionable tasks or provide status updates.`];f=re[Math.floor(Math.random()*re.length)]+`

💡 **Quick Actions:**
• Say "create task..." to add new tasks
• Say "delete all tasks" to clear your list
• Say "status" to see your task overview`}}catch(M){console.error("❌ [AI TASK] AI Task Agent error:",M),f=`I encountered an issue processing your task request: ${M instanceof Error?M.message:"Unknown error"}. Please try again or rephrase your request.`}console.log("📤 [AI TASK] Final AI Response:",f.substring(0,100)+"..."),console.log("🎭 [AI TASK] Response Characteristics:",{length:f.length,wordCount:f.split(" ").length,hasActionItems:f.includes("•")||f.includes("🔹"),tone:f.includes("!")?"enthusiastic":"professional"});const H={id:(Date.now()+1).toString(),content:f,sender:"assistant",timestamp:new Date};D&&(yield je.saveMessage(H)),t([...a,m,H]),console.log("🔇 [AI TASK] Auto-voice response DISABLED - Voice input only mode"),console.log("💬 [AI TASK] Response available for manual playback via message buttons")}catch(f){console.error("❌ [AI TASK] Error processing message:",f),console.log("🔧 [AI TASK] Error Context:",{userInput:u,messagesCount:a.length,timestamp:new Date().toISOString()});const F={id:(Date.now()+2).toString(),content:"I apologize, but I encountered an error processing your request. Please try again, and I'll do my best to help you.",sender:"assistant",timestamp:new Date};D&&(yield je.saveMessage(F)),t([...a,m,F])}finally{g(!1),console.log("🏁 [AI TASK] Message processing completed")}}),d=(u,m)=>L(void 0,null,function*(){try{yield navigator.clipboard.writeText(m),l(u),setTimeout(()=>l(null),2e3)}catch(f){console.error("Failed to copy message:",f)}}),A=a.reduce((u,m,f)=>{const F=a[f-1];return F&&F.sender===m.sender?u[u.length-1].push(m):u.push([m]),u},[]),K=n.filter(u=>!u.completed),Y=n.filter(u=>u.completed);return e.jsxs("div",{className:"h-full flex flex-col min-h-0",style:{backgroundColor:"#252525"},children:[e.jsx("div",{className:"flex-1 flex flex-col min-h-0",children:a.length===0?e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"mx-auto mb-8 flex items-center justify-center",children:e.jsx("img",{src:"/lovable-uploads/c5921a2f-8856-42f4-bec5-2d08b81c5691.png",alt:"SISO",className:"w-40 h-40 rounded-md object-cover"})}),e.jsx("h2",{className:"text-4xl text-white mb-4 font-bold bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent uppercase tracking-wide",children:"TALK TO LEGACY"}),e.jsx("p",{className:"text-gray-300 mb-6 max-w-md leading-relaxed",children:"I can help you create tasks, analyze your workload, suggest priorities, and optimize your productivity."}),e.jsxs("div",{className:"flex items-center justify-center gap-4 mb-8",children:[e.jsxs("div",{className:"px-4 py-2 bg-gradient-to-r from-orange-500/20 to-red-500/20 text-orange-300 border border-orange-500/30 rounded-xl text-sm font-semibold backdrop-blur-sm shadow-lg",children:[e.jsx("span",{className:"text-orange-200",children:K.length})," Active"]}),e.jsxs("div",{className:"px-4 py-2 bg-gradient-to-r from-green-500/20 to-emerald-500/20 text-green-300 border border-green-500/30 rounded-xl text-sm font-semibold backdrop-blur-sm shadow-lg",children:[e.jsx("span",{className:"text-green-200",children:Y.length})," Completed"]}),e.jsxs("div",{className:"px-4 py-2 bg-gradient-to-r from-red-500/20 to-pink-500/20 text-red-300 border border-red-500/30 rounded-xl text-sm font-semibold backdrop-blur-sm shadow-lg",children:[e.jsx("span",{className:"text-red-200",children:n.filter(u=>u.status==="overdue").length})," Overdue"]})]})]})}):e.jsx("div",{ref:T,className:"flex-1 p-6 overflow-y-auto admin-scrollbar min-h-0",children:e.jsxs("div",{className:"space-y-6",children:[A.map((u,m)=>e.jsx("div",{className:`flex ${u[0].sender==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex items-end gap-3 max-w-[85%] ${u[0].sender==="user"?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:"flex-shrink-0 mb-1",children:u[0].sender==="user"?e.jsx("div",{className:"w-10 h-10 rounded-xl overflow-hidden ring-2 ring-orange-500/30 shadow-lg",children:e.jsx("img",{src:"/lovable-uploads/c5921a2f-8856-42f4-bec5-2d08b81c5691.png",alt:"SISO",className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-orange-500/30 to-orange-600/20 border border-orange-500/30 flex items-center justify-center backdrop-blur-sm shadow-lg",children:e.jsx("img",{src:"/lovable-uploads/c5921a2f-8856-42f4-bec5-2d08b81c5691.png",alt:"SISO",className:"w-5 h-5 rounded-md object-cover"})})}),e.jsx("div",{className:"space-y-2",children:u.map((f,F)=>e.jsx("div",{className:"group relative",children:e.jsx("div",{className:`relative p-4 rounded-2xl backdrop-blur-sm shadow-lg transition-all duration-200 hover:shadow-xl ${f.sender==="user"?"bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-orange-500/20":"bg-orange-500/20 text-gray-100 border border-orange-500/30 shadow-orange-500/10"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[f.sender==="assistant"&&e.jsx("img",{src:"/lovable-uploads/c5921a2f-8856-42f4-bec5-2d08b81c5691.png",alt:"SISO",className:"w-4 h-4 rounded-sm object-cover flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-line font-medium",children:f.content}),e.jsxs("div",{className:"flex items-center justify-between mt-3",children:[e.jsx("p",{className:"text-xs opacity-70 font-medium",children:f.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[f.sender==="assistant"&&le.isTTSSupported()&&e.jsx("button",{onClick:()=>B(f.content),disabled:q,className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-1 rounded-md hover:bg-white/10 text-xs disabled:opacity-50",title:"Play voice",children:e.jsx(xt,{className:"w-3 h-3"})}),e.jsx("button",{onClick:()=>d(f.id,f.content),className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 p-1 rounded-md hover:bg-white/10 text-xs",title:"Copy message",children:c===f.id?e.jsx(ft,{className:"w-3 h-3"}):e.jsx(Cs,{className:"w-3 h-3"})})]})]})]})]})})},f.id))})]})},`group-${m}`)),i&&e.jsx("div",{className:"flex justify-start",children:e.jsxs("div",{className:"flex items-end gap-3 max-w-[85%]",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-orange-500/30 to-orange-600/20 border border-orange-500/30 flex items-center justify-center backdrop-blur-sm shadow-lg",children:e.jsx("img",{src:"/lovable-uploads/c5921a2f-8856-42f4-bec5-2d08b81c5691.png",alt:"SISO",className:"w-5 h-5 rounded-md object-cover animate-pulse"})}),e.jsx("div",{className:"bg-orange-500/20 text-gray-100 p-4 rounded-2xl border border-orange-500/30 backdrop-blur-sm shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:"/lovable-uploads/c5921a2f-8856-42f4-bec5-2d08b81c5691.png",alt:"SISO",className:"w-4 h-4 rounded-sm object-cover"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-sm text-gray-300 font-medium",children:"Thinking"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-1 h-1 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-1 h-1 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-1 h-1 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})]})})]})}),e.jsx("div",{ref:w})]})})}),e.jsx("div",{className:"p-4",style:{backgroundColor:"#252525"},children:e.jsxs("div",{className:"bg-gradient-to-r from-orange-600 to-yellow-400 rounded-3xl pt-2 px-2 pb-10 relative",children:[e.jsx("div",{className:"relative z-10",children:e.jsx(ss,{onSend:(u,m)=>j(u),placeholder:"Message Legacy...",isLoading:i,className:"bg-white border-gray-200 shadow-xl [&_.flex.items-center.gap-1]:hidden [&_.flex.items-center.gap-2]:justify-end [&_.flex.items-center.gap-2]:items-center"})}),e.jsxs("div",{className:"absolute bottom-3 left-3 flex items-center gap-2 pointer-events-none",children:[e.jsxs("div",{className:"relative pointer-events-auto",children:[e.jsxs("button",{onClick:()=>P(!$),className:"bg-white/20 hover:bg-white/30 text-white text-xs px-3 py-1 rounded-full transition-colors flex items-center gap-1",children:[S,e.jsx(yt,{className:"h-3 w-3"})]}),$&&e.jsx("div",{className:"absolute bottom-full left-0 mb-2 bg-white rounded-lg shadow-lg border border-gray-200 min-w-32 z-50",children:e.jsx("div",{className:"py-1",children:["grok","claude","gpt-4","gemini"].map(u=>e.jsx("button",{onClick:()=>{h(u),P(!1)},className:`w-full text-left px-3 py-2 text-sm transition-colors ${S===u?"bg-orange-50 text-orange-600":"text-gray-700 hover:bg-gray-50"}`,children:u},u))})})]}),e.jsx("div",{className:"pointer-events-auto",children:e.jsx("button",{onClick:()=>b(k==="agent"?"chat":"agent"),className:"bg-white/20 hover:bg-white/30 text-white text-xs px-3 py-1 rounded-full transition-colors",children:k==="agent"?"Agent":"Chat"})})]}),e.jsxs("div",{className:"absolute bottom-3 right-3 flex items-center gap-2 pointer-events-none",children:[e.jsx("div",{className:"pointer-events-auto",children:e.jsxs("button",{className:"flex items-center gap-1 text-white cursor-pointer px-2 py-1 rounded-full transition-colors hover:bg-white/20 text-xs",title:"Attach files",children:[e.jsx(vs,{className:"h-3 w-3"}),e.jsx("span",{children:"Files"})]})}),e.jsx("div",{className:"pointer-events-auto",children:e.jsxs("button",{className:"flex items-center gap-1 text-white cursor-pointer px-2 py-1 rounded-full transition-colors hover:bg-white/20 text-xs",title:"AI Assistant",children:[e.jsx(Ts,{className:"h-3 w-3"}),e.jsx("span",{children:"AI"})]})})]})]})})]})},fs=({task:n,onToggle:a,onEdit:s,onDelete:t,onSubtaskToggle:r,onDateChange:i,showSubtasksOnHover:g=!0,isLast:c=!1})=>{const[l,w]=y.useState(!1),[T,k]=y.useState(!1),[b,S]=y.useState(!1),h=n.subtasks?n.subtasks.filter(N=>N.completed).length/n.subtasks.length*100:n.progress||0,$=N=>{switch(N){case"overdue":return"bg-red-500/20 text-red-400 border-red-500/40";case"due-today":return"bg-orange-500/20 text-orange-400 border-orange-500/40";case"in-progress":return"bg-blue-500/20 text-blue-400 border-blue-500/40";case"blocked":return"bg-purple-500/20 text-purple-400 border-purple-500/40";default:return"bg-gray-500/20 text-gray-400 border-gray-500/40"}},P=N=>{switch(N){case"high":return"bg-red-500/20 text-red-300 border-red-500/40";case"medium":return"bg-orange-500/20 text-orange-300 border-orange-500/40";case"low":return"bg-green-500/20 text-green-300 border-green-500/40";default:return"bg-orange-500/20 text-orange-300 border-orange-500/40"}},q=N=>{switch(N){case"development":return"bg-blue-500/10 text-blue-400 border-blue-500/20";case"design":return"bg-purple-500/10 text-purple-400 border-purple-500/20";case"marketing":return"bg-green-500/10 text-green-400 border-green-500/20";case"client":return"bg-orange-500/10 text-orange-400 border-orange-500/20";case"admin":return"bg-gray-500/10 text-gray-400 border-gray-500/20";default:return"bg-gray-500/10 text-gray-400 border-gray-500/20"}};return e.jsxs("div",{className:"group relative",onMouseEnter:()=>w(!0),onMouseLeave:()=>{w(!1),g&&!b&&setTimeout(()=>S(!1),300)},children:[e.jsxs("div",{className:I("relative transition-all duration-200 cursor-pointer p-4 rounded-lg border",l&&"bg-[#2a2a2a] border-white",!l&&"bg-[#252525] border-transparent",n.completed&&"opacity-60"),onClick:()=>s(n),children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:N=>{N.stopPropagation(),a(n.id)},className:"flex-shrink-0 mt-0.5",children:n.completed?e.jsx(Oe,{className:"w-4 h-4 text-green-500"}):e.jsx(Ye,{className:"w-4 h-4 text-gray-400 hover:text-gray-300"})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h3",{className:I("text-sm font-medium leading-tight",n.completed?"text-gray-500 line-through":"text-white"),children:n.title}),(n.status==="overdue"||n.status==="due-today")&&e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full flex-shrink-0 ${$(n.status)}`,children:n.status.replace("-"," ")})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full ${q(n.category)}`,children:n.category}),e.jsx("span",{className:`px-2 py-0.5 rounded-full ${P(n.priority)}`,children:n.priority})]}),n.dueDate&&e.jsxs(_e,{children:[e.jsx(Fe,{asChild:!0,children:e.jsxs("button",{className:"flex items-center gap-1 hover:text-orange-400 transition-colors",onClick:N=>N.stopPropagation(),children:[e.jsx(de,{className:"w-3 h-3"}),e.jsx("span",{children:n.dueDate})]})}),e.jsx(Re,{className:"w-auto p-0",align:"end",children:e.jsx(Ps,{mode:"single",selected:n.dueDate?new Date(n.dueDate):void 0,onSelect:N=>{i==null||i(n.id,N)},className:"rounded-md border"})})]})]}),n.subtasks&&n.subtasks.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xs text-gray-400",children:[n.subtasks.filter(N=>N.completed).length," of ",n.subtasks.length," subtasks"]}),e.jsxs("span",{className:"text-xs font-medium text-orange-400",children:[Math.round(h),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700/50 rounded-full h-1.5 overflow-hidden",children:e.jsx(oe.div,{className:"h-full bg-gradient-to-r from-orange-500 to-orange-400",initial:{width:0},animate:{width:`${h}%`},transition:{duration:.5,ease:"easeOut"}})})]})]})]}),e.jsx(Pe,{children:n.subtasks&&n.subtasks.length>0&&g&&l&&e.jsx(oe.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden mt-3",children:e.jsx("div",{className:"border-t border-white/20 pt-3",children:e.jsx("div",{className:"space-y-2 ml-7",children:n.subtasks.map(N=>e.jsxs("div",{className:"flex items-center gap-2 group/subtask",children:[e.jsx("button",{onClick:V=>{V.stopPropagation(),r==null||r(n.id,N.id)},className:"flex-shrink-0",children:N.completed?e.jsx(Oe,{className:"w-3 h-3 text-green-500"}):e.jsx(Ye,{className:"w-3 h-3 text-gray-500 hover:text-gray-400"})}),e.jsx("span",{className:I("text-xs text-gray-300 flex-1",N.completed&&"line-through text-gray-500"),children:N.title})]},N.id))})})})})]}),!c&&e.jsx("div",{className:"h-3"})]})},ma=({task:n,isOpen:a,onClose:s,onSave:t,onSubtaskToggle:r})=>{const[i,g]=y.useState(!0),[c,l]=y.useState(null),[w,T]=y.useState("details"),[k,b]=y.useState(""),[S,h]=y.useState(null),[$,P]=y.useState(!1);y.useEffect(()=>{if(n){const d=W(O({},n),{subtasks:n.subtasks&&n.subtasks.length>0?n.subtasks:[{id:"1",title:"",completed:!1},{id:"2",title:"",completed:!1},{id:"3",title:"",completed:!1}]});l(d),g(!0),T("details")}},[n]);const q=d=>{S&&clearTimeout(S),P(!0);const A=setTimeout(()=>{t(d),P(!1)},1e3);h(A)};if(y.useEffect(()=>()=>{S&&clearTimeout(S)},[S]),!n||!c)return null;const N=d=>{switch(d){case"overdue":return"bg-red-500/20 text-red-400 border-red-500/40";case"due-today":return"bg-orange-500/20 text-orange-400 border-orange-500/40";case"in-progress":return"bg-blue-500/20 text-blue-400 border-blue-500/40";case"blocked":return"bg-purple-500/20 text-purple-400 border-purple-500/40";case"done":return"bg-green-500/20 text-green-400 border-green-500/40";default:return"bg-gray-500/20 text-gray-400 border-gray-500/40"}},V=d=>{switch(d){case"urgent":return"bg-red-600/20 text-red-300 border-red-600/40";case"high":return"bg-orange-600/20 text-orange-300 border-orange-600/40";case"medium":return"bg-yellow-600/20 text-yellow-300 border-yellow-600/40";case"low":return"bg-green-600/20 text-green-300 border-green-600/40";default:return"bg-orange-500/20 text-orange-300 border-orange-500/40"}},C=d=>{switch(d){case"development":return"bg-blue-500/10 text-blue-400 border-blue-500/20";case"design":return"bg-purple-500/10 text-purple-400 border-purple-500/20";case"marketing":return"bg-green-500/10 text-green-400 border-green-500/20";case"client":return"bg-orange-500/10 text-orange-400 border-orange-500/20";case"admin":return"bg-gray-500/10 text-gray-400 border-gray-500/20";default:return"bg-gray-500/10 text-gray-400 border-gray-500/20"}},D=(d,A)=>{const K=c?W(O({},c),{[d]:A}):null;l(K),K&&q(K)},E=()=>{l(n?O({},n):null),g(!1)},x=()=>{E(),s()},z=d=>{if(!c||!c.subtasks)return;const A=c.subtasks.map(m=>m.id===d?W(O({},m),{completed:!m.completed}):m),Y=A.filter(m=>m.completed).length/A.length*100,u=W(O({},c),{subtasks:A,progress:Y});l(u),q(u)},B=()=>{if(!k.trim()||!c)return;const d={id:Date.now().toString(),title:k,completed:!1},A=[...c.subtasks||[],d],Y=A.filter(m=>m.completed).length/A.length*100,u=W(O({},c),{subtasks:A,progress:Y});l(u),b(""),q(u)},j=d=>{if(!c||!c.subtasks)return;const A=c.subtasks.filter(m=>m.id!==d),K=A.filter(m=>m.completed).length,Y=A.length>0?K/A.length*100:0,u=W(O({},c),{subtasks:A,progress:Y});l(u),q(u)};return e.jsx(Ms,{open:a,onOpenChange:x,children:e.jsxs($s,{className:"sm:max-w-[800px] w-[95vw] max-w-4xl bg-gradient-to-br from-gray-900/95 to-black/95 border border-orange-500/30 p-0 max-h-[90vh] overflow-hidden rounded-3xl backdrop-blur-xl shadow-2xl shadow-orange-500/20",children:[e.jsx(Os,{className:"p-8 pb-6 border-b border-orange-500/20 bg-gradient-to-r from-orange-500/20 to-yellow-500/20",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx(he,{value:c.title,onChange:d=>D("title",d.target.value),className:"text-xl font-bold text-white bg-gray-800/80 border border-orange-500/50 focus:border-orange-400/80 rounded-xl px-4 py-3 placeholder:text-gray-400",placeholder:"Task title..."}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(ne,{className:`text-xs px-3 py-1 rounded-full border ${N(c.status)}`,children:c.status.replace("-"," ")}),e.jsxs(ne,{className:`text-xs px-3 py-1 rounded-full border ${V(c.priority)}`,children:[c.priority," priority"]}),e.jsx(ne,{className:`text-xs px-3 py-1 rounded-full border ${C(c.category)}`,children:c.category})]})]}),e.jsx("div",{className:"flex items-center gap-2 ml-4",children:$?e.jsx("div",{className:"text-xs text-orange-400 bg-orange-500/20 px-3 py-1 rounded-full border border-orange-500/30",children:"Auto-saving..."}):e.jsx("div",{className:"text-xs text-green-400 bg-green-500/20 px-3 py-1 rounded-full border border-green-500/30",children:"Auto-saved ✓"})})]})}),"        ",e.jsx("div",{className:"px-8 py-6 overflow-y-auto flex-1 bg-gray-900/20",children:e.jsxs(zt,{value:w,onValueChange:T,className:"w-full",children:[e.jsxs(Kt,{className:"bg-gray-800/80 border border-orange-500/30 rounded-xl mb-8 p-1 shadow-lg",children:[e.jsx(Be,{value:"details",className:"rounded-lg text-gray-300 data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 data-[state=active]:font-medium px-6 py-2",children:"Details"}),e.jsx(Be,{value:"subtasks",className:"rounded-lg text-gray-300 data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 data-[state=active]:font-medium px-6 py-2",children:"Subtasks"}),e.jsx(Be,{value:"description",className:"rounded-lg text-gray-300 data-[state=active]:bg-orange-500/20 data-[state=active]:text-orange-400 data-[state=active]:font-medium px-6 py-2",children:"Description"})]}),e.jsxs(Ge,{value:"details",className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wide",children:"Status"}),i?e.jsxs(Ne,{value:c.status,onValueChange:d=>D("status",d),children:[e.jsx(ke,{className:"bg-gray-800/80 border border-orange-500/50 text-white rounded-xl py-3 px-4",children:e.jsx(Ce,{})}),e.jsxs(Te,{className:"bg-white border border-gray-200 rounded-lg",children:[e.jsx(Z,{value:"not-started",className:"text-gray-700 hover:bg-gray-100",children:"Not Started"}),e.jsx(Z,{value:"in-progress",className:"text-gray-700 hover:bg-gray-100",children:"In Progress"}),e.jsx(Z,{value:"blocked",className:"text-gray-700 hover:bg-gray-100",children:"Blocked"}),e.jsx(Z,{value:"done",className:"text-gray-700 hover:bg-gray-100",children:"Done"}),e.jsx(Z,{value:"overdue",className:"text-gray-700 hover:bg-gray-100",children:"Overdue"})]})]}):e.jsx("div",{className:`px-4 py-3 rounded-xl text-sm border ${N(c.status)}`,children:c.status.replace("-"," ")})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Priority"}),i?e.jsxs(Ne,{value:c.priority,onValueChange:d=>D("priority",d),children:[e.jsx(ke,{className:"bg-gray-800/80 border border-orange-500/50 text-white rounded-xl",children:e.jsx(Ce,{})}),e.jsxs(Te,{className:"bg-white border border-gray-200 rounded-lg",children:[e.jsx(Z,{value:"urgent",className:"text-gray-700 hover:bg-gray-100",children:"Urgent"}),e.jsx(Z,{value:"high",className:"text-gray-700 hover:bg-gray-100",children:"High"}),e.jsx(Z,{value:"medium",className:"text-gray-700 hover:bg-gray-100",children:"Medium"}),e.jsx(Z,{value:"low",className:"text-gray-700 hover:bg-gray-100",children:"Low"})]})]}):e.jsxs("div",{className:`px-4 py-3 rounded-xl text-sm border ${V(c.priority)}`,children:[c.priority," priority"]})]})]}),"              ",e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Category"}),i?e.jsxs(Ne,{value:c.category,onValueChange:d=>D("category",d),children:[e.jsx(ke,{className:"bg-gray-800/80 border border-orange-500/50 text-white rounded-xl",children:e.jsx(Ce,{})}),e.jsxs(Te,{className:"bg-white border border-gray-200 rounded-lg",children:[e.jsx(Z,{value:"development",className:"text-gray-700 hover:bg-gray-100",children:"Development"}),e.jsx(Z,{value:"design",className:"text-gray-700 hover:bg-gray-100",children:"Design"}),e.jsx(Z,{value:"marketing",className:"text-gray-700 hover:bg-gray-100",children:"Marketing"}),e.jsx(Z,{value:"client",className:"text-gray-700 hover:bg-gray-100",children:"Client"}),e.jsx(Z,{value:"admin",className:"text-gray-700 hover:bg-gray-100",children:"Admin"})]})]}):e.jsx("div",{className:`px-4 py-3 rounded-xl text-sm border ${C(c.category)}`,children:c.category})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Due Date"}),i?e.jsxs(_e,{children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(U,{variant:"outline",className:"w-full justify-start bg-gray-800/80 border border-orange-500/50 text-white hover:bg-gray-800/90 rounded-xl",children:[e.jsx(de,{className:"mr-2 h-4 w-4"}),c.dueDate?new Date(c.dueDate).toLocaleDateString():"Set date"]})}),e.jsx(Re,{className:"w-auto p-0 bg-gray-800 border border-orange-500/50 rounded-xl",children:e.jsx(Ps,{mode:"single",selected:c.dueDate?new Date(c.dueDate):void 0,onSelect:d=>D("dueDate",d==null?void 0:d.toISOString().split("T")[0]),className:"rounded-xl"})})]}):e.jsxs("div",{className:"px-4 py-3 rounded-xl text-sm bg-gray-800/80 border border-orange-500/30 text-gray-300 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4"}),c.dueDate?new Date(c.dueDate).toLocaleDateString():"No due date"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Assignee"}),i?e.jsx(he,{value:c.assignee||"",onChange:d=>D("assignee",d.target.value),placeholder:"Assign to...",className:"bg-gray-800/80 border border-orange-500/50 text-white rounded-xl"}):e.jsxs("div",{className:"px-4 py-3 rounded-xl text-sm bg-gray-800/80 border border-orange-500/30 text-gray-300 flex items-center gap-2",children:[e.jsx(es,{className:"w-4 h-4"}),c.assignee||"Not assigned"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Estimated Hours"}),i?e.jsx(he,{type:"number",value:c.estimatedHours||"",onChange:d=>D("estimatedHours",d.target.value?Number(d.target.value):void 0),placeholder:"Hours...",min:"0",step:"0.5",className:"bg-gray-800/80 border border-orange-500/50 text-white rounded-xl"}):e.jsxs("div",{className:"px-4 py-3 rounded-xl text-sm bg-gray-800/80 border border-orange-500/30 text-gray-300 flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4"}),c.estimatedHours?`${c.estimatedHours}h`:"Not estimated"]})]})]})]}),e.jsxs(Ge,{value:"subtasks",className:"space-y-4",children:[c.subtasks&&c.subtasks.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300",children:["Progress: ",c.subtasks.filter(d=>d.completed).length," of ",c.subtasks.length," completed"]}),e.jsxs("div",{className:"text-sm font-medium text-orange-400",children:[Math.round(c.subtasks.filter(d=>d.completed).length/c.subtasks.length*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-800/80 rounded-full h-3 overflow-hidden mb-4 border border-orange-500/30",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-orange-500 to-yellow-400 transition-all duration-500 ease-out rounded-full",style:{width:`${c.subtasks.filter(d=>d.completed).length/c.subtasks.length*100}%`}})}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:c.subtasks.map(d=>e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-xl bg-gray-800/80 border border-orange-500/30 group hover:bg-gray-800/90 transition-all duration-200",children:[e.jsx("button",{onClick:()=>z(d.id),className:"flex-shrink-0",children:d.completed?e.jsx(Oe,{className:"w-4 h-4 text-green-500"}):e.jsx(Ye,{className:"w-4 h-4 text-gray-400 hover:text-gray-300"})}),e.jsx("span",{className:I("text-sm flex-1",d.completed?"line-through text-gray-500":"text-gray-300"),children:d.title}),i&&e.jsx(U,{size:"sm",variant:"ghost",onClick:()=>j(d.id),className:"opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-600 hover:bg-red-500/20 rounded-lg",children:e.jsx(Ss,{className:"w-4 h-4"})})]},d.id))})]}),"              ",i&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"border-t border-gray-700/50 pt-4",children:[e.jsx("h5",{className:"text-sm font-medium text-gray-300 mb-3",children:"Add Subtask"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(he,{placeholder:"Add a new subtask...",value:k,onChange:d=>b(d.target.value),className:"flex-1 bg-gray-800/80 border border-orange-500/50 text-white rounded-xl placeholder:text-gray-400",onKeyDown:d=>{d.key==="Enter"&&B()}}),e.jsx(U,{onClick:B,size:"sm",className:"bg-orange-500/20 hover:bg-orange-500/30 text-orange-400 border border-orange-500/40 rounded-xl",disabled:!k.trim(),children:e.jsx(xe,{className:"w-4 h-4"})})]})]})}),(!c.subtasks||c.subtasks.length===0)&&!i&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:"No subtasks yet"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Click Edit to add subtasks and break down this task into smaller parts"})]})]}),e.jsx(Ge,{value:"description",className:"space-y-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Description"}),i?e.jsx(Rt,{value:c.description||"",onChange:d=>D("description",d.target.value),placeholder:"Add a description for this task...",className:"min-h-[140px] bg-gray-800/80 border border-orange-500/50 text-white resize-none rounded-xl placeholder:text-gray-400"}):e.jsx("div",{className:"min-h-[140px] p-4 rounded-xl bg-gray-800/80 border border-orange-500/30 text-sm text-gray-300",children:c.description||e.jsx("span",{className:"text-gray-500 italic",children:"No description provided"})})]})})]})})]})})},ha=({task:n,onToggle:a,onEdit:s,onStatusUpdate:t,onDelete:r,onDuplicate:i,isSelected:g=!1,onSelect:c,bulkActionsMode:l=!1,onPreview:w})=>{var D,E;const[T,k]=y.useState(!1),b=x=>{if(l){x.preventDefault();return}x.dataTransfer.setData("text/plain",n.id),x.dataTransfer.effectAllowed="move"},S=x=>{l?(x.preventDefault(),c==null||c(n.id,!g)):w&&w(n)},h=x=>{x.preventDefault(),l||s(n)},$=x=>{switch(x){case"high":return"text-red-300";case"medium":return"text-orange-300";case"low":return"text-green-300";default:return"text-orange-300"}},P=x=>{switch(x){case"high":return e.jsx(Qe,{className:"h-3 w-3"});case"medium":return e.jsx(us,{className:"h-3 w-3"});case"low":return e.jsx(pe,{className:"h-3 w-3"});default:return e.jsx(us,{className:"h-3 w-3"})}},N=(x=>{if(!x)return null;const z=new Date(x),B=new Date,j=Math.ceil((z.getTime()-B.getTime())/(1e3*60*60*24));return j<0?{text:`Overdue by ${Math.abs(j)} days`,color:"text-red-400"}:j===0?{text:"Due today",color:"text-orange-400"}:j===1?{text:"Due tomorrow",color:"text-yellow-400"}:{text:`Due in ${j} days`,color:"text-green-400"}})(n.dueDate),V=((D=n.subtasks)==null?void 0:D.filter(x=>x.completed).length)||0,C=((E=n.subtasks)==null?void 0:E.length)||0;return e.jsxs("div",{draggable:!l,onDragStart:b,onClick:S,onDoubleClick:h,className:I("bg-gradient-to-br from-[#1f2533]/90 to-[#252229]/90 border rounded-lg p-3 mb-3 transition-all duration-200 group relative",l?"cursor-pointer":"cursor-move",g?"border-[#9b87f5] ring-2 ring-[#9b87f5]/30":"border-transparent hover:border-white"),children:[l&&e.jsx("div",{className:"absolute top-2 left-2 z-10",children:e.jsx(Mt,{checked:g,onCheckedChange:x=>c==null?void 0:c(n.id,!!x),className:"bg-[#1f2533] border-[#3a3942]"})}),e.jsxs("div",{className:I("flex items-start justify-between mb-2",l&&"ml-6"),children:[e.jsx("h4",{className:"text-sm font-medium text-gray-100 line-clamp-1 flex-1 mr-2",children:n.title}),!l&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity flex items-center gap-1",children:[e.jsx(U,{size:"sm",variant:"ghost",onClick:x=>{x.stopPropagation(),w==null||w(n)},className:"h-5 w-5 p-0 text-gray-400 hover:text-gray-200 hover:bg-blue-500/20",title:"Quick Preview",children:e.jsx(Je,{className:"h-3 w-3"})}),e.jsx(U,{size:"sm",variant:"ghost",onClick:x=>{x.stopPropagation(),s(n)},className:"h-5 w-5 p-0 text-gray-400 hover:text-gray-200 hover:bg-[#9b87f5]/20",title:"Edit Task",children:e.jsx(vt,{className:"h-3 w-3"})}),e.jsxs(_e,{open:T,onOpenChange:k,children:[e.jsx(Fe,{asChild:!0,children:e.jsx(U,{size:"sm",variant:"ghost",onClick:x=>x.stopPropagation(),className:"h-5 w-5 p-0 text-gray-400 hover:text-gray-200 hover:bg-gray-500/20",children:e.jsx(Is,{className:"h-3 w-3"})})}),e.jsx(Re,{className:"w-40 p-1 bg-white border-gray-200 shadow-lg",align:"end",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs(U,{variant:"ghost",size:"sm",onClick:x=>{x.stopPropagation(),i==null||i(n),k(!1)},className:"w-full justify-start text-xs text-gray-700 hover:bg-gray-100",children:[e.jsx(Cs,{className:"h-3 w-3 mr-2"}),"Duplicate"]}),e.jsxs(U,{variant:"ghost",size:"sm",onClick:x=>{x.stopPropagation(),a(n.id),k(!1)},className:"w-full justify-start text-xs text-gray-700 hover:bg-gray-100",children:[e.jsx(Ds,{className:"h-3 w-3 mr-2"}),n.completed?"Mark Pending":"Mark Complete"]}),r&&e.jsxs(U,{variant:"ghost",size:"sm",onClick:x=>{x.stopPropagation(),r(n.id),k(!1)},className:"w-full justify-start text-xs text-red-600 hover:bg-red-50",children:[e.jsx(Ss,{className:"h-3 w-3 mr-2"}),"Delete"]})]})})]})]})})]}),n.tags&&n.tags.length>0&&e.jsxs("div",{className:I("flex flex-wrap gap-1 mb-2",l&&"ml-6"),children:[n.tags.slice(0,3).map((x,z)=>e.jsx(ne,{variant:"outline",className:"text-xs px-1.5 py-0.5 bg-[#9b87f5]/10 text-[#9b87f5] border-[#9b87f5]/30",children:x},z)),n.tags.length>3&&e.jsxs(ne,{variant:"outline",className:"text-xs px-1.5 py-0.5 bg-gray-500/10 text-gray-400 border-gray-500/30",children:["+",n.tags.length-3]})]}),e.jsxs("div",{className:I("flex items-center justify-between mb-2",l&&"ml-6"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`flex items-center ${$(n.priority)}`,children:P(n.priority)}),e.jsx("span",{className:"text-xs text-gray-400 capitalize",children:n.category})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[n.estimatedHours&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(pe,{className:"h-3 w-3"}),n.estimatedHours,"h"]}),n.assignee&&e.jsx($t,{className:"h-4 w-4",children:e.jsx(Ot,{className:"bg-[#1f2533] text-xs text-gray-300 text-[10px]",children:n.assignee.slice(0,2)})})]})]}),C>0&&e.jsxs("div",{className:I("mb-2",l&&"ml-6"),children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 mb-1",children:[e.jsxs("span",{children:[V,"/",C," tasks"]}),e.jsxs("span",{children:[Math.round(V/C*100),"%"]})]}),e.jsx("div",{className:"w-full bg-[#1f2533]/50 rounded-full h-1",children:e.jsx("div",{className:"bg-[#9b87f5] h-1 rounded-full transition-all duration-300",style:{width:`${C>0?V/C*100:0}%`}})})]}),N&&e.jsx("div",{className:I("text-xs",l&&"ml-6"),children:e.jsxs("span",{className:I("flex items-center gap-1",N.color),children:[e.jsx(de,{className:"h-3 w-3"}),N.text]})})]})},pa=({title:n,status:a,tasks:s,onTaskToggle:t,onTaskEdit:r,onTaskStatusUpdate:i,onTaskCreate:g,onTaskDelete:c,onTaskDuplicate:l,color:w,icon:T,selectedTasks:k=new Set,onTaskSelect:b,bulkActionsMode:S=!1})=>{const[h,$]=y.useState(!1),P=C=>{C.preventDefault(),C.dataTransfer.dropEffect="move",$(!0)},q=C=>{C.preventDefault(),$(!1)},N=C=>{C.preventDefault(),$(!1);const D=C.dataTransfer.getData("text/plain");D&&D.trim()&&i(D,a)},V=()=>{g&&g(a)};return e.jsxs("div",{className:"flex-1 min-w-[300px] max-w-[350px]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 px-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${w.replace("bg-","bg-")}`}),e.jsx("h3",{className:"font-medium text-gray-200 text-sm",children:n})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{variant:"outline",className:"bg-transparent border-gray-600/50 text-gray-400 text-xs px-2 py-0.5",children:s.length}),g&&e.jsx(U,{size:"sm",variant:"ghost",onClick:V,className:"h-6 w-6 p-0 text-gray-400 hover:text-gray-200 hover:bg-[#9b87f5]/20 rounded",title:`Add task to ${n}`,children:e.jsx(xe,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:I("min-h-[400px] p-3 rounded-lg transition-all duration-200",h?"bg-[#9b87f5]/10 border-2 border-[#9b87f5]/50 border-dashed":"border-2 border-transparent"),onDragOver:P,onDragLeave:q,onDrop:N,children:[s.map(C=>e.jsx(ha,{task:C,onToggle:t,onEdit:r,onStatusUpdate:i,onDelete:c,onDuplicate:l,isSelected:k.has(C.id),onSelect:b,bulkActionsMode:S,onPreview:r},C.id)),s.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("div",{className:"mb-4",children:T}),e.jsxs("p",{className:"text-sm mb-2",children:["No ",n.toLowerCase()]}),g&&e.jsxs(U,{size:"sm",variant:"outline",onClick:V,className:"text-xs text-gray-400 border-gray-600/50 hover:border-[#9b87f5]/60 hover:text-[#9b87f5]",children:[e.jsx(xe,{className:"h-3 w-3 mr-1"}),"Add Task"]})]})]})]})},xa=({tasks:n,onTaskToggle:a,onTaskEdit:s,onTaskStatusUpdate:t,onTaskCreate:r,onTaskDelete:i,onTaskDuplicate:g,selectedFilter:c="all",selectedPriority:l="all",onFilterChange:w,onPriorityChange:T,filterCategories:k})=>{const[b,S]=y.useState(""),[h,$]=y.useState(!1),[P,q]=y.useState(new Set),[N,V]=y.useState(!1),[C,D]=y.useState(["not-started","in-progress","blocked","done"]),x=k||{general:[{value:"all",label:"All Tasks",icon:"📋",color:"bg-gray-600"}],priority:[{value:"high",label:"High Priority",icon:"🔴",color:"bg-red-500"},{value:"medium",label:"Medium Priority",icon:"🟡",color:"bg-yellow-500"},{value:"low",label:"Low Priority",icon:"🟢",color:"bg-green-500"}],projects:[{value:"ubahcrypt",label:"Ubahcrypt",icon:"🔐",color:"bg-purple-500"},{value:"siso-agency",label:"SISO Agency App",icon:"🏢",color:"bg-blue-500"},{value:"excursions",label:"We Are Excursions",icon:"🏝️",color:"bg-teal-500"},{value:"instagram",label:"Instagram Marketing",icon:"📱",color:"bg-pink-500"},{value:"business-ops",label:"Business Operations",icon:"💼",color:"bg-orange-500"}]},z=[{title:"Not Started",status:"not-started",color:"bg-gray-600",icon:e.jsx(Qe,{className:"h-4 w-4"})},{title:"In Progress",status:"in-progress",color:"bg-blue-600",icon:e.jsx(pe,{className:"h-4 w-4"})},{title:"Blocked",status:"blocked",color:"bg-purple-600",icon:e.jsx(Qe,{className:"h-4 w-4"})},{title:"Done",status:"done",color:"bg-green-600",icon:e.jsx(bt,{className:"h-4 w-4"})}],B=C.map(u=>z.find(m=>m.status===u)).filter(Boolean),j=y.useMemo(()=>{let u=[...n];if(b.trim()){const m=b.toLowerCase();u=u.filter(f=>{var F,H,M;return f.title.toLowerCase().includes(m)||((F=f.description)==null?void 0:F.toLowerCase().includes(m))||f.category.toLowerCase().includes(m)||((H=f.assignee)==null?void 0:H.toLowerCase().includes(m))||((M=f.tags)==null?void 0:M.some(ge=>ge.toLowerCase().includes(m)))})}if(c!=="all")if(["high","medium","low"].includes(c))u=u.filter(m=>m.priority===c);else{const f={ubahcrypt:["[Ubahcrypt]"],"siso-agency":["[SISO Agency App]"],excursions:["[We Are Excursions]"],instagram:["[Instagram Marketing]"],"business-ops":["[Business Operations]"]}[c];f&&(u=u.filter(F=>f.some(H=>F.title.includes(H))))}return l!=="all"&&!["high","medium","low"].includes(c)&&(u=u.filter(m=>m.priority===l)),u},[n,b,c,l]),d=u=>j.filter(m=>{switch(u){case"not-started":return m.status==="not-started"||m.status==="upcoming";case"in-progress":return m.status==="in-progress"||m.status==="started";case"blocked":return m.status==="blocked";case"done":return m.status==="done"||m.completed;default:return!1}}),A=(u,m)=>{const f=new Set(P);m?f.add(u):f.delete(u),q(f)},K=u=>{r&&r({status:u,priority:"medium",category:"admin",title:"",completed:!1})};return[...x.general,...x.priority,...x.projects].find(m=>m.value===c)||x.general[0],e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex-shrink-0 p-4 border-b border-[#3a3942]/30 bg-[#1f2533]/50",children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(As,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(he,{value:b,onChange:u=>S(u.target.value),placeholder:"Search tasks...",className:"pl-10 bg-[#1f2533]/50 border-[#3a3942]/50 text-gray-200 placeholder-gray-500 text-sm"}),b&&e.jsx(U,{size:"sm",variant:"ghost",onClick:()=>S(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-4 w-4 p-0 text-gray-400 hover:text-gray-200",children:e.jsx(Le,{className:"h-3 w-3"})})]})})}),e.jsx("div",{className:"flex-1 overflow-x-auto",children:e.jsx("div",{className:"flex gap-3 min-w-max pb-4 px-4",children:B.map(u=>e.jsx(pa,{title:u.title,status:u.status,tasks:d(u.status),onTaskToggle:a,onTaskEdit:s,onTaskStatusUpdate:t,onTaskCreate:K,onTaskDelete:i,onTaskDuplicate:g,color:u.color,icon:u.icon,selectedTasks:P,onTaskSelect:A,bulkActionsMode:h},u.status))})})]})},fa=({tasks:n,onTaskEdit:a,onTaskCreate:s,onTaskDelete:t,selectedFilter:r="all",selectedPriority:i="all",onFilterChange:g,onPriorityChange:c,filterCategories:l})=>{const w=wt(),[T,k]=y.useState(new Date),[b,S]=y.useState(null),[h,$]=y.useState(!1),[P,q]=y.useState(""),[N,V]=y.useState(!1),C=y.useMemo(()=>{const d=Ut(T),A=Ht(T),K=new Date(d);K.setDate(K.getDate()-K.getDay());const Y=new Date(A);return Y.setDate(Y.getDate()+(6-Y.getDay())),qt({start:K,end:Y}).map(m=>{let F=n.filter(H=>H.dueDate?Vt(new Date(H.dueDate),m):!1);if(r&&r!=="all"){if(r.startsWith("priority-")){const H=r.replace("priority-","");F=F.filter(M=>M.priority===H)}else if(r.startsWith("status-")){const H=r.replace("status-","");F=F.filter(M=>M.status===H)}else if(r.startsWith("category-")){const H=r.replace("category-","");F=F.filter(M=>M.category===H)}}return i&&i!=="all"&&(F=F.filter(H=>H.priority===i)),P&&(F=F.filter(H=>{var M;return H.title.toLowerCase().includes(P.toLowerCase())||((M=H.description)==null?void 0:M.toLowerCase().includes(P.toLowerCase()))})),{date:m,tasks:F,isCurrentMonth:Gt(m,T),isToday:Bt(m),hasLifeLockData:Math.random()>.7}})},[T,n,r,i,P]),D=d=>{const A=De(d.date,"yyyy-MM-dd");w(`/admin/life-lock/day?date=${A}`)},E=(d,A)=>{A.stopPropagation(),S(d),$(!0)},x=()=>{k(d=>Wt(d))},z=()=>{k(d=>Yt(d,1))},B=()=>{k(new Date)},j=d=>{switch(d){case"high":return"bg-red-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}};return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 p-4 bg-gray-900 rounded-lg border border-orange-500/30",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5 text-orange-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Calendar View"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(As,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(he,{placeholder:"Search tasks...",value:P,onChange:d=>q(d.target.value),className:"pl-10 w-64 bg-gray-800 border-gray-600 text-white placeholder:text-gray-400"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(_e,{open:N,onOpenChange:V,children:[e.jsx(Fe,{asChild:!0,children:e.jsxs(U,{variant:"outline",size:"sm",className:"bg-gray-800 border-gray-600 text-white hover:bg-gray-700",children:[e.jsx(Xe,{className:"w-4 h-4 mr-2"}),"Filters"]})}),e.jsx(Re,{className:"w-80 bg-gray-800 border-gray-600",align:"end",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block text-white",children:"General"}),e.jsxs(Ne,{value:r,onValueChange:g,children:[e.jsx(ke,{className:"bg-gray-700 border-gray-600 text-white",children:e.jsx(Ce,{placeholder:"All Tasks"})}),e.jsx(Te,{className:"bg-gray-700 border-gray-600",children:l==null?void 0:l.general.map(d=>e.jsx(Z,{value:d.value,className:"text-white hover:bg-gray-600",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:d.icon}),d.label]})},d.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Priority"}),e.jsxs(Ne,{value:i,onValueChange:c,children:[e.jsx(ke,{children:e.jsx(Ce,{placeholder:"All Priorities"})}),e.jsx(Te,{className:"bg-white border-gray-200",children:l==null?void 0:l.priority.map(d=>e.jsx(Z,{value:d.value,className:"text-white hover:bg-gray-600",children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:d.icon}),d.label]})},d.value))})]})]})]})})]}),e.jsxs("div",{className:"flex items-center gap-2 border border-gray-600 rounded-md bg-gray-800",children:[e.jsx(U,{variant:"ghost",size:"sm",onClick:x,className:"text-white hover:bg-gray-700",children:e.jsx(jt,{className:"w-4 h-4"})}),e.jsx(U,{variant:"ghost",size:"sm",onClick:B,className:"px-4 text-white hover:bg-gray-700",children:De(T,"MMMM yyyy")}),e.jsx(U,{variant:"ghost",size:"sm",onClick:z,className:"text-white hover:bg-gray-700",children:e.jsx(Me,{className:"w-4 h-4"})})]}),s&&e.jsxs(U,{size:"sm",onClick:()=>s({title:"New Task",dueDate:new Date().toISOString(),status:"not-started",priority:"medium",category:"admin"}),className:"bg-orange-500 hover:bg-orange-600 text-white",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Add Task"]})]})]}),e.jsxs("div",{className:"flex-1 bg-gray-900 rounded-lg border border-orange-500/30 overflow-hidden",children:[e.jsx("div",{className:"grid grid-cols-7 border-b border-gray-700 bg-gray-800",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(d=>e.jsx("div",{className:"p-3 text-center text-sm font-medium text-gray-300 border-r border-gray-700 last:border-r-0",children:d},d))}),e.jsx("div",{className:"grid grid-cols-7 h-full",children:C.map((d,A)=>e.jsxs("div",{className:I("border-r border-b border-gray-700 last:border-r-0 p-2 cursor-pointer transition-all duration-200 hover:bg-gray-800 flex flex-col min-h-[120px] bg-gray-900",!d.isCurrentMonth&&"bg-gray-800/50 text-gray-500",d.isToday&&"bg-orange-500/20 border-orange-400"),onClick:()=>D(d),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:I("text-sm font-medium text-gray-300",d.isToday&&"bg-orange-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs"),children:De(d.date,"d")}),d.hasLifeLockData&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(Nt,{className:"w-3 h-3 text-orange-500"}),e.jsx(kt,{className:"w-3 h-3 text-red-500"}),e.jsx(Ts,{className:"w-3 h-3 text-purple-500"})]})]}),e.jsxs("div",{className:"flex-1 space-y-1",children:[d.tasks.slice(0,3).map(K=>e.jsxs("div",{className:"text-xs p-1 rounded bg-gray-800 hover:bg-gray-700 flex items-center gap-1 cursor-pointer text-gray-300",onClick:Y=>E(K,Y),children:[e.jsx("div",{className:I("w-2 h-2 rounded-full flex-shrink-0",j(K.priority))}),e.jsx("span",{className:"truncate",children:K.title})]},K.id)),d.tasks.length>3&&e.jsxs("div",{className:"text-xs text-gray-400 pl-3",children:["+",d.tasks.length-3," more"]})]})]},A))})]}),e.jsx(Ms,{open:h,onOpenChange:$,children:e.jsxs($s,{className:"max-w-2xl bg-gray-900 border-orange-500/30",children:[e.jsx(Os,{children:e.jsxs(Ft,{className:"flex items-center gap-2 text-white",children:[e.jsx(de,{className:"w-5 h-5 text-orange-400"}),"Task Details"]})}),b&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 text-white",children:b.title}),e.jsx("p",{className:"text-gray-300 mb-4",children:b.description})]}),e.jsx(ne,{variant:"secondary",className:I("text-white",j(b.priority)),children:b.priority})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-300",children:["Due: ",b.dueDate?De(new Date(b.dueDate),"MMM dd, yyyy"):"No due date"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ct,{className:"w-4 h-4 text-gray-400"}),e.jsx(ne,{variant:"outline",children:b.status})]}),b.assignee&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(es,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm",children:b.assignee})]}),b.estimatedHours&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"w-4 h-4 text-gray-500"}),e.jsxs("span",{className:"text-sm",children:[b.estimatedHours,"h estimated"]})]})]}),b.tags&&b.tags.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:b.tags.map((d,A)=>e.jsx(ne,{variant:"secondary",className:"text-xs",children:d},A))})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(U,{variant:"outline",onClick:()=>$(!1),children:"Close"}),e.jsx(U,{onClick:()=>{a(b),$(!1)},children:"Edit Task"})]})]})]})})]})},ya=({selectedFilter:n,selectedPriority:a,onFilterChange:s,taskCounts:t,onAddProject:r,refreshProjects:i})=>{const[g,c]=y.useState({general:!0,timeline:!0,priority:!0,projects:!0,stats:!1}),[l,w]=y.useState({}),[T,k]=y.useState(!1),[b,S]=y.useState(""),[h,$]=y.useState([]);y.useEffect(()=>{L(void 0,null,function*(){try{const{data:x,error:z}=yield J.from("projects").select("id, name, status").eq("status","active").order("name");if(z)throw z;const B=x.map(j=>({value:j.id,label:j.name,icon:"📁",color:"bg-blue-600"}));$(B)}catch(x){console.error("Error loading projects:",x)}})},[i]);const P={general:[{value:"all",label:"All Tasks",icon:"📋",color:"bg-gray-700"},{value:"overdue",label:"Overdue",icon:"🔥",color:"bg-red-700"},{value:"completed",label:"Completed",icon:"✅",color:"bg-green-700"}],timeline:[{value:"today",label:"Today",icon:"⚡",color:"bg-red-600"},{value:"this-week",label:"This Week",icon:"📅",color:"bg-orange-600"},{value:"this-month",label:"This Month",icon:"🗓️",color:"bg-yellow-600"},{value:"someday",label:"Someday",icon:"💭",color:"bg-blue-600"}],priority:[{value:"urgent",label:"Urgent",icon:"🔥",color:"bg-red-600"},{value:"high",label:"High",icon:"🟠",color:"bg-orange-600"},{value:"medium",label:"Medium",icon:"🟡",color:"bg-yellow-600"},{value:"low",label:"Low",icon:"🟢",color:"bg-green-600"}],projects:[{value:"ubahcrypt",label:"Ubahcrypt",icon:"🔐",color:"bg-purple-600"},{value:"siso-agency",label:"SISO Agency App",icon:"🏢",color:"bg-blue-600",children:[{value:"siso-client",label:"Client Side",icon:"👤",color:"bg-blue-500"},{value:"siso-admin",label:"Admin Side",icon:"⚙️",color:"bg-blue-700"},{value:"siso-partnership",label:"Partnership Side",icon:"🤝",color:"bg-blue-400"}]},{value:"excursions",label:"We Are Excursions",icon:"🏝️",color:"bg-teal-600"},{value:"siso-life",label:"SISO LIFE",icon:"🌱",color:"bg-emerald-600"},...h]},q=E=>{c(x=>W(O({},x),{[E]:!x[E]}))},N=E=>{w(x=>W(O({},x),{[E]:!x[E]}))},V=()=>L(void 0,null,function*(){if(b.trim()&&r){yield r(b.trim()),S(""),k(!1);try{const{data:E,error:x}=yield J.from("projects").select("id, name, status").eq("status","active").order("name");if(x)throw x;const z=E.map(B=>({value:B.id,label:B.name,icon:"📁",color:"bg-blue-600"}));$(z)}catch(E){console.error("Error refreshing projects:",E)}}}),C=E=>{switch(E){case"all":return t.all;case"today":return t.urgent;case"this-week":return t.high;case"this-month":return t.medium;case"someday":return t.backlog;case"overdue":return t.urgent;case"completed":return t.all;case"urgent":return t.urgent;case"high":return t.high;case"medium":return t.medium;case"low":return t.low;case"development":return t.development;case"marketing":return t.marketing;case"design":return t.design;case"client":return t.client;case"admin":return t.admin;default:return 0}},D=(E,x,z)=>{const B=g[z];return e.jsxs("div",{className:"mb-4",children:[e.jsxs("button",{onClick:()=>q(z),className:"w-full flex items-center justify-between text-xs font-medium text-gray-400 uppercase tracking-wider mb-2 hover:text-gray-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Xe,{className:"h-3 w-3"}),E]}),B?e.jsx($e,{className:"h-3 w-3"}):e.jsx(Me,{className:"h-3 w-3"})]}),B&&e.jsxs("div",{className:"space-y-1",children:[x.map(j=>e.jsxs("div",{children:[e.jsx(U,{variant:"ghost",size:"sm",onClick:()=>j.children?N(j.value):s(j.value),className:`w-full justify-start text-left px-2 py-2 h-auto rounded-md transition-all duration-200 ${n===j.value?"bg-orange-500/20 text-orange-300 border border-orange-500/30":"text-gray-300 hover:bg-gray-800/50 hover:text-white"}`,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[j.children&&(l[j.value]?e.jsx(Tt,{className:"h-3 w-3"}):e.jsx(St,{className:"h-3 w-3"})),e.jsx("span",{className:"text-xs",children:j.icon}),e.jsx("span",{className:"text-xs font-medium",children:j.label})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[C(j.value)>0&&e.jsx(ne,{variant:"secondary",className:`text-xs px-1 py-0 ${n===j.value?"bg-orange-500/30 text-orange-200":"bg-gray-700 text-gray-300"}`,children:C(j.value)}),n===j.value&&e.jsx("div",{className:"w-1 h-1 bg-orange-500 rounded-full"}),j.children&&(l[j.value]?e.jsx($e,{className:"h-2 w-2"}):e.jsx(Me,{className:"h-2 w-2"}))]})]})}),j.children&&l[j.value]&&e.jsx("div",{className:"ml-4 mt-1 space-y-1 border-l border-gray-700/50 pl-2",children:j.children.map(d=>e.jsx(U,{variant:"ghost",size:"sm",onClick:()=>s(d.value),className:`w-full justify-start text-left px-2 py-1 h-auto rounded-md transition-all duration-200 ${n===d.value?"bg-orange-500/20 text-orange-300 border border-orange-500/30":"text-gray-400 hover:bg-gray-800/30 hover:text-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs",children:d.icon}),e.jsx("span",{className:"text-xs",children:d.label})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[C(d.value)>0&&e.jsx(ne,{variant:"secondary",className:`text-xs px-1 py-0 ${n===d.value?"bg-orange-500/30 text-orange-200":"bg-gray-600 text-gray-400"}`,children:C(d.value)}),n===d.value&&e.jsx("div",{className:"w-1 h-1 bg-orange-500 rounded-full"})]})]})},d.value))})]},j.value)),z==="projects"&&e.jsx("div",{className:"mt-2",children:T?e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:b,onChange:j=>S(j.target.value),placeholder:"Project name...",className:"w-full px-2 py-1 text-xs bg-gray-800 border border-gray-600 rounded text-white placeholder-gray-400 focus:outline-none focus:border-orange-500",onKeyPress:j=>j.key==="Enter"&&V(),autoFocus:!0}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(U,{size:"sm",onClick:V,className:"text-xs px-2 py-1 h-6 bg-orange-500 hover:bg-orange-600",children:"Add"}),e.jsx(U,{size:"sm",variant:"ghost",onClick:()=>{k(!1),S("")},className:"text-xs px-2 py-1 h-6 text-gray-400 hover:text-white",children:"Cancel"})]})]}):e.jsx(U,{variant:"ghost",size:"sm",onClick:()=>k(!0),className:"w-full justify-start text-left px-2 py-2 h-auto rounded-md text-gray-400 hover:bg-gray-800/30 hover:text-gray-300 border border-dashed border-gray-600 hover:border-orange-500/50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(xe,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Add Project"})]})})})]})]})};return e.jsxs("div",{className:"h-full flex flex-col bg-black/30 border-r border-gray-700/50 backdrop-blur-sm",children:[e.jsx("div",{className:"flex-shrink-0 p-4 border-b border-gray-700/50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-4 w-4 text-orange-400"}),e.jsx("h2",{className:"text-white text-sm font-semibold",children:"Filters"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-3 py-4 scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-transparent",children:e.jsxs("div",{className:"space-y-4",children:[D("General",P.general,"general"),D("Timeline",P.timeline,"timeline"),D("Priority",P.priority,"priority"),D("Projects",P.projects,"projects")]})}),e.jsxs("div",{className:"flex-shrink-0 p-3 border-t border-gray-700/50 bg-black/20",children:[e.jsxs("button",{onClick:()=>q("stats"),className:"w-full flex items-center justify-between text-xs font-medium text-gray-400 uppercase tracking-wider mb-2 hover:text-gray-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Es,{className:"h-3 w-3"}),"Stats"]}),g.stats?e.jsx($e,{className:"h-3 w-3"}):e.jsx(Me,{className:"h-3 w-3"})]}),g.stats&&e.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[e.jsxs("div",{className:"bg-gray-800/30 rounded-md p-2 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-orange-400",children:t.all}),e.jsx("div",{className:"text-xs text-gray-400",children:"Total Tasks"})]}),e.jsxs("div",{className:"bg-gray-800/30 rounded-md p-2 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-red-400",children:t.urgent}),e.jsx("div",{className:"text-xs text-gray-400",children:"🔥 Urgent"})]}),e.jsxs("div",{className:"bg-gray-800/30 rounded-md p-2 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-orange-400",children:t.high}),e.jsx("div",{className:"text-xs text-gray-400",children:"🟠 High"})]}),e.jsxs("div",{className:"bg-gray-800/30 rounded-md p-2 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-yellow-400",children:t.medium}),e.jsx("div",{className:"text-xs text-gray-400",children:"🟡 Medium"})]}),e.jsxs("div",{className:"bg-gray-800/30 rounded-md p-2 text-center",children:[e.jsx("div",{className:"text-sm font-bold text-green-400",children:t.low}),e.jsx("div",{className:"text-xs text-gray-400",children:"🟢 Low"})]})]})]})]})},ys=s=>{var t=s,{className:n}=t,a=ae(t,["className"]);return e.jsx(It,O({className:I("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",n)},a))},Ee=At,bs=t=>{var r=t,{withHandle:n,className:a}=r,s=ae(r,["withHandle","className"]);return e.jsx(Dt,W(O({className:I("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",a)},s),{children:n&&e.jsx("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:e.jsx(Et,{className:"h-2.5 w-2.5"})})}))},Oa=()=>{const[n,a]=y.useState("list"),[s,t]=y.useState(null),[r,i]=y.useState(null),[g,c]=y.useState(new Date),[l,w]=y.useState(null),[T,k]=y.useState(null),[b,S]=y.useState(!1),[h,$]=y.useState("all"),[P,q]=y.useState("all"),[N,V]=y.useState(!1),[C,D]=y.useState(!1),[E,x]=y.useState(!1),[z,B]=y.useState(!1),[j,d]=y.useState(!1),[A,K]=y.useState(""),[Y,u]=y.useState({"siso-agency":"",ubahcrypt:"",excursions:"",instagram:""}),{user:m}=Lt(),{toast:f}=_t();y.useEffect(()=>{const o=localStorage.getItem("projectContexts");o&&u(JSON.parse(o))},[]);const F=(o,p)=>{const R=W(O({},Y),{[o]:p});u(R),localStorage.setItem("projectContexts",JSON.stringify(R)),console.log(`Updated ${o} context:`,p)},H=()=>Y[A]||"",{useTaskQuery:M,useUpdateTask:ge}=Qt(),{useCreateTask:re,useDeleteTask:se}=Jt(),{data:X=[],isLoading:ze,error:fe,refetch:Ke}=M(void 0,m==null?void 0:m.id),me=ge(),v=re(),G=se(),ee={general:[{value:"all",label:"All Tasks",icon:"📋",color:"bg-gray-600"},{value:"active",label:"Active Tasks",icon:"🔄",color:"bg-blue-600"},{value:"completed",label:"Completed Tasks",icon:"✅",color:"bg-green-600"}],priority:[{value:"high",label:"High Priority",icon:"🔴",color:"bg-red-500"},{value:"medium",label:"Medium Priority",icon:"🟡",color:"bg-yellow-500"},{value:"low",label:"Low Priority",icon:"🟢",color:"bg-green-500"}],projects:[{value:"ubahcrypt",label:"Ubahcrypt",icon:"🔐",color:"bg-purple-500"},{value:"siso-agency",label:"SISO Agency App",icon:"🏢",color:"bg-blue-500"},{value:"excursions",label:"We Are Excursions",icon:"🏝️",color:"bg-teal-500"},{value:"instagram",label:"Instagram Marketing",icon:"📱",color:"bg-pink-500"},{value:"business-ops",label:"Business Operations",icon:"💼",color:"bg-orange-500"}]},ie=()=>{let o=ce;if(h!=="all")if(h==="active")o=ce.filter(p=>!p.completed);else if(h==="completed")o=ce.filter(p=>p.completed);else if(["urgent","high","medium","low"].includes(h))o=ce.filter(p=>p.priority===h);else{const R={ubahcrypt:{categories:[],strictTitleKeywords:["ubahcrypt","uber","crypt","crypto"],excludeKeywords:["excursion","siso","partnership","instagram"]},"siso-agency":{categories:["siso_app_dev","onboarding_app"],strictTitleKeywords:["siso","agency","partnership"],excludeKeywords:["excursion","crypto","instagram","birthday","reset"]},excursions:{categories:[],strictTitleKeywords:["excursion","birthday","reset workshop"],excludeKeywords:["siso","crypto","partnership","instagram"]},instagram:{categories:["instagram"],strictTitleKeywords:["instagram","social"],excludeKeywords:["excursion","crypto","siso","birthday","reset"]},"siso-life":{categories:[],strictTitleKeywords:["siso life","lifelock"],excludeKeywords:["excursion","crypto","partnership","instagram"]}}[h];R?(o=ce.filter(Q=>{const Ae=Q.title.toLowerCase(),Ys=Q.category||"";if(R.excludeKeywords&&R.excludeKeywords.some(Xs=>Ae.includes(Xs.toLowerCase())))return!1;const Qs=R.categories.length>0&&R.categories.includes(Ys),Js=R.strictTitleKeywords.some(ls=>Ae.includes(ls.toLowerCase()));return Qs||Js}),console.log(`Project ${h}: Found ${o.length} tasks`),o.length===0?console.log(`No tasks found for project: ${h}`):console.log(`Tasks for ${h}:`,o.map(Q=>Q.title))):(o=[],console.log(`Unknown project filter: ${h}, returning empty array`))}return P!=="all"&&!["urgent","high","medium","low"].includes(h)&&(o=o.filter(p=>p.priority===P)),o},ye=o=>{const p={pending:"not-started",in_progress:"in-progress",completed:"done"},R={siso_app_dev:"development",onboarding_app:"development",main:"admin",instagram:"marketing",weekly:"admin",daily:"admin"};return{id:o.id,title:o.title,completed:o.status==="completed",status:p[o.status||"pending"]||"not-started",priority:o.priority||"medium",assignee:"SISO Team",dueDate:o.due_date,category:R[o.category]||"admin",tags:[],estimatedHours:Math.round((o.duration||60)/60),description:o.description||"No description provided",subtasks:[],progress:0}};fe&&(console.error("Error fetching tasks:",fe),f({variant:"destructive",title:"Error loading tasks",description:"Could not load tasks from database."}));const[Se,Ue]=y.useState([]),[be,ts]=y.useState(!1),ce=X.length>0?X.map(ye):[],te=ie(),ve=te.filter(o=>!o.completed),ue=te.filter(o=>o.completed);ce.filter(o=>!o.completed),ce.filter(o=>o.completed);const[qs,ba]=y.useState(!0);[...ee.general,...ee.priority,...ee.projects].find(p=>p.value===h)||ee.general[0];const He=o=>L(void 0,null,function*(){const p=ie().find(Q=>Q.id===o);if(!p){console.error("Task not found:",o);return}const R=p.completed?"pending":"completed";console.log("Toggling task:",o,"from completed:",p.completed,"to status:",R);try{const Q={id:o,status:R,completed_at:R==="completed"?new Date().toISOString():null};yield me.mutateAsync(Q),f({title:"Task updated",description:`Task marked as ${R==="completed"?"completed":"pending"}.`})}catch(Q){console.error("Error updating task:",Q),f({variant:"destructive",title:"Update failed",description:Q instanceof Error?Q.message:"Could not update task status."})}}),qe=(o,p)=>{console.log("Toggle subtask:",o,p)},as=(o,p)=>{console.log("Handle date change:",o,p)},Vs=(o,p)=>L(void 0,null,function*(){try{const Q={"not-started":"pending","in-progress":"in_progress",blocked:"in_progress",done:"completed",started:"in_progress",upcoming:"pending"}[p]||"pending",Ae={id:o,status:Q,completed_at:Q==="completed"?new Date().toISOString():null};yield me.mutateAsync(Ae),f({title:"Task updated",description:`Task status changed to ${p.replace("-"," ")}.`})}catch(R){console.error("Error updating task status:",R),f({variant:"destructive",title:"Update failed",description:R instanceof Error?R.message:"Could not update task status."})}}),Bs=o=>{if(!o.trim())return;const p={id:Date.now().toString(),content:o,sender:"user",timestamp:new Date};Ue([...Se,p]),setTimeout(()=>{const R={id:(Date.now()+1).toString(),content:'I understand you need help with: "'+o+'". Let me assist you with that task.',sender:"assistant",timestamp:new Date};Ue(Q=>[...Q,R])},1e3)},rs=o=>{k(o),S(!0)},Gs=o=>{console.log("Handle task modal save:",o),S(!1),k(null)},Ws=()=>{S(!1),k(null)},ns=o=>{k(o),S(!0)},is=o=>L(void 0,null,function*(){try{const p={title:o.title||"New Task",description:o.description||"",status:o.status||"pending",priority:o.priority||"medium",category:o.category||"main",due_date:o.dueDate||null,assigned_to:(m==null?void 0:m.id)||null};console.log("Creating task with data:",p),yield v.mutateAsync(p),f({title:"Task created",description:"New task has been created successfully."})}catch(p){console.error("Error creating task:",p),f({title:"Error",description:`Failed to create task: ${p instanceof Error?p.message:"Unknown error"}`,variant:"destructive"})}}),os=o=>L(void 0,null,function*(){try{yield G.mutateAsync(o),f({title:"Task deleted",description:"Task has been deleted successfully."})}catch(p){console.error("Error deleting task:",p),f({title:"Error",description:"Failed to delete task. Please try again.",variant:"destructive"})}});return y.useEffect(()=>{const o=p=>{const R=p.target;N&&!R.closest(".filter-dropdown-container")&&V(!1),C&&!R.closest(".view-dropdown-container")&&D(!1),E&&!R.closest(".context-menu-container")&&x(!1),z&&!R.closest(".options-menu-container")&&B(!1)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[N,C,E,z]),e.jsx(Pt,{children:e.jsxs("div",{className:"h-screen text-white overflow-hidden",style:{backgroundColor:"#252525"},children:[e.jsxs(ys,{direction:"horizontal",className:"h-full",children:[e.jsx(Ee,{defaultSize:40,minSize:25,maxSize:60,className:"min-h-0",style:{backgroundColor:"#252525"},children:e.jsxs(ys,{direction:"horizontal",className:"h-full",children:[e.jsx(Ee,{defaultSize:35,minSize:20,maxSize:50,className:"min-h-0",children:e.jsx(ya,{selectedFilter:h,selectedPriority:P,onFilterChange:(o,p)=>{$(o),p&&q(p)},taskCounts:{all:te.length,urgent:te.filter(o=>o.priority==="urgent").length,high:te.filter(o=>o.priority==="high").length,medium:te.filter(o=>o.priority==="medium").length,low:te.filter(o=>o.priority==="low").length,development:te.filter(o=>o.category==="development").length,marketing:te.filter(o=>o.category==="marketing").length,design:te.filter(o=>o.category==="design").length,client:te.filter(o=>o.category==="client").length,admin:te.filter(o=>o.category==="admin").length},onAddProject:o=>L(void 0,null,function*(){try{const{data:p}=yield J.auth.getUser();if(!(p!=null&&p.user)){f({title:"Error",description:"User not authenticated",variant:"destructive"});return}const{data:R,error:Q}=yield J.from("projects").insert({name:o,user_id:p.user.id,status:"active",description:`Project: ${o}`,completion_percentage:0}).select().single();if(Q)throw Q;f({title:"Success",description:`Project "${o}" created successfully!`}),refreshTasks()}catch(p){console.error("Error creating project:",p),f({title:"Error",description:"Failed to create project",variant:"destructive"})}})})}),e.jsx(bs,{className:"bg-gray-700 hover:bg-orange-500 transition-colors duration-200"}),e.jsx(Ee,{defaultSize:65,minSize:50,maxSize:80,className:"min-h-0",children:e.jsx("div",{className:"h-full",children:qs?e.jsx(ga,{tasks:ce,chatMessages:Se,onTasksUpdate:o=>console.log("Tasks updated:",o),onChatUpdate:Ue,onTaskRefresh:Ke}):e.jsxs("div",{className:"h-full flex flex-col",style:{backgroundColor:"#252525"},children:[e.jsx("div",{className:"flex-1 flex flex-col",children:Se.length===0?e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-8 flex items-center justify-center",children:e.jsx("div",{className:"w-16 h-16 border-2 border-orange-500/30 rounded-2xl flex items-center justify-center bg-gradient-to-br from-orange-500/20 to-orange-600/10 backdrop-blur-sm shadow-lg",children:e.jsx("div",{className:"w-8 h-8 border-l-2 border-t-2 border-orange-400 transform rotate-45"})})}),e.jsx("h2",{className:"text-2xl text-white mb-8 font-semibold bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent",children:"What can I help with?"})]})}):e.jsx("div",{className:"flex-1 p-6 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-transparent",children:e.jsx("div",{className:"space-y-6",children:Se.map((o,p)=>e.jsx("div",{className:`flex ${o.sender==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex items-end gap-3 max-w-[85%] ${o.sender==="user"?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:"flex-shrink-0 mb-1",children:o.sender==="user"?e.jsx("div",{className:"w-10 h-10 rounded-xl overflow-hidden ring-2 ring-orange-500/30 shadow-lg",children:e.jsx("img",{src:"/lovable-uploads/c5921a2f-8856-42f4-bec5-2d08b81c5691.png",alt:"SISO",className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-orange-500/30 to-orange-600/20 border border-orange-500/30 flex items-center justify-center backdrop-blur-sm shadow-lg",children:e.jsx("div",{className:"w-5 h-5 border-l-2 border-t-2 border-orange-400 transform rotate-45"})})}),e.jsxs("div",{className:`relative p-4 rounded-2xl backdrop-blur-sm shadow-lg transition-all duration-200 hover:shadow-xl ${o.sender==="user"?"bg-gradient-to-br from-orange-500 to-orange-600 text-white shadow-orange-500/20":"bg-gray-800/80 text-gray-100 border border-gray-700/50 shadow-gray-900/20"}`,children:[e.jsx("p",{className:"text-sm leading-relaxed font-medium",children:o.content}),e.jsx("p",{className:"text-xs opacity-70 mt-2 font-medium",children:o.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]})},o.id))})})}),e.jsx("div",{className:"p-4 border-t border-white/10 bg-gradient-to-r from-gray-900/50 to-gray-800/50 backdrop-blur-sm",children:e.jsx("div",{className:"bg-red-500 rounded-3xl p-4",children:e.jsx(ss,{onSend:(o,p)=>Bs(o),placeholder:"Message SISO...",className:"shadow-xl backdrop-blur-sm"})})})]})})})]})}),e.jsx(bs,{className:"bg-gray-700 hover:bg-orange-500 transition-colors duration-200"}),e.jsx(Ee,{defaultSize:60,minSize:40,maxSize:75,children:e.jsx("div",{className:"h-full p-4 flex items-center justify-center",style:{backgroundColor:"#121212"},children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-lg overflow-hidden flex flex-col w-full max-w-4xl h-[calc(100vh-2rem)] mx-4",children:[e.jsxs("div",{className:"bg-white px-6 py-4 flex items-center justify-between border-b border-gray-200",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("h1",{className:"text-xl font-bold text-black",children:"SISO AGENCY"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"bg-gray-100 border border-gray-300 rounded-full px-3 py-1 text-sm font-medium text-gray-700",children:[ue.length," completed, ",ve.length," active"]}),e.jsxs("div",{className:"relative context-menu-container",children:[e.jsx(U,{size:"sm",variant:"ghost",onClick:()=>x(!E),className:"text-black hover:bg-gray-100 px-2 py-2 h-8",title:"Project Context",children:e.jsx(es,{className:"h-4 w-4"})}),E&&e.jsxs("div",{className:"absolute top-full mt-2 right-0 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[200px] overflow-hidden",children:[e.jsxs("div",{className:"p-3 border-b border-gray-200",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Project Context"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Select active project"})]}),e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{K("siso-agency"),d(!0),x(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-800",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),e.jsx("span",{className:"font-medium",children:"SISO Agency App"}),e.jsx("span",{className:"ml-auto text-orange-500 text-lg",children:"●"})]}),e.jsxs("button",{onClick:()=>{K("ubahcrypt"),d(!0),x(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-800",children:[e.jsx("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),e.jsx("span",{className:"font-medium",children:"Ubahcrypt"})]}),e.jsxs("button",{onClick:()=>{K("excursions"),d(!0),x(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-800",children:[e.jsx("div",{className:"w-3 h-3 bg-teal-500 rounded-full"}),e.jsx("span",{className:"font-medium",children:"We Are Excursions"})]}),e.jsxs("button",{onClick:()=>{K("instagram"),d(!0),x(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-800",children:[e.jsx("div",{className:"w-3 h-3 bg-pink-500 rounded-full"}),e.jsx("span",{className:"font-medium",children:"Instagram Marketing"})]})]})]})]}),e.jsxs("div",{className:"relative options-menu-container",children:[e.jsx(U,{size:"sm",variant:"ghost",onClick:()=>B(!z),className:"text-black hover:bg-gray-100 px-2 py-2 h-8",title:"More Options",children:e.jsx(Is,{className:"h-4 w-4"})}),z&&e.jsxs("div",{className:"absolute top-full mt-2 right-0 bg-white border border-gray-200 rounded-lg shadow-lg z-50 min-w-[180px] overflow-hidden",children:[e.jsx("button",{onClick:()=>{ts(!be),B(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-800",children:be?e.jsxs(e.Fragment,{children:[e.jsx(gs,{className:"h-4 w-4 text-gray-700"}),e.jsx("span",{className:"font-medium",children:"Hide Completed"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"h-4 w-4 text-gray-700"}),e.jsxs("span",{className:"font-medium",children:["Show Completed (",ue.length,")"]})]})}),e.jsxs("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-800",children:[e.jsx(Ds,{className:"h-4 w-4 text-gray-700"}),e.jsx("span",{className:"font-medium",children:"Archive Tasks"})]}),e.jsxs("button",{className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-50 flex items-center gap-3 text-gray-800",children:[e.jsx(Es,{className:"h-4 w-4 text-gray-700"}),e.jsx("span",{className:"font-medium",children:"Task Analytics"})]})]})]}),e.jsx(U,{size:"sm",variant:"ghost",onClick:()=>is({title:"New Task",priority:"medium",category:"admin"}),className:"text-black hover:bg-gray-100 px-2 py-2 h-8",title:"Add Task",children:e.jsx(xe,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden min-h-0 flex",style:{backgroundColor:"#252525"},children:e.jsxs("div",{className:"flex-1 overflow-y-auto px-8 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 px-2",children:[e.jsxs("h2",{className:"text-sm font-medium",children:[e.jsx("span",{className:"text-gray-400",children:"SISO AGENCY"}),e.jsxs("span",{className:"text-white",children:[" / ",h==="all"?"ALL TASKS":h==="high"?"HIGH PRIORITY":h==="medium"?"MEDIUM PRIORITY":h==="low"?"LOW PRIORITY":h==="overdue"?"OVERDUE":h==="due-today"?"DUE TODAY":h==="development"?"DEVELOPMENT":h==="design"?"DESIGN":h==="marketing"?"MARKETING":h==="client"?"CLIENT":h==="admin"?"ADMIN":h.toUpperCase()]})]}),e.jsxs("div",{className:"relative view-dropdown-container",children:[e.jsxs(U,{variant:"outline",size:"sm",onClick:()=>D(!C),className:"text-xs px-3 py-1 bg-gray-700 text-gray-300 border-gray-600 hover:bg-gray-600 shadow-sm",children:[e.jsxs("span",{className:"mr-2",children:[n==="list"&&e.jsx(ms,{className:"h-3 w-3"}),n==="calendar"&&e.jsx(de,{className:"h-3 w-3"}),n==="kanban"&&e.jsx(hs,{className:"h-3 w-3"})]}),n==="list"&&"LIST VIEW",n==="calendar"&&"CALENDAR VIEW",n==="kanban"&&"KANBAN VIEW",e.jsx($e,{className:"h-3 w-3 ml-2"})]}),C&&e.jsxs("div",{className:"absolute top-full mt-2 left-0 bg-gray-800 border border-gray-600 rounded-lg shadow-lg z-50 min-w-[160px] overflow-hidden",children:[e.jsxs("button",{onClick:()=>{a("list"),D(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-700 flex items-center gap-3 transition-colors text-gray-300",children:[e.jsx(ms,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"List View"}),n==="list"&&e.jsx("span",{className:"ml-auto text-orange-500",children:"●"})]}),e.jsxs("button",{onClick:()=>{a("calendar"),D(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-700 flex items-center gap-3 transition-colors text-gray-300",children:[e.jsx(de,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Calendar View"}),n==="calendar"&&e.jsx("span",{className:"ml-auto text-orange-500",children:"●"})]}),e.jsxs("button",{onClick:()=>{a("kanban"),D(!1)},className:"w-full text-left px-3 py-2 text-sm hover:bg-gray-700 flex items-center gap-3 transition-colors text-gray-300",children:[e.jsx(hs,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Kanban View"}),n==="kanban"&&e.jsx("span",{className:"ml-auto text-orange-500",children:"●"})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"})]}),e.jsxs("div",{className:"px-2",children:[ze?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"}),e.jsx("span",{className:"ml-3 text-white",children:"Loading tasks..."})]}):e.jsx(e.Fragment,{children:n==="list"&&ve.map((o,p)=>e.jsx(fs,{task:o,onToggle:He,onEdit:rs,onSubtaskToggle:qe,onDateChange:as,showSubtasksOnHover:!0,isLast:p===ve.length-1},o.id))}),n==="kanban"&&e.jsx(xa,{tasks:ve,onTaskToggle:He,onTaskEdit:rs,onTaskStatusUpdate:Vs,onTaskCreate:o=>L(void 0,null,function*(){try{const p={title:o.title||"New Task",description:o.description||"",status:o.status==="not-started"?"pending":o.status==="in-progress"?"in_progress":o.status==="done"?"completed":"pending",priority:o.priority||"medium",category:o.category==="development"?"siso_app_dev":o.category==="marketing"?"instagram":o.category==="design"?"siso_app_dev":(o.category==="client","main"),assigned_to:m==null?void 0:m.id,due_date:o.dueDate,duration:(o.estimatedHours||1)*60};yield v.mutateAsync(p),f({title:"Task created",description:"New task has been created successfully."})}catch(p){console.error("Error creating task:",p),f({variant:"destructive",title:"Creation failed",description:p instanceof Error?p.message:"Could not create task."})}}),onTaskDelete:o=>L(void 0,null,function*(){try{yield G.mutateAsync(o),f({title:"Task deleted",description:"Task has been deleted successfully."})}catch(p){console.error("Error deleting task:",p),f({variant:"destructive",title:"Deletion failed",description:p instanceof Error?p.message:"Could not delete task."})}}),onTaskDuplicate:o=>L(void 0,null,function*(){try{const p={title:`${o.title} (Copy)`,description:o.description||"",status:"pending",priority:o.priority,category:o.category==="development"?"siso_app_dev":o.category==="marketing"?"instagram":o.category==="design"?"siso_app_dev":(o.category==="client","main"),assigned_to:m==null?void 0:m.id,due_date:o.dueDate,duration:(o.estimatedHours||1)*60};yield v.mutateAsync(p),f({title:"Task duplicated",description:"Task has been duplicated successfully."})}catch(p){console.error("Error duplicating task:",p),f({variant:"destructive",title:"Duplication failed",description:p instanceof Error?p.message:"Could not duplicate task."})}}),selectedFilter:h,selectedPriority:P,onFilterChange:$,onPriorityChange:q,filterCategories:ee}),n==="calendar"&&e.jsx(fa,{tasks:te,onTaskEdit:ns,onTaskCreate:is,onTaskDelete:os,selectedFilter:h,selectedPriority:P,onFilterChange:$,onPriorityChange:q,filterCategories:ee})]})]})}),e.jsx("div",{className:"flex-shrink-0 border-t border-white/20",style:{backgroundColor:"#252525"},children:e.jsxs("div",{className:"p-3 sm:p-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2",children:[e.jsx("button",{onClick:()=>ts(!be),className:"flex items-center gap-2 text-sm text-green-300 hover:text-green-200 transition-colors","data-toggle-completed-tasks":!0,children:be?e.jsxs(e.Fragment,{children:[e.jsx(gs,{className:"w-4 h-4"}),e.jsx("span",{children:"Hide Completed Tasks"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-4 h-4"}),e.jsxs("span",{children:["Show Completed Tasks (",ue.length,")"]})]})}),e.jsxs("div",{className:"text-xs text-gray-400",children:[e.jsx("span",{className:"text-orange-300 font-medium",children:ve.length})," active,",e.jsx("span",{className:"text-green-300 font-medium ml-1",children:ue.length})," completed"]})]})}),be&&e.jsx("div",{className:"flex-shrink-0 border-t border-white/20",style:{backgroundColor:"#1a1a1a"},"data-completed-tasks-section":!0,children:e.jsxs("div",{className:"p-3 sm:p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-400 mb-4",children:"Completed Tasks"}),e.jsx("div",{className:"space-y-2",children:ue.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Oe,{className:"w-12 h-12 text-green-400 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-gray-400",children:"No completed tasks yet"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Complete some tasks to see them here!"})]}):ue.map((o,p)=>e.jsx(fs,{task:o,onToggle:He,onEdit:ns,onDelete:os,onSubtaskToggle:qe,onDateChange:as,showSubtasksOnHover:!0,isLast:p===ue.length-1},o.id))})]})})]})})})]}),e.jsx(ma,{task:T,isOpen:b,onClose:Ws,onSave:Gs,onSubtaskToggle:qe}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-orange-500 to-yellow-400 p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold",children:[A==="siso-agency"?"SISO Agency App":A==="ubahcrypt"?"Ubahcrypt":A==="excursions"?"We Are Excursions":A==="instagram"?"Instagram Marketing":"Project"," Context"]}),e.jsx("p",{className:"text-white/80 text-sm",children:"Set context for AI assistance"})]}),e.jsx("button",{onClick:()=>d(!1),className:"text-white hover:bg-white/20 rounded-full p-2 transition-colors",children:e.jsx(Le,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Project Information"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Provide context about your current project to help the AI assistant understand your work better."})]}),e.jsx("div",{children:e.jsx("textarea",{value:H(),onChange:o=>F(A,o.target.value),placeholder:"Describe your project, goals, constraints, current status, tech stack, or any other relevant context...",className:"w-full h-40 p-4 border border-gray-200 rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-transparent text-gray-900 placeholder-gray-500"})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[H().length,"/1000 characters"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"text-sm text-green-600 flex items-center gap-1",children:[e.jsx("span",{children:"✓"}),"Auto-saved"]}),e.jsx("button",{onClick:()=>d(!1),className:"px-6 py-2 bg-gradient-to-r from-orange-500 to-yellow-400 text-white rounded-lg hover:from-orange-600 hover:to-yellow-500 transition-all duration-200 font-medium",children:"Close"})]})]})]})})]})})]})})};export{Oa as default};
