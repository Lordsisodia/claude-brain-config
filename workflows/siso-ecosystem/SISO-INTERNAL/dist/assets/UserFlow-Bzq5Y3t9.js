var Z=Object.defineProperty,W=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var R=(s,a,r)=>a in s?Z(s,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[a]=r,I=(s,a)=>{for(var r in a||(a={}))J.call(a,r)&&R(s,r,a[r]);if(M)for(var r of M(a))Q.call(a,r)&&R(s,r,a[r]);return s},P=(s,a)=>W(s,G(a));var C=(s,a,r)=>new Promise((d,i)=>{var x=l=>{try{g(r.next(l))}catch(p){i(p)}},N=l=>{try{g(r.throw(l))}catch(p){i(p)}},g=l=>l.done?d(l.value):Promise.resolve(l.value).then(x,N);g((r=r.apply(s,a)).next())});import{j as e,ff as w,fg as v,f8 as H,bs as V,fh as X,fi as K,fj as q,aU as ee,fk as se,fl as te,r as o,fm as ae,fn as re,fo as ie,fp as ne,fq as oe,fr as le,fs as ce,eD as de,X as me,dI as xe,cJ as he,bi as ue,aa as ge,bT as pe,c9 as be,ft as fe,fu as je,aQ as Ne,eF as ye,bn as we,O as ve,bI as $,y as ke,bz as Ce}from"./vendor-C50ijZWh.js";import{A as Se}from"./AppLayout-BhL6t15E.js";import{U as _e}from"./UserFlowNavigation-BGSOYiRV.js";import{B as _,N as B,d as u,E as S,C as Y,a as Fe,b as Ie,g as Pe,c as Te,n as Ue,s as j,T,i as U,j as D,k as E,D as De,t as Ee,v as Ae,w as Le,x as ze,Q as z,u as Me,F as Re}from"./index-Blbobipf.js";import{S as O}from"./switch-Bq0gP_2G.js";import{T as Be}from"./textarea-B56zo4Tx.js";import{P as Oe}from"./ProjectCardNavigation-DebhLCYH.js";import"./libs-B3eAAgHd.js";import"./MainLayout-CYr31jBl.js";import"./dialog-CB9qAGL5.js";import"./select-Ba1tjTaP.js";import"./supabase-D8k0GRjn.js";const He={implemented:"bg-green-500/20 text-green-400 border-green-500/40","in-progress":"bg-amber-500/20 text-amber-400 border-amber-500/40",planned:"bg-slate-500/20 text-slate-400 border-slate-500/40"},Ve={implemented:"Implemented","in-progress":"In Progress",planned:"Planned"};function qe({data:s,selected:a}){return e.jsxs("div",{className:`px-4 py-3 rounded-lg shadow-md ${a?"ring-2 ring-indigo-500 bg-indigo-950/50 border border-indigo-500/50":"bg-black/60 border border-white/10 hover:border-indigo-500/30"} transition-all duration-200 w-[180px]`,children:[e.jsx(w,{type:"target",position:v.Left,className:"w-3 h-3 bg-indigo-500 border-2 border-black"}),e.jsx(w,{type:"source",position:v.Right,className:"w-3 h-3 bg-indigo-500 border-2 border-black"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("div",{className:"p-1.5 rounded-md bg-indigo-900/30 text-indigo-400",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx(_,{variant:"outline",className:`text-xs ${He[s.status]}`,children:Ve[s.status]})]}),e.jsx("h3",{className:"text-sm font-medium text-white mb-1",children:s.label}),s.description&&e.jsx("p",{className:"text-xs text-gray-400 mb-2 line-clamp-2",children:s.description}),s.screenshot&&e.jsx("div",{className:"mt-2 h-20 rounded-md bg-slate-800/50 flex items-center justify-center mb-2",children:e.jsx("img",{src:s.screenshot,alt:s.label,className:"h-full w-full object-cover rounded"})}),!s.screenshot&&a&&e.jsxs("div",{className:"mt-1 bg-indigo-900/20 text-indigo-400 rounded-sm px-2 py-1 text-xs flex items-center justify-center cursor-pointer",children:[e.jsx(V,{className:"w-3 h-3 mr-1"}),"Add screenshot"]})]})]})}const $e={button_click:q,tap:K,form_submit:X};function Ye({data:s,selected:a}){const r=$e[s.action]||q;return e.jsxs("div",{className:`px-4 py-3 rounded-lg shadow-md ${a?"ring-2 ring-blue-500 bg-blue-950/50 border border-blue-500/50":"bg-black/60 border border-white/10 hover:border-blue-500/30"} transition-all duration-200 w-[160px]`,children:[e.jsx(w,{type:"target",position:v.Top,className:"w-3 h-3 bg-blue-500 border-2 border-black"}),e.jsx(w,{type:"source",position:v.Bottom,className:"w-3 h-3 bg-blue-500 border-2 border-black"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx("div",{className:"p-1.5 rounded-full bg-blue-900/30 text-blue-400",children:e.jsx(r,{className:"w-4 h-4"})})}),e.jsx("h3",{className:"text-sm font-medium text-white mb-1 text-center",children:s.label}),s.description&&e.jsx("p",{className:"text-xs text-gray-400 mb-2 text-center line-clamp-2",children:s.description}),e.jsx("div",{className:"mt-1 bg-blue-900/20 text-blue-400 rounded-sm px-2 py-1 text-xs text-center",children:s.action.replace("_"," ")})]})]})}function Ze({data:s,selected:a}){return e.jsxs("div",{className:`px-3 py-3 rounded-lg shadow-md ${a?"ring-2 ring-emerald-500 bg-emerald-950/50 border border-emerald-500/50":"bg-black/60 border border-white/10 hover:border-emerald-500/30"} transition-all duration-200 w-[160px] diamond-shape`,style:{clipPath:"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)",transform:"rotate(0deg)"},children:[e.jsx(w,{type:"target",position:v.Top,className:"w-3 h-3 bg-emerald-500 border-2 border-black"}),e.jsx(w,{type:"source",position:v.Left,className:"w-3 h-3 bg-emerald-500 border-2 border-black",id:"left"}),e.jsx(w,{type:"source",position:v.Right,className:"w-3 h-3 bg-emerald-500 border-2 border-black",id:"right"}),e.jsx(w,{type:"source",position:v.Bottom,className:"w-3 h-3 bg-emerald-500 border-2 border-black",id:"bottom"}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx("div",{className:"p-1.5 rounded-full bg-emerald-900/30 text-emerald-400",children:e.jsx(ee,{className:"w-4 h-4"})})}),e.jsx("h3",{className:"text-sm font-medium text-white mb-1 text-center",children:s.label}),s.description&&e.jsx("p",{className:"text-xs text-gray-400 mb-1 text-center line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex justify-between w-full mt-1",children:[e.jsx("div",{className:"bg-emerald-900/20 text-emerald-400 rounded-sm px-2 py-0.5 text-[10px]",children:"Yes"}),e.jsx("div",{className:"bg-rose-900/20 text-rose-400 rounded-sm px-2 py-0.5 text-[10px]",children:"No"})]})]})]})}const We={screenNode:qe,actionNode:Ye,decisionNode:Ze},Ge={implemented:"#4ade80","in-progress":"#fb923c",planned:"#94a3b8"};function Je({projectId:s,onNodeSelect:a,setIsLoading:r}){const d=[{id:"screen-login",type:"screenNode",position:{x:0,y:0},data:{label:"Login Screen",status:"implemented",description:"The first screen users see when opening the app",screenshot:null}},{id:"action-login",type:"actionNode",position:{x:250,y:0},data:{label:"Login Button Click",action:"button_click",description:"User clicks the login button after entering credentials"}},{id:"decision-first-login",type:"decisionNode",position:{x:500,y:0},data:{label:"Is First Login?",description:"Check if this is the user's first login"}},{id:"screen-onboarding",type:"screenNode",position:{x:750,y:0},data:{label:"Onboarding",status:"implemented",description:"First-time user onboarding process",screenshot:null}},{id:"screen-dashboard",type:"screenNode",position:{x:500,y:150},data:{label:"Dashboard",status:"implemented",description:"Main dashboard showing market overview and portfolio",screenshot:null}},{id:"screen-profile",type:"screenNode",position:{x:250,y:150},data:{label:"User Profile",status:"in-progress",description:"Profile details and account settings",screenshot:null}},{id:"screen-wallet",type:"screenNode",position:{x:500,y:300},data:{label:"Wallet View",status:"implemented",description:"View and manage crypto assets",screenshot:null}},{id:"screen-trading",type:"screenNode",position:{x:750,y:300},data:{label:"Trading Interface",status:"in-progress",description:"Buy, sell, or exchange cryptocurrencies",screenshot:null}},{id:"action-transaction",type:"actionNode",position:{x:750,y:450},data:{label:"Create Transaction",action:"button_click",description:"Initiate a crypto transaction"}},{id:"decision-confirm",type:"decisionNode",position:{x:1e3,y:450},data:{label:"Confirm Transaction?",description:"User confirms or cancels the transaction"}},{id:"screen-cross-chain",type:"screenNode",position:{x:250,y:300},data:{label:"Cross-Chain Operations",status:"planned",description:"Transfer assets between different blockchains",screenshot:null}},{id:"screen-contracts",type:"screenNode",position:{x:500,y:450},data:{label:"Smart Contracts",status:"planned",description:"Deploy or interact with smart contracts",screenshot:null}},{id:"screen-security",type:"screenNode",position:{x:0,y:300},data:{label:"Security Center",status:"in-progress",description:"Enhanced security features and settings",screenshot:null}},{id:"decision-security-verify",type:"decisionNode",position:{x:0,y:150},data:{label:"Security Verification",description:"Additional security checks for sensitive operations"}}],i=[{id:"e-login-action",source:"screen-login",target:"action-login",animated:!0},{id:"e-action-decision",source:"action-login",target:"decision-first-login"},{id:"e-decision-onboarding",source:"decision-first-login",target:"screen-onboarding",label:"Yes"},{id:"e-decision-dashboard",source:"decision-first-login",target:"screen-dashboard",label:"No"},{id:"e-onboarding-dashboard",source:"screen-onboarding",target:"screen-dashboard"},{id:"e-dashboard-profile",source:"screen-dashboard",target:"screen-profile"},{id:"e-dashboard-wallet",source:"screen-dashboard",target:"screen-wallet"},{id:"e-dashboard-trading",source:"screen-dashboard",target:"screen-trading"},{id:"e-profile-security",source:"screen-profile",target:"screen-security"},{id:"e-wallet-cross-chain",source:"screen-wallet",target:"screen-cross-chain"},{id:"e-wallet-contracts",source:"screen-wallet",target:"screen-contracts"},{id:"e-trading-transaction",source:"screen-trading",target:"action-transaction"},{id:"e-transaction-confirm",source:"action-transaction",target:"decision-confirm"},{id:"e-confirm-wallet",source:"decision-confirm",target:"screen-wallet",label:"Yes"},{id:"e-security-verify",source:"screen-security",target:"decision-security-verify"},{id:"e-verify-profile",source:"decision-security-verify",target:"screen-profile",label:"Pass"}],[x,N,g]=se(d),[l,p,b]=te(i),[f,c]=o.useState(null),y=o.useCallback(m=>{p(k=>ae(m,k))},[p]),A=o.useCallback((m,k)=>{a&&a(k)},[a]);o.useCallback(()=>{if(f){const m=f.toObject();console.log("Flow saved:",m)}},[f]);const L=o.useCallback(m=>{console.log("ReactFlow initialized",m),c(m),m.fitView({padding:.2,includeHiddenNodes:!0}),setTimeout(()=>{m.fitView({padding:.25,duration:800}),m.zoomTo(.8,{duration:800})},300)},[]);return e.jsx("div",{className:"reactflow-wrapper",style:{width:"100%",height:"100%",minHeight:"600px"},children:e.jsxs(re,{nodes:x,edges:l,onNodesChange:g,onEdgesChange:b,onConnect:y,onNodeClick:A,onInit:L,connectionMode:ie.Loose,nodeTypes:We,fitView:!0,snapToGrid:!0,snapGrid:[15,15],defaultViewport:{x:0,y:0,zoom:1.5},children:[e.jsx(ne,{}),e.jsx(oe,{nodeStrokeWidth:3,zoomable:!0,pannable:!0,nodeColor:m=>{var t;const k=((t=m.data)==null?void 0:t.status)||"planned";return Ge[k]}}),e.jsx(le,{color:"#aaa",gap:16})]})})}function Qe({projectId:s,onNodeSelect:a,setIsLoading:r}){const[d,i]=o.useState(!0);return r&&r(!1),d?e.jsxs("div",{className:"h-full flex flex-col",style:{minHeight:"800px"},children:[e.jsx("div",{className:"flex items-center justify-end gap-2 p-2 bg-black/30 border-b border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[e.jsx(B,{htmlFor:"preview-mode",className:"text-xs text-gray-400",children:"Preview Mode"}),e.jsx(O,{id:"preview-mode",checked:d,onCheckedChange:i})]})}),e.jsx("div",{className:"flex-1 userflow-container",style:{height:"calc(100% - 40px)",minHeight:"750px"},children:e.jsx(ce,{children:e.jsx(Je,{projectId:s,onNodeSelect:a,setIsLoading:r})})})]}):e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex items-center justify-end gap-2 p-2 bg-black/30 border-b border-white/10",children:e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[e.jsx(B,{htmlFor:"preview-mode",className:"text-xs text-gray-400",children:"Preview Mode"}),e.jsx(O,{id:"preview-mode",checked:d,onCheckedChange:i})]})}),e.jsx("div",{className:"flex-1 h-full rounded-lg border border-white/10 bg-gradient-to-b from-black/30 to-black/10 flex flex-col items-center justify-center py-16",children:e.jsxs("div",{className:"max-w-xl text-center px-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-indigo-900/30 text-indigo-400 flex items-center justify-center mx-auto mb-6 border border-indigo-500/20",children:e.jsx(de,{className:"w-8 h-8"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-3",children:"User Flow Coming Soon"}),e.jsx("div",{className:"mb-6",children:e.jsx(_,{variant:"outline",className:"bg-amber-500/20 text-amber-400 border-amber-500/30",children:"Coming in Next Update"})}),e.jsx("p",{className:"text-gray-300 mb-8 max-w-md mx-auto",children:"We're working on implementing a powerful flow diagram to visualize your app's user journey. This feature will be available in the next update."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-left mb-6 max-w-md mx-auto",children:[e.jsxs("div",{className:"bg-black/30 rounded p-3 border border-white/10",children:[e.jsx("h4",{className:"text-white text-sm font-medium mb-1",children:"Map User Journeys"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Visualize complete user flows and interactions"})]}),e.jsxs("div",{className:"bg-black/30 rounded p-3 border border-white/10",children:[e.jsx("h4",{className:"text-white text-sm font-medium mb-1",children:"Screen Connections"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Link screens together with logical transitions"})]}),e.jsxs("div",{className:"bg-black/30 rounded p-3 border border-white/10",children:[e.jsx("h4",{className:"text-white text-sm font-medium mb-1",children:"Export Options"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Share diagrams with your team in various formats"})]})]}),e.jsx(u,{variant:"outline",className:"bg-indigo-500/20 hover:bg-indigo-500/30 text-indigo-300 border-indigo-500/30",onClick:()=>{i(!0),S({title:"Previewing Implementation",description:"You are now viewing the ReactFlow implementation preview.",duration:5e3})},children:"Preview Implementation"})]})})]})}function Xe({node:s,onClose:a}){const[r,d]=o.useState([]),[i,x]=o.useState(!1),[N,g]=o.useState(""),[l,p]=o.useState(!1),[b,f]=o.useState(!1),[c,y]=o.useState({label:s.label,description:s.description||"",status:s.status||"planned",docs_url:s.docs_url||""});o.useEffect(()=>{C(this,null,function*(){const{data:{user:n}}=yield j.auth.getUser();if(n){const{data:h}=yield j.from("user_roles").select("role").eq("user_id",n.id).single();p((h==null?void 0:h.role)==="admin")}})},[]),o.useEffect(()=>{C(this,null,function*(){if(!(!s||!s.id)){x(!0);try{const{data:n,error:h}=yield j.from("flow_comments").select(`
            id,
            comment,
            created_at,
            user_id,
            profiles:user_id (full_name, avatar_url)
          `).eq("node_id",s.id).order("created_at",{ascending:!1});if(h)throw h;d(n||[])}catch(n){const h=n instanceof Error?n.message:"Failed to load comments";S({title:"Error loading comments",description:h,variant:"destructive"})}finally{x(!1)}}})},[s]);const A=()=>C(this,null,function*(){if(N.trim())try{x(!0);const{data:{user:t}}=yield j.auth.getUser();if(!t)throw new Error("User not authenticated");const{error:n}=yield j.from("flow_comments").insert({node_id:s.id,user_id:t.id,comment:N});if(n)throw n;g("");const{data:h,error:F}=yield j.from("flow_comments").select(`
          id,
          comment,
          created_at,
          user_id,
          profiles:user_id (full_name, avatar_url)
        `).eq("node_id",s.id).order("created_at",{ascending:!1});if(F)throw F;d(h||[]),S({title:"Comment added",description:"Your comment has been added successfully"})}catch(t){const n=t instanceof Error?t.message:"Failed to add comment";S({title:"Error adding comment",description:n,variant:"destructive"})}finally{x(!1)}}),L=()=>C(this,null,function*(){if(l)try{x(!0);const{error:t}=yield j.from("flow_nodes").update({label:c.label,description:c.description,status:c.status,docs_url:c.docs_url,updated_at:new Date().toISOString()}).eq("id",s.id);if(t)throw t;f(!1),S({title:"Node updated",description:"The node details have been updated successfully"})}catch(t){const n=t instanceof Error?t.message:"Failed to update node";S({title:"Error updating node",description:n,variant:"destructive"})}finally{x(!1)}}),m=t=>{const n=new Date(t);return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(n)},k=t=>{switch(t){case"live":return e.jsx(_,{className:"bg-emerald-600",children:"Live"});case"development":return e.jsx(_,{className:"bg-amber-600",children:"In Development"});case"planned":default:return e.jsx(_,{className:"bg-slate-600",children:"Planned"})}};return e.jsxs(Y,{className:"bg-black/20 border-gray-800 h-[calc(100vh-220px)] flex flex-col",children:[e.jsxs(Fe,{className:"flex flex-row items-start justify-between pb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"text-white",children:b?"Edit Node":s.label}),!b&&k(s.status)]}),!b&&e.jsx(Pe,{className:"text-gray-400",children:s.description||"No description provided"})]}),e.jsx(u,{variant:"ghost",size:"icon",onClick:a,className:"mt-1",children:e.jsx(me,{className:"h-4 w-4"})})]}),e.jsx(Te,{className:"space-y-4 flex-grow overflow-auto pb-0",children:b?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-2",children:"Node Name"}),e.jsx("input",{type:"text",value:c.label,onChange:t=>y(P(I({},c),{label:t.target.value})),className:"w-full bg-black/30 border border-gray-700 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-2",children:"Description"}),e.jsx("textarea",{value:c.description,onChange:t=>y(P(I({},c),{description:t.target.value})),className:"w-full bg-black/30 border border-gray-700 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-2",children:"Status"}),e.jsxs("select",{value:c.status,onChange:t=>y(P(I({},c),{status:t.target.value})),className:"w-full bg-black/30 border border-gray-700 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"planned",children:"Planned"}),e.jsx("option",{value:"development",children:"In Development"}),e.jsx("option",{value:"live",children:"Live"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-400 block mb-2",children:"Documentation URL"}),e.jsx("input",{type:"text",value:c.docs_url,onChange:t=>y(P(I({},c),{docs_url:t.target.value})),className:"w-full bg-black/30 border border-gray-700 rounded-md px-3 py-2 text-sm text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"https://notion.so/..."})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>f(!1),className:"border-gray-700 text-gray-300 hover:bg-gray-800",children:"Cancel"}),e.jsx(u,{variant:"default",size:"sm",onClick:L,className:"bg-indigo-600 hover:bg-indigo-700",disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"⟳"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"pb-4 border-b border-gray-800",children:[e.jsxs("h3",{className:"text-sm font-medium text-indigo-400 flex items-center mb-2",children:[e.jsx(he,{className:"w-4 h-4 mr-1"}),"Node Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Type"}),e.jsx("p",{className:"text-white",children:s.node_type==="action"?"Action":"Page"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Status"}),e.jsx("p",{className:"text-white capitalize",children:s.status})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Last Updated"}),e.jsx("p",{className:"text-white",children:s.updated_at?m(s.updated_at):"N/A"})]}),s.docs_url&&e.jsx("div",{className:"col-span-2",children:e.jsxs("a",{href:s.docs_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-indigo-400 hover:text-indigo-300 mt-2",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{children:"View Documentation"})]})})]}),l&&e.jsxs(u,{variant:"outline",size:"sm",onClick:()=>f(!0),className:"mt-3 bg-black/30 border-indigo-500/30 text-indigo-400 hover:bg-indigo-900/20",children:[e.jsx(ue,{className:"w-3 h-3 mr-1"}),"Edit Node"]})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-medium text-indigo-400 flex items-center mb-3",children:[e.jsx(ge,{className:"w-4 h-4 mr-1"}),"Comments & Feedback"]}),e.jsx("div",{className:"space-y-3 max-h-[300px] overflow-y-auto pr-2",children:r.length===0?e.jsxs("div",{className:"text-center py-6 px-4 bg-black/20 rounded-md border border-gray-800",children:[e.jsx("p",{className:"text-gray-400 text-sm",children:"No comments yet"}),e.jsx("p",{className:"text-gray-500 text-xs mt-1",children:"Be the first to leave feedback"})]}):r.map(t=>{var n,h,F;return e.jsxs("div",{className:"p-3 bg-black/20 rounded-md border border-gray-800",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-indigo-800 flex items-center justify-center text-xs text-white mr-2",children:((h=(n=t.profiles)==null?void 0:n.full_name)==null?void 0:h.charAt(0))||"U"}),e.jsx("span",{className:"text-white text-sm",children:((F=t.profiles)==null?void 0:F.full_name)||"User"})]}),e.jsx("span",{className:"text-gray-500 text-xs",children:m(t.created_at)})]}),e.jsx("p",{className:"text-gray-300 text-sm whitespace-pre-wrap",children:t.comment})]},t.id)})})]})]})}),!b&&e.jsx(Ue,{className:"border-t border-gray-800 pt-3",children:e.jsxs("div",{className:"w-full space-y-2",children:[e.jsx(Be,{placeholder:"Add a comment...",value:N,onChange:t=>g(t.target.value),className:"min-h-[80px] bg-black/30 border-gray-700 text-white resize-none"}),e.jsx("div",{className:"flex justify-end",children:e.jsx(u,{variant:"default",size:"sm",onClick:A,className:"bg-indigo-600 hover:bg-indigo-700",disabled:i||!N.trim(),children:i?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"⟳"}),"Posting..."]}):"Post Comment"})})]})})]})}function Ke(){const[s,a]=o.useState(!1),r=()=>C(this,null,function*(){const{data:{user:d}}=yield j.auth.getUser();if(d){const{data:i}=yield j.from("user_roles").select("role").eq("user_id",d.id).single();a((i==null?void 0:i.role)==="admin")}});return o.useState(()=>{r()}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{children:e.jsxs(U,{children:[e.jsx(D,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full bg-black/20 border-gray-700 hover:bg-gray-800",children:e.jsx(pe,{className:"h-4 w-4 text-gray-400"})})}),e.jsx(E,{children:e.jsx("p",{children:"Search in diagram"})})]})}),e.jsx(T,{children:e.jsxs(U,{children:[e.jsx(D,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full bg-black/20 border-gray-700 hover:bg-gray-800",children:e.jsx(be,{className:"h-4 w-4 text-gray-400"})})}),e.jsx(E,{children:e.jsx("p",{children:"Filter nodes"})})]})}),e.jsx(T,{children:e.jsxs(U,{children:[e.jsx(D,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full bg-black/20 border-gray-700 hover:bg-gray-800",children:e.jsx(fe,{className:"h-4 w-4 text-gray-400"})})}),e.jsx(E,{children:e.jsx("p",{children:"Zoom in"})})]})}),e.jsx(T,{children:e.jsxs(U,{children:[e.jsx(D,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full bg-black/20 border-gray-700 hover:bg-gray-800",children:e.jsx(je,{className:"h-4 w-4 text-gray-400"})})}),e.jsx(E,{children:e.jsx("p",{children:"Zoom out"})})]})}),e.jsx("div",{className:"h-6 w-px bg-gray-700 mx-1"}),s&&e.jsxs(e.Fragment,{children:[e.jsxs(De,{children:[e.jsx(Ee,{asChild:!0,children:e.jsxs(u,{variant:"outline",size:"sm",className:"bg-indigo-900/30 border-indigo-500/30 text-indigo-300 hover:bg-indigo-800/50",children:[e.jsx(Ne,{className:"h-4 w-4 mr-1"}),"Add Node"]})}),e.jsxs(Ae,{className:"bg-gray-900 border-gray-700 text-gray-300",children:[e.jsx(Le,{children:"Add to diagram"}),e.jsx(ze,{className:"bg-gray-700"}),e.jsxs(z,{className:"hover:bg-gray-800 cursor-pointer",children:[e.jsx(ye,{className:"h-4 w-4 mr-2 text-blue-400"}),e.jsx("span",{children:"Page Node"})]}),e.jsxs(z,{className:"hover:bg-gray-800 cursor-pointer",children:[e.jsx(we,{className:"h-4 w-4 mr-2 text-purple-400"}),e.jsx("span",{children:"Action Node"})]}),e.jsxs(z,{className:"hover:bg-gray-800 cursor-pointer",children:[e.jsx(H,{className:"h-4 w-4 mr-2 text-amber-400"}),e.jsx("span",{children:"Decision Node"})]})]})]}),e.jsx(T,{children:e.jsxs(U,{children:[e.jsx(D,{asChild:!0,children:e.jsx(u,{variant:"outline",size:"icon",className:"h-8 w-8 rounded-full bg-black/20 border-gray-700 hover:bg-gray-800",children:e.jsx(ve,{className:"h-4 w-4 text-gray-400"})})}),e.jsx(E,{children:e.jsx("p",{children:"Flow settings"})})]})})]})]})}function es(){const{projectId:s="123"}=$(),{toast:a}=Me();ke();const[r,d]=o.useState(null),[i,x]=o.useState(!1),[N,g]=o.useState(!1),l={name:"UbahCrypt Project",description:"A revolutionary blockchain-based cryptocurrency platform with enhanced security features and cross-chain capabilities.",status:"ACTIVE",created_at:"2025-04-01T10:00:00Z"},p=y=>{d(y),x(!0)},b=()=>{a({title:"Changes Saved",description:"Your user flow has been saved successfully."})},f=()=>{a({title:"Undo",description:"Last change has been undone."})},c=()=>{x(!1)};return e.jsxs(e.Fragment,{children:[e.jsx(Re,{name:l.name,description:l.description,status:l.status,created_at:l.created_at}),e.jsx(Oe,{projectId:s}),e.jsx(Y,{className:"p-4 mb-6 bg-black/30 border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-md bg-blue-500/20 text-blue-400",children:e.jsx(Ce,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-white mb-1",children:"User Flow Designer"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Create and edit user flows to map out how users will navigate through your application. Connect screens, define interactions, and visualize the entire user journey."})]}),e.jsx(_,{className:"ml-auto",variant:"outline",children:"PRO Feature"})]})}),e.jsx(_e,{projectId:s,projectName:"Agency Onboarding App",onSave:b,onUndo:f,canUndo:!0,status:"draft"}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",style:{minHeight:"700px",height:"calc(100vh - 300px)"},children:[e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(Ke,{}),e.jsx("div",{className:"flex-1 overflow-auto",style:{minHeight:"600px"},children:e.jsx(Qe,{projectId:s,onNodeSelect:p,setIsLoading:g})})]}),i&&e.jsx(Xe,{node:r||{id:"dummy-node",type:"screen",data:{label:"Home Screen"}},onClose:c})]})]})}function us(){const{projectId:s}=$();return e.jsx(Se,{children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx(es,{})})})}export{us as default};
