var be=Object.defineProperty,we=Object.defineProperties;var ye=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var ve=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var B=(n,a,o)=>a in n?be(n,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[a]=o,j=(n,a)=>{for(var o in a||(a={}))ve.call(a,o)&&B(n,o,a[o]);if(V)for(var o of V(a))je.call(a,o)&&B(n,o,a[o]);return n},N=(n,a)=>we(n,ye(a));var _=(n,a,o)=>new Promise((y,h)=>{var E=m=>{try{d(o.next(m))}catch(x){h(x)}},S=m=>{try{d(o.throw(m))}catch(x){h(x)}},d=m=>m.done?y(m.value):Promise.resolve(m.value).then(E,S);d((o=o.apply(n,a)).next())});import{r as l,y as Ne,z as Se,j as e,aX as ke,bs as D,bt as Ce,X as H,bf as X,f as Ie,m as J,aD as _e,bu as Pe,bv as K,bw as Me,aa as Q,br as Ae}from"./vendor-C50ijZWh.js";import{s as z,u as Te,d as p,I as Z}from"./index-Blbobipf.js";import{M as Re}from"./message-loading-CcRIg0Qb.js";import{u as $e}from"./useOnboardingAuth-qoSJLt0r.js";import{S as ee}from"./SisoIcon-BjkQEkJN.js";import{s as De}from"./appPlanService-DzbS8Are.js";import"./libs-B3eAAgHd.js";import"./supabase-D8k0GRjn.js";function ze(n){return _(this,null,function*(){const{data:{user:a}}=yield z.auth.getUser();if(!a)throw new Error("User must be authenticated to save app plans");const o={user_id:a.id,title:n.title,description:n.description,business_type:n.business_type,target_audience:n.target_audience,app_concept:n.app_concept,features:n.features||[],technical_requirements:n.technical_requirements,timeline:n.timeline,budget_range:n.budget_range,development_phases:n.development_phases||[],ui_ux_plan:n.ui_ux_plan,market_analysis:n.market_analysis,revenue_model:n.revenue_model,risk_mitigation:n.risk_mitigation,status:"completed",metadata:n.metadata||{}},{data:y,error:h}=yield z.from("app_plans").insert(o).select().single();if(h)throw console.error("Error saving app plan:",h),new Error("Failed to save app plan");return y})}const Je=()=>{var Y,O;const[n,a]=l.useState([]),[o,y]=l.useState(""),[h,E]=l.useState(!1),[S,d]=l.useState("communication"),[m,x]=l.useState("chat"),[v,se]=l.useState(""),[k,te]=l.useState(!1),[r,C]=l.useState({company:"",industry:"General Business",description:"",website:"",websiteType:""}),[ae,f]=l.useState(!1),[G,g]=l.useState(!1),[P,A]=l.useState(!1),[ne,ie]=l.useState(!1),[T,q]=l.useState(!1),[re,b]=l.useState(0),[oe,w]=l.useState(""),[Ee,Ge]=l.useState(""),[qe,Fe]=l.useState(null),F=l.useRef(null),I=Ne(),L=Se(),{userId:U,isLoading:le}=$e(),{toast:W}=Te(),ce=((Y=L.state)==null?void 0:Y.fromAppPlanGenerator)||!1,M=((O=L.state)==null?void 0:O.appConcept)||"";l.useEffect(()=>{g(!0),setTimeout(()=>{if(g(!1),ce&&M){const s={id:"1",role:"assistant",content:`Hi! I see you want to build: "${M}". I'll help you create a comprehensive app plan. First, I need to know more about your business to tailor the plan specifically for you.`};a([s,{id:"2",role:"user",content:M},{id:"3",role:"assistant",content:"Great idea! What's your company name?",requiresAction:!0}]),x("chat"),d("company"),f(!0),C(i=>N(j({},i),{description:M}))}else a([{id:"1",role:"assistant",content:"Hi! I'm SISO, your AI assistant. I'll help you create a custom app plan by researching your business and industry. This will only take a few minutes.",actionComponent:e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"How would you like to communicate?"}),e.jsxs(p,{onClick:()=>R("chat"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Chat with me (type responses)"]}),e.jsxs(p,{onClick:()=>R("voice"),className:"w-full bg-green-600 hover:bg-green-700 text-white flex items-center gap-2",children:[e.jsx(K,{className:"h-4 w-4"}),"Voice chat (speak responses)"]}),e.jsxs(p,{onClick:()=>R("phone"),className:"w-full bg-orange-600 hover:bg-orange-700 text-white flex items-center gap-2",children:[e.jsx(Ae,{className:"h-4 w-4"}),"Schedule a phone call"]})]})}])},1e3)},[]);const R=s=>{x(s);const c={id:Date.now().toString(),role:"user",content:s==="chat"?"I'll chat with you":s==="voice"?"I'll speak with you":"I'd like a phone call"};a(t=>[...t,c]),setTimeout(s==="phone"?()=>{const t={id:Date.now().toString(),role:"assistant",content:"Perfect! Please provide your phone number and we'll call you within 5 minutes to walk you through everything.",actionComponent:e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx(Z,{type:"tel",placeholder:"Enter your phone number",value:v,onChange:i=>se(i.target.value),className:"bg-black/30 border-siso-text/20 text-white"}),e.jsx(p,{onClick:de,disabled:!v.trim(),className:"w-full bg-gradient-to-r from-siso-red to-siso-orange text-white",children:"Schedule Call Now"})]})};a(i=>[...i,t])}:()=>{const t={id:Date.now().toString(),role:"assistant",content:"Perfect! I just need 4 quick pieces of information, then I'll research your business and create a custom app plan. What's your company name?",requiresAction:!0};a(i=>[...i,t]),d("company"),f(!0)},1e3)},de=()=>{if(!v.trim())return;const s={id:Date.now().toString(),role:"assistant",content:`Perfect! We'll call you at ${v} within 5 minutes. You can also continue with the chat if you'd like to get started immediately.`,actionComponent:e.jsx("div",{className:"mt-4",children:e.jsx(p,{onClick:()=>{x("chat"),d("company"),f(!0)},className:"w-full bg-gradient-to-r from-siso-red to-siso-orange text-white",children:"Continue with Chat While We Call"})})};a(c=>[...c,s]),W({title:"Call Scheduled",description:`We'll call you at ${v} within 5 minutes.`})},pe=()=>{te(!k),W({title:k?"Recording Stopped":"Recording Started",description:k?"Voice input captured (demo)":"Speak now (demo mode)"})};l.useEffect(()=>{var s;(s=F.current)==null||s.scrollIntoView({behavior:"smooth"})},[n,G]),l.useEffect(()=>{if(P){const s={id:Date.now().toString(),role:"assistant",content:"ðŸ” **Research in Progress...**",actionComponent:e.jsxs("div",{className:"mt-3 flex items-center gap-3 p-3 bg-orange-500/10 border border-orange-500/30 rounded-lg",children:[e.jsx(X,{className:"w-5 h-5 text-orange-500 animate-spin"}),e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-bounce"}),e.jsx("div",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-ping"}),e.jsx("span",{className:"text-orange-400 font-medium",children:"Analyzing your business data..."})]})};a(t=>[...t,s]),[r.website&&r.website!=="none"?`Scraping ${r.company} ${r.websiteType==="website"?"website":"social media"} content...`:`Analyzing ${r.company} business information...`,"Researching industry trends and market data...","Identifying competitors and market opportunities...","Analyzing technology trends and best practices...","Compiling research findings and insights..."].forEach((t,i)=>{setTimeout(()=>{w(t),b(20+i*15)},(i+1)*1e3)}),setTimeout(()=>{A(!1),ie(!0),b(100),w("âœ… Research complete!"),setTimeout(()=>{ue()},2e3)},6e3)}},[P,r.company,r.website,r.websiteType]),l.useEffect(()=>{if(T){const s=["Conducting initial market research and industry analysis...","Analyzing competitor landscape and market opportunities...","Performing refined research and strategic positioning...","Evaluating user experience and technical requirements...","Generating comprehensive app development plan...","Finalizing research-backed feature recommendations..."];s.forEach((c,t)=>{setTimeout(()=>{w(c),b(15+t*14)},(t+1)*2e3)}),setTimeout(()=>_(void 0,null,function*(){var c;q(!1),b(100),w("Research-driven app plan complete!");try{const t=yield De({company:r.company,industry:r.industry,description:r.description,website:r.website});if(console.log("App plan saved with research data:",t),t!=null&&t.features)try{const u={title:`${r.company} App Plan`,description:r.description,business_type:r.industry,app_concept:r.description,features:t.features.map(fe=>({name:fe})),timeline:"12-16 weeks",budget_range:"Â£25,000 - Â£50,000",market_analysis:((c=t.research_results)==null?void 0:c.marketAnalysis)||"",metadata:{originalPlanId:t.id,researchResults:t.research_results}},xe=yield ze(u);console.log("Also saved to new app_plans table:",xe)}catch(u){console.error("Failed to save to new app_plans table:",u)}const i={id:Date.now().toString(),role:"assistant",content:`ðŸŽ‰ **Your comprehensive app plan is ready!**

I've conducted extensive research across ${s.length} phases including market analysis, competitor research, and strategic positioning. Your plan includes:

âœ… **Research-backed features** tailored to ${r.industry}
âœ… **Competitive analysis** and market positioning
âœ… **Technical recommendations** based on industry best practices
âœ… **Strategic insights** for ${r.company}`,actionComponent:e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-400 mb-2",children:[e.jsx(ke,{className:"h-5 w-5"}),e.jsx("span",{className:"font-semibold",children:"App Plan Generated Successfully!"})]}),e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Your research-driven app development plan is ready to view with all findings and recommendations."})]}),e.jsxs(p,{onClick:()=>{t!=null&&t.username?I(`/app-plan/${t.username}`):I("/app-plan")},className:"w-full bg-gradient-to-r from-siso-red to-siso-orange text-white flex items-center gap-2 py-3 text-lg font-medium",children:[e.jsx(D,{className:"h-5 w-5"}),"View Your Complete App Plan"]}),(t==null?void 0:t.username)&&e.jsxs("p",{className:"text-xs text-gray-400 text-center",children:["Plan URL: ",window.location.origin,"/app-plan/",t.username]})]})};a(u=>[...u,i])}catch(t){console.error("Failed to save app plan:",t);const i={id:Date.now().toString(),role:"assistant",content:`ðŸŽ‰ **Your app plan has been generated!**

I've conducted comprehensive research and created a detailed plan for ${r.company}. The plan includes research-backed features, competitive analysis, and strategic recommendations.`,actionComponent:e.jsx("div",{className:"mt-4",children:e.jsxs(p,{onClick:()=>I("/app-plan"),className:"w-full bg-gradient-to-r from-siso-red to-siso-orange text-white flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"View Your Custom App Plan"]})})};a(u=>[...u,i])}d("complete")}),13e3)}},[T,r]);const me=s=>_(void 0,null,function*(){if(!s.trim()||h)return;f(!1),y("");const c={id:Date.now().toString(),role:"user",content:s};a(t=>[...t,c]),S==="company"?(C(t=>N(j({},t),{company:s})),g(!0),setTimeout(()=>{g(!1);const t={id:Date.now().toString(),role:"assistant",content:`Great! In one sentence, what does ${s} do?`,requiresAction:!0};a(i=>[...i,t]),d("description"),f(!0)},1e3)):S==="description"?(C(t=>N(j({},t),{description:s})),g(!0),setTimeout(()=>{g(!1);const t={id:Date.now().toString(),role:"assistant",content:"Perfect! Do you have any online presence I can research?",actionComponent:e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-3",children:"Select your online presence:"}),e.jsxs(p,{onClick:()=>$("website"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"}),"I have a website"]}),e.jsxs(p,{onClick:()=>$("instagram"),className:"w-full bg-purple-600 hover:bg-purple-700 text-white flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"I have Instagram/Social Media"]}),e.jsxs(p,{onClick:()=>$("none"),className:"w-full bg-gray-600 hover:bg-gray-700 text-white flex items-center gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),"No online presence yet"]})]})};a(i=>[...i,t]),d("website"),f(!1)},1e3)):S==="website_input"&&(C(t=>N(j({},t),{website:s})),g(!0),setTimeout(()=>{g(!1);const t={id:Date.now().toString(),role:"assistant",content:`Perfect! I have all the information I need. Starting research on ${r.company} and ${r.websiteType==="website"?"your website":"your social media"} now...`};a(i=>[...i,t]),setTimeout(()=>{A(!0),b(5),w("Initializing research process..."),d("research")},1e3)},500))}),$=s=>{const c=s==="website"?"I have a website":s==="instagram"?"I have Instagram/Social Media":"No online presence yet",t={id:Date.now().toString(),role:"user",content:c};a(i=>[...i,t]),C(i=>N(j({},i),{websiteType:s})),setTimeout(s==="none"?()=>{const i={id:Date.now().toString(),role:"assistant",content:`Perfect! I have all the information I need. Starting research on ${r.company} now...`};a(u=>[...u,i]),setTimeout(()=>{A(!0),b(5),w("Initializing research process..."),d("research")},1e3)}:()=>{const i={id:Date.now().toString(),role:"assistant",content:s==="website"?"Great! Please enter your website URL:":"Perfect! Please enter your Instagram handle or social media URL:",requiresAction:!0};a(u=>[...u,i]),d("website_input"),f(!0)},500)},ue=()=>_(void 0,null,function*(){q(!0),b(10),w("Building your app development plan..."),d("app_plan");try{if(U){const{error:s}=yield z.from("onboarding").insert({organization:r.company,app_idea:r.description,user_id:U,industry:r.industry,additional_requirements:r.website,communication_preference:m,phone_number:v||null});s&&console.warn("Error saving onboarding data:",s)}}catch(s){console.warn("Error saving onboarding data:",s)}}),he=s=>{s.preventDefault(),o.trim()&&me(o.trim())},ge=()=>{I("/")};return e.jsxs("div",{className:"flex flex-col min-h-screen bg-gradient-to-b from-black via-siso-bg to-black",children:[le&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-50",children:e.jsx("div",{className:"w-10 h-10 border-4 border-siso-orange/50 border-t-siso-orange rounded-full animate-spin"})}),e.jsxs("header",{className:"p-4 border-b border-siso-text/10 flex items-center justify-between bg-black/30 backdrop-blur-sm fixed top-0 left-0 right-0 z-10",children:[e.jsx(p,{variant:"ghost",size:"icon",onClick:ge,className:"text-siso-text hover:text-siso-text-bold hover:bg-black/20",children:e.jsx(Ce,{size:20})}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>I("/thankyou"),className:"text-siso-text hover:text-siso-text-bold hover:bg-black/20",children:e.jsx(H,{size:20})})]}),e.jsxs("main",{className:"flex-1 max-w-2xl w-full mx-auto px-4 pt-20 pb-24",children:[(P||T||ne)&&e.jsxs("div",{className:"mb-6 bg-gray-900/80 border border-orange-500/30 rounded-lg p-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"w-6 h-6 text-orange-500 animate-spin"}),e.jsx("div",{className:"animate-pulse",children:e.jsx("div",{className:"w-6 h-6 bg-orange-500 rounded-full animate-bounce"})}),e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-ping"})]}),e.jsx("h3",{className:"text-lg font-bold text-orange-400",children:oe})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"w-full h-3 bg-gray-800 rounded-full overflow-hidden border border-orange-500/20",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-red-500 via-orange-500 to-yellow-500 rounded-full transition-all duration-500 animate-pulse",style:{width:`${re}%`}})}),e.jsx("div",{className:"flex justify-between text-sm font-medium text-orange-300",children:P?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"ðŸ” Scraping"}),e.jsx("span",{children:"ðŸ“Š Industry"}),e.jsx("span",{children:"ðŸ¢ Competitors"}),e.jsx("span",{children:"âš¡ Analysis"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"âœ… Research"}),e.jsx("span",{children:"ðŸ› ï¸ Features"}),e.jsx("span",{children:"ðŸ“‹ Planning"}),e.jsx("span",{children:"ðŸŽ‰ Complete"})]})})]})]}),e.jsxs("div",{className:"flex-1 space-y-4 py-4",children:[e.jsxs(Ie,{children:[n.map((s,c)=>e.jsx(J.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex max-w-[90%] ${s.role==="user"?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:`flex items-center justify-center h-10 w-10 rounded-full shrink-0 ${s.role==="assistant"?"bg-gradient-to-r from-siso-red to-siso-orange":"bg-siso-text/30"} ${s.role==="user"?"ml-3":"mr-3"}`,children:s.role==="assistant"?e.jsx(ee,{className:"w-6 h-6 text-white"}):e.jsx(_e,{size:20})}),e.jsxs("div",{className:"flex flex-col",children:[s.role==="assistant"&&e.jsx("span",{className:"text-xs text-siso-text-muted ml-2 mb-1",children:"SISO"}),e.jsxs("div",{className:`rounded-2xl p-4 ${s.role==="assistant"?"bg-black/40 text-white border border-siso-text/10":"bg-siso-orange/90 text-black"}`,children:[e.jsx("div",{className:"whitespace-pre-line",children:s.content}),s.actionComponent]})]})]})},s.id)),G&&e.jsx(J.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start",children:e.jsxs("div",{className:"flex max-w-[80%] flex-row",children:[e.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-full shrink-0 bg-gradient-to-r from-siso-red to-siso-orange mr-3",children:e.jsx(ee,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs text-siso-text-muted ml-2 mb-1",children:"SISO"}),e.jsx("div",{className:"rounded-2xl p-4 bg-black/40 text-white border border-siso-text/10",children:e.jsx(Re,{})})]})]})})]}),e.jsx("div",{ref:F})]})]}),ae&&m&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-black/80 backdrop-blur-sm border-t border-siso-text/10 p-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsxs("form",{onSubmit:he,className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Z,{type:"text",placeholder:m==="voice"?"Speak or type your response...":"Type your response...",value:o,onChange:s=>y(s.target.value),className:"bg-black/40 border-siso-text/20 text-white pr-12",disabled:h}),m==="voice"&&e.jsx(p,{type:"button",variant:"ghost",size:"icon",onClick:pe,className:`absolute right-2 top-1/2 transform -translate-y-1/2 ${k?"text-red-500 animate-pulse":"text-siso-text"}`,children:k?e.jsx(Pe,{size:16}):e.jsx(K,{size:16})})]}),e.jsx(p,{type:"submit",disabled:!o.trim()||h,className:"bg-gradient-to-r from-siso-red to-siso-orange text-white",children:e.jsx(Me,{size:16})})]})})})]})};export{Je as default};
